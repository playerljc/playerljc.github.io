"use strict";(self.webpackChunk_ctsj_build=self.webpackChunk_ctsj_build||[]).push([[7873,9881],{439881:function(t,e,n){n.r(e);var o=n(460467),i=function(){return(i=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};e.default={flyToChina:function(t){t.centerAndZoom(new BMap.Point(106.638754,34.842904),2)},fillCityBoundary:function(t,e,n){var o=[],r=[];return new Promise((function(a){(new BMap.Boundary).get(t,(function(t){for(var s=0;s<t.boundaries.length;s++){var l=((l=t.boundaries[s]).split(";").forEach((function(t){t=t.trim().split(","),r.push(new BMap.Point(parseFloat(t[0].trim()),parseFloat(t[1].trim())))})),new BMap.Polygon(l,i({},e)));o.push(l),n.addOverlay(l)}a({cityOverlays:o,cityPoints:r})}))}))},fit:function(t,e,n){return new Promise((function(o){var i=t.getViewport(e,null!=n?n:{});t.centerAndZoom(i.center,i.zoom),setTimeout((function(){o(null)}),200)}))},pixelToPoint:function(t,e){return t.pixelToPoint(e)},pointToPixel:function(t,e){return t.pointToPixel(e)},getBound:function(t){var e=(t=t.getBounds()).getSouthWest();t=t.getNorthEast();return{leftTopLon:e.lng,leftTopLat:t.lat,rightBottomLon:t.lng,rightBottomLat:e.lat}},getScale:function(t){var e=t.getCenter(),n=t.pointToPixel(e),o=new BMap.Point(e.lng,e.lat+.001),i=t.pointToPixel(o);return((i=Math.abs(i.y-n.y))<=0?1:i)/t.getDistance(e,o)},getUnitPixelToM:function(t){return Math.pow(2,18-t)},getArrowPoints:function(t){var e=t.from,n=t.to,o=void 0===(o=t.scale)?1:o,i=void 0===(i=t.width)?5:i,r=(t=void 0===(t=t.theta)?35:t,e.x),a=(e=e.y,n.x);n=n.y,r=((e=180*Math.atan2(e-n,r-a)/Math.PI)+t)*Math.PI/180,e=(e-t)*Math.PI/180;return{A:{x:(t=a+i*Math.cos(r))*o,y:(r=n+i*Math.sin(r))*o},B:{x:a*o,y:n*o},C:{x:(a+i*Math.cos(e))*o,y:(n+i*Math.sin(e))*o}}},clientToCtxPointToEl:function(t){var e=t.event,n=t.rect,o=(t=t.offsetEl,(t="undefined"!=typeof window?window.getComputedStyle(t,null):{left:"0",top:"0"}).left);t=t.top,o=parseInt(o.replace("px","")),t=parseInt(t.replace("px",""));return this.clientToCtxPoint({event:e,rect:n,offsetLeft:o,offsetTop:t})},clientToCtxPoint:function(t){var e=t.event,n=t.rect,i=t.offsetLeft;t=t.offsetTop;return(e=o.Z.clientToCtxPoint({event:e,rect:n})).x-=i,e.y-=t,e}}},952045:function(t,e,n){var o=n(745079),i=n(497734),r=function(){function t(t){this.name="",this.id="",this.style=o.Z,this.zIndex=1,this.properties={},this.name=null==t?void 0:t.name,this.id=null==t?void 0:t.id,this.properties=null==t?void 0:t.properties,this.style=null==t?void 0:t.style,this.geometry=null==t?void 0:t.geometry,this.setGeometryContext()}return t.prototype.setGeometryContext=function(){this.geometry&&this.geometry.setContext(this)},t.prototype.draw=function(t){this.geometry.draw(t,this.style)},t.prototype.getGeometry=function(){return this.geometry},t.prototype.getId=function(){return this.id},t.prototype.getName=function(){return this.name},t.prototype.getStyle=function(){return this.style},t.prototype.getZIndex=function(){return this.zIndex},t.prototype.getProperties=function(){return this.properties},t.prototype.setGeometry=function(t){this.geometry=t,this.setGeometryContext(),null!=(t=null==(t=this.getLayer())?void 0:t.getEmitter())&&t.trigger(i.VectorActions.UPDATE)},t.prototype.setStyle=function(t){this.style=t,null!=(t=null==(t=this.getLayer())?void 0:t.getEmitter())&&t.trigger(i.VectorActions.UPDATE)},t.prototype.setId=function(t){this.id=t},t.prototype.setName=function(t){this.name=t},t.prototype.setZIndex=function(t){this.zIndex=t,null!=(t=null==(t=null==this?void 0:this.getLayer())?void 0:t.getEmitter())&&t.trigger(i.VectorActions.UPDATE)},t.prototype.setProperties=function(t){this.properties=t},t.prototype.getContext=function(){return this.context},t.prototype.setContext=function(t){this.context=t},t.prototype.getLayer=function(){var t;return null==(t=null==this?void 0:this.getContext())?void 0:t.getContext()},t.prototype.getMap=function(){var t;return null==(t=null==this?void 0:this.getLayer())?void 0:t.getMap()},t.prototype.isPointInFeature=function(t,e){return this.geometry.isPixelInGeometry(t,e)},t}();e.Z=r},786464:function(t,e){var n=new Map,o={add:function(t,e){return n.set(JSON.stringify(t),e)},get:function(t){return n.get(JSON.stringify(t))},delete:function(t){return n.delete(JSON.stringify(t))},clear:function(){n.clear()},values:function(){return Array.from(n.values())},keys:function(){return Array.from(n.keys()).map((function(t){return JSON.parse(t)}))}};e.Z=o},89083:function(t,e,n){var o,i=n(952045),r=n(336017),a=n(497734),s=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(){return(l=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},c=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,i=Object.getOwnPropertySymbols(t);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(n[i[o]]=t[i[o]]);return n},u=function(t){function e(e){var n=this,o=(e.text,e.textStyle,c(e,["text","textStyle"]));return(n=t.call(this,o)||this).text=e.text,n.textStyle=e.textStyle,n}return s(e,t),e.prototype.getText=function(){return this.text},e.prototype.getTextStyle=function(){return this.textStyle},e.prototype.setText=function(t){this.text=t,null!=(t=null==(t=null==this?void 0:this.getLayer())?void 0:t.getEmitter())&&t.trigger(a.VectorActions.UPDATE)},e.prototype.setTextStyle=function(t){this.textStyle=t,null!=(t=null==(t=null==this?void 0:this.getLayer())?void 0:t.getEmitter())&&t.trigger(a.VectorActions.UPDATE)},e.prototype.draw=function(e){t.prototype.draw.call(this,e),this.geometry.drawText({ctx:e,text:this.text,style:this.style,textStyle:this.textStyle||l({},r.Z)})},e}(i.Z);e.Z=u},652984:function(t,e,n){var o,i=n(460467),r=n(441930),a=n(497734),s=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(){return(l=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},c=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},u=function(t){function e(e,n){var o=this;return o.update=o.update.bind(o),(o=t.call(this,{update:o.update,paneName:n.paneName,zIndex:n.zIndex})||this).isLoad=!1,o.emitter=new r.Z.Events,o.map=e,o.config=l({},n),o.source=n.source,o.source&&o.source.setContext(o),o.onUpdate=o.onUpdate.bind(o),o.initEvents(),o}return s(e,t),e.prototype.getSource=function(){return this.source},e.prototype.getZIndex=function(){return this.config.zIndex},e.prototype.setSource=function(t){this.source=t,this.source&&this.source.setContext(this),this.update()},e.prototype.drawSource=function(){var t=this.source.getFeatures(),e=(t.sort((function(t,e){return t.getZIndex()>e.getZIndex()?1:t.getZIndex()<e.getZIndex()?-1:0})),this.canvas.getContext("2d"));e&&(t||[]).forEach((function(t){t.draw(e)}))},e.prototype.firstLoad=function(){this.initCanvasEvents()},e.prototype.update=function(){var t=this.canvas.getContext("2d");t&&(this.isLoad||this.firstLoad(),this.isLoad=!0,t.clearRect(0,0,t.canvas.width,t.canvas.height),this.drawSource())},e.prototype.getMap=function(){return this.map},e.prototype.getEmitter=function(){return this.emitter},e.prototype.addEventListener=function(t,e){this.emitter.on(t,e)},e.prototype.removeEventListener=function(t,e){this.emitter.remove(t,e)},e.prototype.initCanvasEvents=function(){var t=this;this.canvas.addEventListener("click",(function(e){var n=i.Z.clientToCtxPoint({event:e,rect:t.canvas.getBoundingClientRect()});(e=t.source.getFeatures().filter((function(t){return t.isPointInFeature(n,t.getStyle())}))).length?t.emitter.trigger(a.VectorEventActions.FEATURE_CLICK,{features:c([],e,!0),pixel:n}):t.emitter.trigger(a.VectorEventActions.VECTOR_CLICK)}))},e.prototype.initEvents=function(){this.emitter.on(a.VectorActions.UPDATE,this.onUpdate)},e.prototype.onUpdate=function(){this.update()},e}(BMap.CanvasLayer);e.Z=u},346996:function(t,e,n){var o,i=n(441930),r=n(180920),a=n(497734),s=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},c=function(t){function e(e){var n=t.call(this)||this;return n.context=null,n.features=[],n.features=e,n.setFeaturesContext(),n}return s(e,t),e.prototype.setFeaturesContext=function(){var t=this;this.features.forEach((function(e){e.setContext(t)}))},e.prototype.addFeature=function(t){this.hasFeatureById(t.getId())||(this.features.push(t),this.setFeaturesContext(),null!=(t=null==this?void 0:this.getContext())&&t.getEmitter().trigger(a.VectorActions.UPDATE))},e.prototype.addFeatures=function(t){var e=this;t=t.filter((function(t){return!e.hasFeatureById(t.getId())}));this.features=l(l([],this.features,!0),t,!0),this.setFeaturesContext(),null!=(t=null==this?void 0:this.getContext())&&t.getEmitter().trigger(a.VectorActions.UPDATE)},e.prototype.addFirstFeature=function(t){this.hasFeatureById(t.getId())||(this.features.unshift(t),null!=(t=null==this?void 0:this.getContext())&&t.getEmitter().trigger(a.VectorActions.UPDATE))},e.prototype.insertFeature=function(t,e){this.hasFeatureById(t.getId())||(this.features.splice(e,0,t),this.setFeaturesContext(),null!=(e=null==this?void 0:this.getContext())&&e.getEmitter().trigger(a.VectorActions.UPDATE))},e.prototype.removeFeature=function(t){this.removeFeatureById(t.getId())},e.prototype.removeFeatureById=function(t){var e;this.hasFeatureById(t)&&(e=this.features.findIndex((function(e){return e.getId()===t})),this.features.splice(e,1),null!=(e=null==this?void 0:this.getContext()))&&e.getEmitter().trigger(a.VectorActions.UPDATE)},e.prototype.clear=function(){var t;this.features=[],null!=(t=null==this?void 0:this.getContext())&&t.getEmitter().trigger(a.VectorActions.UPDATE)},e.prototype.getFeatureById=function(t){return this.features.find((function(e){return e.getId()===t}))},e.prototype.getFeatures=function(){return l([],this.features,!0)},e.prototype.hasFeature=function(t){return-1!==this.features.indexOf(t)},e.prototype.hasFeatureById=function(t){return!!this.features.find((function(e){return e.getId()===t}))},e.prototype.readGeoJSON=function(t,e){var n=this;this.features=r.Z.parse(t,e),this.features.forEach((function(t){t.setContext(n)})),null!=(t=null==this?void 0:this.getContext())&&t.getEmitter().trigger(a.VectorActions.UPDATE)},e.prototype.appendGeoJSON=function(t,e){var n=this;(t=r.Z.parse(t,e)).forEach((function(t){t.setContext(n)})),this.features=l(l([],this.features,!0),t,!0),null!=(e=null==this?void 0:this.getContext())&&e.getEmitter().trigger(a.VectorActions.UPDATE)},e.prototype.featuresToGeoJSON=function(){return r.Z.stringify(this.features)},e.prototype.setContext=function(t){this.context=t},e.prototype.getContext=function(){return this.context},e}(i.Z.Events);e.Z=c},180920:function(t,e,n){var o=n(460467),i=n(23113),r=n(210685),a=n(408075),s=n(631840),l=n(930615),c=n(532081),u=n(497734);e.Z={parse:function(t,e){var n=[];return function t(n,y,p){var h=null;n.type===u.GeoJSONType.Point?((h=y(new l.Z({lng:n.coordinates[0],lat:n.coordinates[1]}))).setId(o.Z.uuid()),p.push(h)):n.type===u.GeoJSONType.MultiPoint?((h=y(new a.Z(n.coordinates.map((function(t){return{lng:t[0],lat:t[1]}}))))).setId(o.Z.uuid()),p.push(h)):n.type===u.GeoJSONType.LineString?((h=y(new i.Z({point1:{lng:n.coordinates[0][0],lat:n.coordinates[0][1]},point2:{lng:n.coordinates[1][0],lat:n.coordinates[1][1]}}))).setId(o.Z.uuid()),p.push(h)):n.type===u.GeoJSONType.MultiLineString?((h=y(new r.Z(n.coordinates.map((function(t){return{point1:{lng:t[0][0],lat:t[0][1]},point2:{lng:t[1][0],lat:t[1][1]}}}))))).setId(o.Z.uuid()),p.push(h)):n.type===u.GeoJSONType.Polygon?((h=y(new c.Z(n.coordinates.map((function(t){return{lng:t[0],lat:t[1]}}))))).setId(o.Z.uuid()),p.push(h)):n.type===u.GeoJSONType.MultiPolygon?((h=y(new s.Z(n.coordinates.map((function(t){return t.map((function(t){return{lng:t[0],lat:t[1]}}))}))))).setId(o.Z.uuid()),p.push(h)):n.type===u.GeoJSONType.GeometryCollection?n.geometries.forEach((function(n){t(n,e,p)})):n.type===u.GeoJSONType.Feature?t(n.geometry,(function(t){return(t=e(t)).setId(n.id),t.setProperties(n.properties),t}),p):n.type===u.GeoJSONType.FeatureCollection&&n.features.forEach((function(n){t(n,e,p)}))}(t,e,n),n},stringify:function(t){function e(t){return[(t=t.getCoordinates()).lng,t.lat]}function n(t){return t.getCoordinates().map((function(t){return[t.lng,t.lat]}))}function o(t){return[[(t=t.getCoordinates()).point1.lng,t.point1.lat],[t.point2.lng,t.point2.lat]]}function i(t){return t.getCoordinates().map((function(t){return[[t.point1.lng,t.point1.lat],[t.point2.lng,t.point2.lat]]}))}function r(t){return t.getCoordinates().map((function(t){return[t.lng,t.lat]}))}function a(t){return t.getCoordinates().map((function(t){return t.map((function(t){return[t.lng,t.lat]}))}))}var s,l={type:u.GeoJSONType.FeatureCollection,features:[]},c=[];for(s in u.GeoJSONType)c.push(s);return t.forEach((function(t){var s,y,p=t.getGeometry().getType();c.includes(p)&&l.features.push({type:u.GeoJSONType.Feature,geometry:{type:p,coordinates:(p=t.getGeometry(),s=new Map([[u.GeoJSONType.Point,e],[u.GeoJSONType.MultiPoint,n],[u.GeoJSONType.LineString,o],[u.GeoJSONType.MultiLineString,i],[u.GeoJSONType.Polygon,r],[u.GeoJSONType.MultiPolygon,a]]),y=p.getType(),s.get(y)(p))},id:t.getId(),properties:t.getProperties()})})),l}}},857789:function(t,e,n){n.r(e),n.d(e,{GeoJSONFormat:function(){return o.Z}});var o=n(180920)},569371:function(t,e,n){var o,i=n(439881),r=n(745079),a=n(497734),s=n(998687),l=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(){return(c=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},u=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return l(e,t),e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=null==(t=null==this?void 0:this.getLayer())?void 0:t.getEmitter())&&t.trigger(a.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return c({},this.coordinates)},e.prototype.getType=function(){return a.GeometryType.Circle},e.getCenterCoordinate=function(t){t.ctx;var e=t.coordinates,n=t.map;t.style,t.isScale,t=n.pointToPixel(new BMap.Point(e.center.lng,e.center.lat));return c({},t)},e.prototype.getCenterCoordinate=function(t){var n=t.ctx,o=t.style;t=t.isScale;return e.getCenterCoordinate({coordinates:this.coordinates,ctx:n,map:this.getMap(),style:o,isScale:t})},e.drawCircle=function(t){var e=t.ctx,n=t.style,o=t.coordinates,a=t.map;t=t.isScale,e.save(),e.beginPath(),n=c(c({},r.Z),null!=n?n:{}),e.lineWidth=n.lineWidth,e.lineJoin=n.lineJoin,e.lineCap=n.lineCap,e.setLineDash(n.lineDash),e.lineDashOffset=n.lineDashOffset,e.strokeStyle=n.strokeStyle,e.fillStyle=n.fillStyle,n=o.center,o=o.radius,n=a.pointToPixel(new BMap.Point(n.lng,n.lat)),a=i.default.getScale(a),t=t?a*o:o;e.ellipse(n.x,n.y,t,t,45*Math.PI/180,0,2*Math.PI),e.stroke(),e.fill(),e.restore()},e.prototype.draw=function(t,n){e.drawCircle({ctx:t,style:n,coordinates:this.coordinates,map:this.getMap(),isScale:!0})},e.isPixelInGeometry=function(t){var n=t.coordinates,o=t.map,i=t.style,r=t.pixel,a=(t=t.isScale,document.createElement("canvas").getContext("2d"));return!!a&&(e.drawCircle({ctx:a,coordinates:n,style:i,map:o,isScale:t}),a.isPointInPath(r.x,r.y))},e.prototype.isPixelInGeometry=function(t,n){return e.isPixelInGeometry({coordinates:this.coordinates,map:this.getMap(),style:n,pixel:t,isScale:!0})},e}(s.Z);e.Z=u},998687:function(t,e,n){var o=n(745079),i=n(336017),r=function(){return(r=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},a=function(){function t(){this.context=null}return t.prototype.setContext=function(t){this.context=t},t.prototype.getContext=function(){return this.context},t.prototype.drawText=function(t){var e=t.ctx,n=t.text,a=t.style;t=t.textStyle,e.beginPath(),e.save(),t=r(r({},i.Z),null!=t?t:{}),e.font=t.font,e.textAlign=t.textAlign,e.textBaseline=t.textBaseline,e.direction=t.direction,e.strokeStyle=t.strokeStyle,e.fillStyle=t.fillStyle,t=r(r({},o.Z),null!=a?a:{}),e.lineWidth=t.lineWidth,e.lineJoin=t.lineJoin,e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.strokeStyle=t.strokeStyle,t=this.getCenterCoordinate({ctx:e,style:a,isScale:!0});e.fillText(n||"",t.x,t.y),e.restore()},t.prototype.getMap=function(){var t;return null==(t=null==this?void 0:this.getLayer())?void 0:t.getMap()},t.prototype.getLayer=function(){var t=this.getContext();return t?t.getContext().getContext():null},t}();e.Z=a},808272:function(t,e,n){var o,i=n(439881),r=n(745079),a=n(497734),s=n(998687),l=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(){return(c=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},u=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return l(e,t),e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=null==(t=null==this?void 0:this.getLayer())?void 0:t.getEmitter())&&t.trigger(a.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return c({},this.coordinates)},e.prototype.getType=function(){return a.GeometryType.Leaf},e.getCenterCoordinate=function(t){t.ctx;var e=t.coordinates,n=t.map;t.style,t.isScale,t=n.pointToPixel(new BMap.Point(e.center.lng,e.center.lat));return c({},t)},e.prototype.getCenterCoordinate=function(t){var n=t.ctx,o=t.style;t=t.isScale;return e.getCenterCoordinate({coordinates:this.coordinates,ctx:n,map:this.getMap(),style:o,isScale:t})},e.drawLeaf=function(t){for(var e=t.ctx,n=t.style,o=t.coordinates,a=t.map,s=(t=t.isScale,n=(e.save(),c(c({},r.Z),null!=n?n:{})),e.beginPath(),e.lineWidth=n.lineWidth,e.lineJoin=n.lineJoin,e.lineCap=n.lineCap,e.setLineDash(n.lineDash),e.lineDashOffset=n.lineDashOffset,e.strokeStyle=n.strokeStyle,e.fillStyle=n.fillStyle,o.n),l=(n=o.center,o.size),u=l,y=o=o.length,p=(t&&(u=(t=i.default.getScale(a))*l,y=t*o),a.pointToPixel(new BMap.Point(n.lng,n.lat))),h=(e.moveTo(p.x,p.y+u),2*Math.PI/s),d=1;d<s+1;d++){var f=Math.sin((d-1)*h)*y+p.x,g=Math.cos((d-1)*h)*y+p.y,v=Math.sin(d*h)*y+p.x,x=Math.cos(d*h)*y+p.y,M=Math.sin(d*h)*u+p.x,T=Math.cos(d*h)*u+p.y;e.bezierCurveTo(f,g,v,x,M,T)}e.closePath(),e.stroke(),e.fill(),e.restore()},e.prototype.draw=function(t,n){e.drawLeaf({ctx:t,style:n,coordinates:this.coordinates,map:this.getMap(),isScale:!0})},e.isPixelInGeometry=function(t){var n=t.coordinates,o=t.map,i=t.pixel,r=t.style,a=(t=t.isScale,document.createElement("canvas").getContext("2d"));return!!a&&(e.drawLeaf({ctx:a,coordinates:n,style:r,map:o,isScale:t}),a.isPointInPath(i.x,i.y))},e.prototype.isPixelInGeometry=function(t,n){return e.isPixelInGeometry({coordinates:this.coordinates,map:this.getMap(),style:n,isScale:!0,pixel:t})},e}(s.Z);e.Z=u},23113:function(t,e,n){var o,i=n(460467),r=n(439881),a=n(745079),s=n(336017),l=n(497734),c=n(998687),u=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),y=function(){return(y=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},p=new Map([["small",3],["normal",10],["large",20]]),h=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return u(e,t),e.drawStartArrow=function(t){var e=t.ctx,n=t.style,o=t.coordinates,i=(t=t.map,e.save(),e.beginPath(),e.lineWidth=n.lineWidth,e.lineJoin=n.lineJoin,e.lineCap=n.lineCap,e.setLineDash(n.lineDash),e.lineDashOffset=n.lineDashOffset,e.strokeStyle=n.strokeStyle,e.fillStyle=n.fillStyle,t.pointToPixel(new BMap.Point(o.point1.lng,o.point1.lat)));t=t.pointToPixel(new BMap.Point(o.point2.lng,o.point2.lat)),t=(o=r.default.getArrowPoints({from:t,to:i,scale:1,width:p.get(n.arrow.size)})).A,i=o.B,n=o.C;e.moveTo(t.x,t.y),e.lineTo(i.x,i.y),e.lineTo(n.x,n.y),e.closePath(),e.stroke(),e.fill(),e.restore()},e.drawEndArrow=function(t){var e=t.ctx,n=t.style,o=t.coordinates,i=(t=t.map,e.save(),e.beginPath(),e.lineWidth=n.lineWidth,e.lineJoin=n.lineJoin,e.lineCap=n.lineCap,e.setLineDash(n.lineDash),e.lineDashOffset=n.lineDashOffset,e.strokeStyle=n.strokeStyle,e.fillStyle=n.fillStyle,t.pointToPixel(new BMap.Point(o.point1.lng,o.point1.lat)));t=t.pointToPixel(new BMap.Point(o.point2.lng,o.point2.lat)),i=(o=r.default.getArrowPoints({from:i,to:t,scale:1,width:p.get(n.arrow.size)})).A,t=o.B,n=o.C;e.moveTo(i.x,i.y),e.lineTo(t.x,t.y),e.lineTo(n.x,n.y),e.closePath(),e.stroke(),e.fill(),e.restore()},e.drawLineString=function(t){var n=t.ctx,o=t.style,i=t.coordinates,r=(t=t.map,n.save(),y(y(y({},a.Z),null!=o?o:{}),{arrow:{draw:!1,direction:"end",type:"normal",size:"normal"}})),s=(n.beginPath(),n.lineWidth=r.lineWidth,n.lineJoin=r.lineJoin,n.lineCap=r.lineCap,n.setLineDash(r.lineDash),n.lineDashOffset=r.lineDashOffset,n.strokeStyle=r.strokeStyle,i.point1),l=i.point2;s=t.pointToPixel(new BMap.Point(s.lng,s.lat)),l=t.pointToPixel(new BMap.Point(l.lng,l.lat));n.moveTo(s.x,s.y),n.lineTo(l.x,l.y),n.stroke(),n.restore(),o.arrow.draw&&("start"===o.arrow.direction?e.drawStartArrow({ctx:n,style:r,coordinates:i,map:t}):"end"===o.arrow.direction?e.drawEndArrow({ctx:n,style:r,coordinates:i,map:t}):"bothEnds"===o.arrow.direction&&(e.drawStartArrow({ctx:n,style:r,coordinates:i,map:t}),e.drawEndArrow({ctx:n,style:r,coordinates:i,map:t})))},e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=null==(t=null==this?void 0:this.getLayer())?void 0:t.getEmitter())&&t.trigger(l.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return y({},this.coordinates)},e.prototype.getType=function(){return l.GeometryType.LineString},e.getCenterCoordinate=function(t){t.ctx;var e=t.coordinates,n=t.map;t.style,t.isScale,t=e.point1,e=e.point2,t=n.pointToPixel(new BMap.Point(t.lng,t.lat)),n=n.pointToPixel(new BMap.Point(e.lng,e.lat));return i.Z.midpoint(t,n)},e.prototype.getCenterCoordinate=function(t){var n=t.ctx,o=t.style;t=t.isScale;return e.getCenterCoordinate({ctx:n,coordinates:this.coordinates,map:this.getMap(),style:o,isScale:t})},e.prototype.draw=function(t,n){e.drawLineString({ctx:t,style:n,coordinates:this.coordinates,map:this.getMap()})},e.prototype.drawText=function(t){var e=t.ctx,n=t.text,o=t.style,r=(t=t.textStyle,e.save(),e.beginPath(),this.getMap()),l=this.getCenterCoordinate({ctx:e,style:o,isScale:!0}),c=(l=(e.translate(l.x,l.y),this.coordinates)).point1;l=l.point2,c=r.pointToPixel(new BMap.Point(c.lng,c.lat)),r=r.pointToPixel(new BMap.Point(l.lng,l.lat)),l=i.Z.slopToRadian(c,r),e.rotate(l),c=y(y({},s.Z),null!=t?t:{}),e.font=c.font,e.textAlign=c.textAlign,e.textBaseline=c.textBaseline,e.direction=c.direction,e.strokeStyle=c.strokeStyle,e.fillStyle=c.fillStyle,r=y(y({},a.Z),null!=o?o:{});e.lineWidth=r.lineWidth,e.lineJoin=r.lineJoin,e.lineCap=r.lineCap,e.setLineDash(r.lineDash),e.lineDashOffset=r.lineDashOffset,e.strokeStyle=r.strokeStyle,e.fillText(n||"",0,0),e.restore()},e.isPixelInGeometry=function(t){var e=t.pixel,n=(t.style,t.coordinates),o=(t=t.map,document.createElement("canvas").getContext("2d"));if(!o)return!1;o.beginPath();var i=n.point1;n=n.point2,i=t.pointToPixel(new BMap.Point(i.lng,i.lat)),t=t.pointToPixel(new BMap.Point(n.lng,n.lat));return o.moveTo(i.x,i.y),o.lineTo(t.x,t.y),o.isPointInPath(e.x,e.y)},e.prototype.isPixelInGeometry=function(t,n){return e.isPixelInGeometry({pixel:t,style:n,coordinates:this.coordinates,map:this.getMap()})},e}(c.Z);e.Z=h},549804:function(t,e,n){var o,i=n(419174),r=n(745079),a=n(497734),s=n(569371),l=n(998687),c=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(){return(u=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},y=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},p=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return c(e,t),e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=null==this?void 0:this.getLayer())&&t.getEmitter().trigger(a.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return y([],this.coordinates,!0)},e.prototype.getType=function(){return a.GeometryType.MulitCircle},e.prototype.getCenterCoordinate=function(t){t.ctx,t.style,t.isScale;t=this.coordinates;var e=this.getMap(),n=[];t.forEach((function(t){t=e.pointToPixel(new BMap.Point(t.center.lng,t.center.lat)),n.push(i.xmu([t.x,t.y]))})),t=i.uf4(n);return{x:(t=i.beQ(t)).geometry.coordinates[0],y:t.geometry.coordinates[1]}},e.prototype.draw=function(t,e){var n=this,o=this.coordinates,i=u(u({},r.Z),null!=e?e:{});o.forEach((function(e){s.Z.drawCircle({ctx:t,style:i,coordinates:e,map:n.getMap(),isScale:!0})}))},e.prototype.isPixelInGeometry=function(t,e){var n=this;return this.coordinates.some((function(o){return s.Z.isPixelInGeometry({coordinates:o,map:n.getMap(),style:e,pixel:t,isScale:!0})}))},e}(l.Z);e.Z=p},139526:function(t,e,n){var o,i=n(419174),r=n(497734),a=n(998687),s=n(808272),l=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},u=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return l(e,t),e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=null==(t=null==this?void 0:this.getLayer())?void 0:t.getEmitter())&&t.trigger(r.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return c([],this.coordinates,!0)},e.prototype.getType=function(){return r.GeometryType.MulitLeaf},e.prototype.getCenterCoordinate=function(t){t.ctx,t.style,t.isScale;t=this.coordinates;var e=[],n=this.getMap();t.forEach((function(t){t=n.pointToPixel(new BMap.Point(t.center.lng,t.center.lat)),e.push(i.xmu([t.x,t.y]))})),t=i.uf4(e);return{x:(t=i.beQ(t)).geometry.coordinates[0],y:t.geometry.coordinates[1]}},e.prototype.draw=function(t,e){var n=this.coordinates,o=this.getMap();n.forEach((function(n){s.Z.drawLeaf({ctx:t,style:e,coordinates:n,map:o,isScale:!0})}))},e.prototype.isPixelInGeometry=function(t,e){var n=this;return this.coordinates.some((function(o){return s.Z.isPixelInGeometry({coordinates:o,map:n.getMap(),pixel:t,style:e,isScale:!0})}))},e}(a.Z);e.Z=u},210685:function(t,e,n){var o,i=n(419174),r=n(745079),a=n(497734),s=n(998687),l=n(23113),c=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(){return(u=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},y=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},p=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return c(e,t),e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=null==this?void 0:this.getLayer())&&t.getEmitter().trigger(a.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return y([],this.coordinates,!0)},e.prototype.getType=function(){return a.GeometryType.MulitLineString},e.prototype.getCenterCoordinate=function(t){t.ctx,t.style,t.isScale;t=this.coordinates;var e=this.getMap(),n=[];t.forEach((function(t){var o=e.pointToPixel(new BMap.Point(t.point1.lng,t.point1.lat));t=e.pointToPixel(new BMap.Point(t.point2.lng,t.point2.lat));n.push(i.xmu([o.x,o.y])),n.push(i.xmu([t.x,t.y]))})),t=i.uf4(n);return{x:(t=i.beQ(t)).geometry.coordinates[0],y:t.geometry.coordinates[1]}},e.prototype.draw=function(t,e){var n=this,o=this.coordinates,i=u(u(u({},r.Z),null!=e?e:{}),{arrow:{draw:!1,direction:"end",type:"normal",size:"normal"}});o.forEach((function(e){l.Z.drawLineString({ctx:t,style:i,coordinates:e,map:n.getMap()})}))},e.prototype.isPixelInGeometry=function(t,e){var n=this;return this.coordinates.some((function(o){return l.Z.isPixelInGeometry({pixel:t,style:e,coordinates:o,map:n.getMap()})}))},e}(s.Z);e.Z=p},408075:function(t,e,n){var o,i=n(419174),r=n(497734),a=n(998687),s=n(930615),l=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},u=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return l(e,t),e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=null==(t=null==this?void 0:this.getLayer())?void 0:t.getEmitter())&&t.trigger(r.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return c([],this.coordinates,!0)},e.prototype.getType=function(){return r.GeometryType.MulitPoint},e.prototype.getCenterCoordinate=function(t){t.ctx,t.style,t.isScale;t=this.coordinates;var e=this.getMap();t=i.uf4(t.map((function(t){return t=e.pointToPixel(new BMap.Point(t.lng,t.lat)),i.xmu([t.x,t.y])})));return{x:(t=i.beQ(t)).geometry.coordinates[0],y:t.geometry.coordinates[1]}},e.prototype.draw=function(t,e){var n=this.coordinates,o=this.getMap();n.forEach((function(n){s.Z.drawPoint({ctx:t,style:e,coordinates:n,map:o})}))},e.prototype.isPixelInGeometry=function(t,e){var n=this;return this.coordinates.some((function(o){return s.Z.isPixelInGeometry({coordinates:o,map:n.getMap(),pixel:t,style:e})}))},e}(a.Z);e.Z=u},631840:function(t,e,n){var o,i=n(419174),r=n(497734),a=n(998687),s=n(532081),l=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},u=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return l(e,t),e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=this.getLayer())&&t.getEmitter().trigger(r.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return c([],this.coordinates,!0)},e.prototype.getType=function(){return r.GeometryType.MulitPolygon},e.prototype.getCenterCoordinate=function(t){t.ctx,t.style,t.isScale;t=this.coordinates;var e=this.getMap();t=t.map((function(t){return t.map((function(t){return[(t=e.pointToPixel(new BMap.Point(t.lng,t.lat))).x,t.y]}))})),t=i.yue(t);return{x:(t=i.MqI(t)).geometry.coordinates[0],y:t.geometry.coordinates[1]}},e.prototype.draw=function(t,e){var n=this.coordinates,o=this.getMap();n.forEach((function(n){s.Z.drawPolygon({ctx:t,style:e,coordinates:n,map:o})}))},e.prototype.isPixelInGeometry=function(t){var e=this;return this.coordinates.some((function(n){return s.Z.isPixelInGeometry({coordinates:n,map:e.getMap(),pixel:t})}))},e}(a.Z);e.Z=u},302005:function(t,e,n){var o,i=n(497734),r=n(697089),a=n(361738),s=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t){function e(e){var n=t.call(this,e)||this;return n.coordinates=e,n}return s(e,t),e.prototype.getType=function(){return i.GeometryType.MulitRadiusRect},e.prototype.draw=function(t,e){var n=this.coordinates,o=this.getMap();n.forEach((function(n){a.Z.drawRadiusRect({ctx:t,style:e,coordinates:n,map:o,isScale:!0})}))},e}(r.Z);e.Z=l},697089:function(t,e,n){var o,i=n(419174),r=n(497734),a=n(998687),s=n(297720),l=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},u=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return l(e,t),e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=null==this?void 0:this.getLayer())&&t.getEmitter().trigger(r.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return c([],this.coordinates,!0)},e.prototype.getType=function(){return r.GeometryType.MulitRect},e.prototype.getCenterCoordinate=function(t){t.ctx,t.style,t.isScale;t=this.coordinates;var e=this.getMap();t=t.map((function(t){return t=e.pointToPixel(new BMap.Point(t.leftTop.lng,t.leftTop.lat)),i.xmu([t.x,t.y])})),t=i.uf4(t);return{x:(t=i.beQ(t)).geometry.coordinates[0],y:t.geometry.coordinates[1]}},e.prototype.draw=function(t,e){var n=this.coordinates,o=this.getMap();n.forEach((function(n){s.Z.drawRect({ctx:t,style:e,coordinates:n,map:o,isScale:!0})}))},e.prototype.isPixelInGeometry=function(t,e){var n=this;return this.coordinates.some((function(o){return s.Z.isPixelInGeometry({coordinates:o,map:n.getMap(),pixel:t,style:e,isScale:!0})}))},e}(a.Z);e.Z=u},126684:function(t,e,n){var o,i=n(419174),r=n(497734),a=n(998687),s=n(812491),l=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},u=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return l(e,t),e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=null==this?void 0:this.getLayer())&&t.getEmitter().trigger(r.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return c([],this.coordinates,!0)},e.prototype.getType=function(){return r.GeometryType.MulitRegularPolygon},e.prototype.getCenterCoordinate=function(t){t.ctx,t.style,t.isScale;t=this.coordinates;var e=[],n=this.getMap();t.forEach((function(t){t=n.pointToPixel(new BMap.Point(t.center.lng,t.center.lat)),e.push(i.xmu([t.x,t.y]))})),t=i.uf4(e);return{x:(t=i.beQ(t)).geometry.coordinates[0],y:t.geometry.coordinates[1]}},e.prototype.draw=function(t,e){var n=this.coordinates,o=this.getMap();n.forEach((function(n){s.Z.drawRegularPolygon({ctx:t,style:e,coordinates:n,map:o,isScale:!0})}))},e.prototype.isPixelInGeometry=function(t,e){var n=this;return this.coordinates.some((function(o){return s.Z.isPixelInGeometry({coordinates:o,map:n.getMap(),pixel:t,style:e,isScale:!0})}))},e}(a.Z);e.Z=u},987779:function(t,e,n){var o,i=n(419174),r=n(497734),a=n(998687),s=n(267582),l=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},u=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return l(e,t),e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=null==this?void 0:this.getLayer())&&t.getEmitter().trigger(r.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return c([],this.coordinates,!0)},e.prototype.getType=function(){return r.GeometryType.MulitSector},e.prototype.getCenterCoordinate=function(t){t.ctx,t.style,t.isScale;t=this.coordinates;var e=[],n=this.getMap();t.forEach((function(t){t=n.pointToPixel(new BMap.Point(t.center.lng,t.center.lat)),e.push(i.xmu([t.x,t.y]))})),t=i.uf4(e);return{x:(t=i.beQ(t)).geometry.coordinates[0],y:t.geometry.coordinates[1]}},e.prototype.draw=function(t,e){var n=this.coordinates,o=this.getMap();n.forEach((function(n){s.Z.drawSector({ctx:t,style:e,coordinates:n,map:o,isScale:!0})}))},e.prototype.isPixelInGeometry=function(t,e){var n=this;return this.coordinates.some((function(o){return s.Z.isPixelInGeometry({coordinates:o,map:n.getMap(),pixel:t,style:e,isScale:!0})}))},e}(a.Z);e.Z=u},918999:function(t,e,n){var o,i=n(419174),r=n(497734),a=n(998687),s=n(891855),l=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},u=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return l(e,t),e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=null==this?void 0:this.getLayer())&&t.getEmitter().trigger(r.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return c([],this.coordinates,!0)},e.prototype.getType=function(){return r.GeometryType.MulitStart},e.prototype.getCenterCoordinate=function(t){t.ctx,t.style,t.isScale;t=this.coordinates;var e=[],n=this.getMap();t.forEach((function(t){t=n.pointToPixel(new BMap.Point(t.center.lng,t.center.lat)),e.push(i.xmu([t.x,t.y]))})),t=i.uf4(e);return{x:(t=i.beQ(t)).geometry.coordinates[0],y:t.geometry.coordinates[1]}},e.prototype.draw=function(t,e){var n=this.coordinates,o=this.getMap();n.forEach((function(n){s.Z.drawStart({ctx:t,style:e,coordinates:n,map:o,isScale:!0})}))},e.prototype.isPixelInGeometry=function(t,e){var n=this;return this.coordinates.some((function(o){return s.Z.isPixelInGeometry({coordinates:o,map:n.getMap(),pixel:t,style:e,isScale:!0})}))},e}(a.Z);e.Z=u},930615:function(t,e,n){var o,i=n(786464),r=n(745079),a=n(497734),s=n(569371),l=n(998687),c=n(808272),u=n(361738),y=n(297720),p=n(812491),h=n(267582),d=n(891855),f=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),g=function(){return(g=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},v=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return f(e,t),e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=null==this?void 0:this.getLayer())&&t.getEmitter().trigger(a.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return g({},this.coordinates)},e.prototype.getType=function(){return a.GeometryType.Point},e.getCenterCoordinate=function(t){var n=t.ctx,o=t.coordinates,i=t.map,r=t.style;t=t.isScale;return e.centerCoordinateMapping.get(r.pointType)({ctx:n,coordinates:o,map:i,style:r,isScale:t})},e.prototype.getCenterCoordinate=function(t){var n=t.ctx,o=t.style;return t.isScale,e.getCenterCoordinate({coordinates:this.coordinates,ctx:n,map:this.getMap(),style:o,isScale:!1})},e.drawCirclePoint=function(t){var e=t.ctx,n=t.style,o=t.coordinates;t=t.map;s.Z.drawCircle({ctx:e,style:n,coordinates:{radius:n.radius,center:o},map:t,isScale:!1})},e.drawImagePoint=function(t){var e,n=t.ctx,o=t.style,r=t.coordinates,a=t.map.pointToPixel(new BMap.Point(r.lng,r.lat));(r=i.Z.get({src:(null==(t=null==o?void 0:o.img)?void 0:t.src)||"",width:(null==(r=null==o?void 0:o.img)?void 0:r.width)||0,height:(null==(t=null==o?void 0:o.img)?void 0:t.height)||0}))?n.drawImage(r,a.x,a.y,o.img.width,o.img.height):((e=new Image(o.img.width,o.img.height)).onload=function(){var t;i.Z.add({src:(null==(t=null==o?void 0:o.img)?void 0:t.src)||"",width:(null==(t=null==o?void 0:o.img)?void 0:t.width)||0,height:(null==(t=null==o?void 0:o.img)?void 0:t.height)||0},e),n.drawImage(e,a.x,a.y,o.img.width,o.img.height)},e.src=o.img.src)},e.drawRegularPolygon=function(t){var e=t.ctx,n=t.style,o=t.coordinates;t=t.map;p.Z.drawRegularPolygon({ctx:e,style:n,coordinates:g(g({},n.regularPolygon),{center:o}),map:t,isScale:!1})},e.drawStart=function(t){var e=t.ctx,n=t.style,o=t.coordinates;t=t.map;d.Z.drawStart({ctx:e,style:n,coordinates:g(g({},n.start),{center:o}),map:t,isScale:!1})},e.drawSector=function(t){var e=t.ctx,n=t.style,o=t.coordinates;t=t.map;h.Z.drawSector({ctx:e,style:n,coordinates:g(g({},n.sector),{center:o}),map:t,isScale:!1})},e.drawRect=function(t){var e=t.ctx,n=t.style,o=t.coordinates;t=t.map;y.Z.drawRect({ctx:e,style:n,coordinates:g(g({},n.rect),{leftTop:o}),map:t,isScale:!1})},e.drawRadiusRect=function(t){var e=t.ctx,n=t.style,o=t.coordinates;t=t.map;u.Z.drawRadiusRect({ctx:e,style:n,coordinates:g(g({},n.radiusRect),{leftTop:o}),map:t,isScale:!1})},e.drawLeaf=function(t){var e=t.ctx,n=t.style,o=t.coordinates;t=t.map;c.Z.drawLeaf({ctx:e,style:n,coordinates:g(g({},n.leaf),{center:o}),map:t,isScale:!1})},e.drawPoint=function(t){var n=t.ctx,o=t.style,i=t.coordinates;t=t.map,o=g(g(g({},r.Z),{radius:5,pointType:"circle"}),null!=o?o:{});e.drawMapping.get(null==o?void 0:o.pointType)({ctx:n,style:o,coordinates:i,map:t})},e.prototype.draw=function(t,n){e.drawPoint({ctx:t,style:n,coordinates:this.coordinates,map:this.getMap()})},e.isPixelInGeometry=function(t){var n=t.coordinates,o=t.map,i=t.pixel;t=t.style;return e.isPixelInGeometryMapping.get(null==t?void 0:t.pointType)({coordinates:e.pointTypeToCoordinatesMapping.get(null==t?void 0:t.pointType)(n,t),isScale:!1,map:o,style:t,pixel:i})},e.prototype.isPixelInGeometry=function(t,n){return e.isPixelInGeometry({coordinates:this.coordinates,pixel:t,map:this.getMap(),style:n})},e.drawMapping=new Map([["circle",e.drawCirclePoint],["image",e.drawImagePoint],["regularPolygon",e.drawRegularPolygon],["start",e.drawStart],["sector",e.drawSector],["rect",e.drawRect],["radiusRect",e.drawRadiusRect],["leaf",e.drawLeaf]]),e.isPixelInGeometryMapping=new Map([["circle",s.Z.isPixelInGeometry],["image",y.Z.isPixelInGeometry],["regularPolygon",p.Z.isPixelInGeometry],["start",d.Z.isPixelInGeometry],["sector",h.Z.isPixelInGeometry],["rect",y.Z.isPixelInGeometry],["radiusRect",u.Z.isPixelInGeometry],["leaf",c.Z.isPixelInGeometry]]),e.centerCoordinateMapping=new Map([["circle",function(t){var e=t.ctx,n=t.coordinates,o=t.map,i=t.style;t=t.isScale;return s.Z.getCenterCoordinate({ctx:e,map:o,style:i,isScale:t,coordinates:{center:n,radius:i.radius}})}],["image",function(t){var e=t.ctx,n=t.coordinates,o=t.map,i=t.style;t=t.isScale;return y.Z.getCenterCoordinate({ctx:e,map:o,style:i,isScale:t,coordinates:g({leftTop:n},i.img)})}],["regularPolygon",function(t){var e=t.ctx,n=t.coordinates,o=t.map,i=t.style;t=t.isScale;return p.Z.getCenterCoordinate({ctx:e,map:o,style:i,isScale:t,coordinates:g({center:n},i.regularPolygon)})}],["start",function(t){var e=t.ctx,n=t.coordinates,o=t.map,i=t.style;t=t.isScale;return d.Z.getCenterCoordinate({ctx:e,map:o,style:i,isScale:t,coordinates:g({center:n},i.start)})}],["sector",function(t){var e=t.ctx,n=t.coordinates,o=t.map,i=t.style;t=t.isScale;return h.Z.getCenterCoordinate({ctx:e,map:o,style:i,isScale:t,coordinates:g({center:n},i.sector)})}],["rect",function(t){var e=t.ctx,n=t.coordinates,o=t.map,i=t.style;t=t.isScale;return y.Z.getCenterCoordinate({ctx:e,map:o,style:i,isScale:t,coordinates:g({leftTop:n},i.rect)})}],["radiusRect",function(t){var e=t.ctx,n=t.coordinates,o=t.map,i=t.style;t=t.isScale;return u.Z.getCenterCoordinate({ctx:e,map:o,style:i,isScale:t,coordinates:g({leftTop:n},i.radiusRect)})}],["leaf",function(t){var e=t.ctx,n=t.coordinates,o=t.map,i=t.style;t=t.isScale;return c.Z.getCenterCoordinate({ctx:e,map:o,style:i,isScale:t,coordinates:g({center:n},i.leaf)})}]]),e.pointTypeToCoordinatesMapping=new Map([["circle",function(t,e){return{center:t,radius:e.radius}}],["image",function(t,e){return{leftTop:t,width:e.img.width,height:e.img.height}}],["regularPolygon",function(t,e){return g({center:t},e.regularPolygon)}],["start",function(t,e){return g({center:t},e.start)}],["sector",function(t,e){return g({center:t},e.sector)}],["rect",function(t,e){return g({leftTop:t},e.rect)}],["radiusRect",function(t,e){return g({leftTop:t},e.radiusRect)}],["leaf",function(t,e){return g({center:t},e.leaf)}]]),e}(l.Z);e.Z=v},532081:function(t,e,n){var o,i=n(419174),r=n(745079),a=n(497734),s=n(998687),l=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(){return(c=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},u=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},y=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return l(e,t),e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=null==this?void 0:this.getLayer())&&t.getEmitter().trigger(a.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return u([],this.coordinates,!0)},e.prototype.getType=function(){return a.GeometryType.Polygon},e.getCenterCoordinate=function(t){t.ctx;var e=t.coordinates,n=t.map;t.style,t.isScale,t=i.yue([e.map((function(t){return[(t=n.pointToPixel(new BMap.Point(t.lng,t.lat))).x,t.y]}))]);return{x:(e=i.MqI(t)).geometry.coordinates[0],y:e.geometry.coordinates[1]}},e.prototype.getCenterCoordinate=function(t){var n=t.ctx,o=t.style;t=t.isScale;return e.getCenterCoordinate({coordinates:this.coordinates,ctx:n,map:this.getMap(),style:o,isScale:t})},e.drawPolygon=function(t){var e=t.ctx,n=t.style,o=t.coordinates,i=t.map;e.save(),t=c(c({},r.Z),null!=n?n:{});e.beginPath(),e.lineWidth=t.lineWidth,e.lineJoin=t.lineJoin,e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.strokeStyle=t.strokeStyle,e.fillStyle=t.fillStyle,o.forEach((function(t,n){t=i.pointToPixel(new BMap.Point(t.lng,t.lat)),0===n?e.moveTo(t.x,t.y):e.lineTo(t.x,t.y)})),e.stroke(),e.fill(),e.restore()},e.prototype.draw=function(t,n){e.drawPolygon({ctx:t,style:n,coordinates:this.coordinates,map:this.getMap()})},e.isPixelInGeometry=function(t){var e=t.coordinates,n=t.map;t=t.pixel,t=i.xmu([t.x,t.y]),e=i.yue([e.map((function(t){return[(t=n.pointToPixel(new BMap.Point(t.lng,t.lat))).x,t.y]}))]);return i.FWy(t,e)},e.prototype.isPixelInGeometry=function(t){return e.isPixelInGeometry({coordinates:this.coordinates,pixel:t,map:this.getMap()})},e}(s.Z);e.Z=y},361738:function(t,e,n){var o,i=n(439881),r=n(745079),a=n(497734),s=n(297720),l=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(){return(c=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},u=function(t){function e(e){var n=t.call(this,e)||this;return n.coordinates=e,n}return l(e,t),e.prototype.getType=function(){return a.GeometryType.RadiusRect},e.drawRadiusRect=function(t){var e=t.ctx,n=t.style,o=t.coordinates,a=t.map,s=(t=t.isScale,n=c(c({},r.Z),null!=n?n:{}),n=(e.save(),e.beginPath(),e.lineWidth=n.lineWidth,e.lineJoin=n.lineJoin,e.lineCap=n.lineCap,e.setLineDash(n.lineDash),e.lineDashOffset=n.lineDashOffset,e.strokeStyle=n.strokeStyle,e.fillStyle=n.fillStyle,o.leftTop),o.width),l=o.height,u=(o=o.radius,n=a.pointToPixel(new BMap.Point(n.lng,n.lat)),a=i.default.getScale(a),s),y=l,p=o;t&&(u=a*s,y=a*l,p=a*o),e.moveTo(n.x,n.y+p),e.arcTo(n.x,n.y,n.x+p,n.y,p),e.lineTo(n.x+u-p,n.y),t={x:n.x+u-p,y:n.y},e.arcTo(t.x+p,n.y,t.x+p,n.y+p,p),t={x:t.x+p,y:n.y+p},e.lineTo(t.x,t.y+(y-2*p)),e.arcTo((t={x:t.x,y:t.y+(y-2*p)}).x,t.y+p,t.x-p,t.y+p,p),e.lineTo((t={x:t.x-p,y:t.y+p}).x-(u-2*p),t.y),e.arcTo((t={x:t.x-(u-2*p),y:t.y}).x-p,t.y,t.x-p,t.y-p,p),e.lineTo((t={x:t.x-p,y:t.y-p}).x,t.y-(y-2*p)),e.stroke(),e.fill(),e.restore()},e.prototype.draw=function(t,n){e.drawRadiusRect({ctx:t,style:n,coordinates:this.coordinates,map:this.getMap(),isScale:!0})},e}(s.Z);e.Z=u},297720:function(t,e,n){var o,i=n(419174),r=n(439881),a=n(745079),s=n(497734),l=n(998687),c=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(){return(u=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},y=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return c(e,t),e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=null==this?void 0:this.getLayer())&&t.getEmitter().trigger(s.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return u({},this.coordinates)},e.prototype.getType=function(){return s.GeometryType.Rect},e.getCenterCoordinate=function(t){t.ctx;var e=t.coordinates,n=t.map,o=(t=(t.style,t.isScale),e.leftTop),a=e.width,s=(e=e.height,o=n.pointToPixel(new BMap.Point(o.lng,o.lat)),n=r.default.getScale(n),a),l=e;t&&(s=n*a,l=n*e),t=i.uf4([i.xmu([o.x,o.y]),i.xmu([o.x+s,o.y]),i.xmu([o.x+s,o.y+l]),i.xmu([o.x,o.y+l])]);return{x:(a=i.beQ(t)).geometry.coordinates[0],y:a.geometry.coordinates[1]}},e.prototype.getCenterCoordinate=function(t){var n=t.ctx,o=t.style;t=t.isScale;return e.getCenterCoordinate({coordinates:this.coordinates,ctx:n,map:this.getMap(),style:o,isScale:t})},e.drawRect=function(t){var e=t.ctx,n=t.style,o=t.coordinates,i=t.map,s=(t=t.isScale,n=(e.save(),u(u({},a.Z),null!=n?n:{})),n=(e.beginPath(),e.lineWidth=n.lineWidth,e.lineJoin=n.lineJoin,e.lineCap=n.lineCap,e.setLineDash(n.lineDash),e.lineDashOffset=n.lineDashOffset,e.strokeStyle=n.strokeStyle,e.fillStyle=n.fillStyle,o.leftTop),o.width),l=(o=o.height,n=i.pointToPixel(new BMap.Point(n.lng,n.lat)),i=r.default.getScale(i),s),c=o;t&&(l=i*s,c=i*o),e.rect(n.x,n.y,l,c),e.stroke(),e.fill(),e.restore()},e.prototype.draw=function(t,n){e.drawRect({ctx:t,style:n,coordinates:this.coordinates,map:this.getMap(),isScale:!0})},e.isPixelInGeometry=function(t){var n=t.coordinates,o=t.map,i=t.style,r=t.pixel,a=(t=t.isScale,document.createElement("canvas").getContext("2d"));return!!a&&(e.drawRect({ctx:a,coordinates:n,style:i,map:o,isScale:t}),a.isPointInPath(r.x,r.y))},e.prototype.isPixelInGeometry=function(t,n){return e.isPixelInGeometry({coordinates:this.coordinates,map:this.getMap(),style:n,isScale:!0,pixel:t})},e}(l.Z);e.Z=y},812491:function(t,e,n){var o,i=n(439881),r=n(745079),a=n(497734),s=n(998687),l=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(){return(c=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},u=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return l(e,t),e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=null==this?void 0:this.getLayer())&&t.getEmitter().trigger(a.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return c({},this.coordinates)},e.prototype.getType=function(){return a.GeometryType.RegularPolygon},e.getCenterCoordinate=function(t){t.ctx;var e=t.coordinates,n=t.map;t.style,t.isScale,t=n.pointToPixel(new BMap.Point(e.center.lng,e.center.lat));return c({},t)},e.prototype.getCenterCoordinate=function(t){var n=t.ctx,o=t.style;t=t.isScale;return e.getCenterCoordinate({coordinates:this.coordinates,ctx:n,map:this.getMap(),style:o,isScale:t})},e.drawRegularPolygon=function(t){for(var e=t.ctx,n=t.style,o=t.coordinates,a=t.map,s=(t=t.isScale,n=(e.save(),c(c({},r.Z),null!=n?n:{})),e.beginPath(),e.lineWidth=n.lineWidth,e.lineJoin=n.lineJoin,e.lineCap=n.lineCap,e.setLineDash(n.lineDash),e.lineDashOffset=n.lineDashOffset,e.strokeStyle=n.strokeStyle,e.fillStyle=n.fillStyle,o.n),l=(n=o.center,o=o.size),u=(t&&(l=i.default.getScale(a)*o),a.pointToPixel(new BMap.Point(n.lng,n.lat))),y=2*Math.PI/s,p=0;p<s;p++){var h=Math.cos(p*y),d=Math.sin(p*y);e.lineTo(h*l+u.x,d*l+u.y)}e.closePath(),e.stroke(),e.fill(),e.restore()},e.prototype.draw=function(t,n){e.drawRegularPolygon({ctx:t,style:n,coordinates:this.coordinates,map:this.getMap(),isScale:!0})},e.isPixelInGeometry=function(t){var n=t.coordinates,o=t.map,i=t.pixel,r=t.style,a=(t=t.isScale,document.createElement("canvas").getContext("2d"));return!!a&&(e.drawRegularPolygon({ctx:a,coordinates:n,style:r,map:o,isScale:t}),a.isPointInPath(i.x,i.y))},e.prototype.isPixelInGeometry=function(t,n){return e.isPixelInGeometry({coordinates:this.coordinates,map:this.getMap(),style:n,isScale:!0,pixel:t})},e}(s.Z);e.Z=u},267582:function(t,e,n){var o,i=n(439881),r=n(745079),a=n(497734),s=n(998687),l=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(){return(c=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},u=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return l(e,t),e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=null==this?void 0:this.getLayer())&&t.getEmitter().trigger(a.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return c({},this.coordinates)},e.prototype.getType=function(){return a.GeometryType.Sector},e.getCenterCoordinate=function(t){t.ctx;var e=t.coordinates,n=t.map;t.style,t.isScale,t=n.pointToPixel(new BMap.Point(e.center.lng,e.center.lat));return c({},t)},e.prototype.getCenterCoordinate=function(t){var n=t.ctx,o=t.style;t=t.isScale;return e.getCenterCoordinate({coordinates:this.coordinates,ctx:n,map:this.getMap(),style:o,isScale:t})},e.drawSector=function(t){var e=t.ctx,n=t.style,o=t.coordinates,a=t.map,s=(t=t.isScale,n=(e.save(),c(c({},r.Z),null!=n?n:{})),n=(e.beginPath(),e.lineWidth=n.lineWidth,e.lineJoin=n.lineJoin,e.lineCap=n.lineCap,e.setLineDash(n.lineDash),e.lineDashOffset=n.lineDashOffset,e.strokeStyle=n.strokeStyle,e.fillStyle=n.fillStyle,o.center),o.radius),l=o.angle1,u=(o=o.angle2,s);t&&(u=i.default.getScale(a)*s),t=a.pointToPixel(new BMap.Point(n.lng,n.lat));e.moveTo(t.x,t.y),e.arc(t.x,t.y,u,l*Math.PI/180,o*Math.PI/180,!1),e.closePath(),e.stroke(),e.fill(),e.restore()},e.prototype.draw=function(t,n){e.drawSector({ctx:t,style:n,coordinates:this.coordinates,map:this.getMap(),isScale:!0})},e.isPixelInGeometry=function(t){var n=t.coordinates,o=t.map,i=t.style,r=t.pixel,a=(t=t.isScale,document.createElement("canvas").getContext("2d"));return!!a&&(e.drawSector({ctx:a,coordinates:n,style:i,map:o,isScale:t}),a.isPointInPath(r.x,r.y))},e.prototype.isPixelInGeometry=function(t,n){return e.isPixelInGeometry({coordinates:this.coordinates,map:this.getMap(),style:n,pixel:t,isScale:!0})},e}(s.Z);e.Z=u},891855:function(t,e,n){var o,i=n(439881),r=n(745079),a=n(497734),s=n(998687),l=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(){return(c=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},u=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return l(e,t),e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=null==this?void 0:this.getLayer())&&t.getEmitter().trigger(a.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return c({},this.coordinates)},e.prototype.getType=function(){return a.GeometryType.Start},e.getCenterCoordinate=function(t){t.ctx;var e=t.coordinates,n=t.map;t.style,t.isScale,t=n.pointToPixel(new BMap.Point(e.center.lng,e.center.lat));return c({},t)},e.prototype.getCenterCoordinate=function(t){var n=t.ctx,o=t.style;t=t.isScale;return e.getCenterCoordinate({coordinates:this.coordinates,ctx:n,map:this.getMap(),style:o,isScale:t})},e.drawStart=function(t){for(var e=t.ctx,n=t.style,o=t.coordinates,a=t.map,s=(t=t.isScale,n=(e.save(),c(c({},r.Z),null!=n?n:{})),n=(e.beginPath(),e.lineWidth=n.lineWidth,e.lineJoin=n.lineJoin,e.lineCap=n.lineCap,e.setLineDash(n.lineDash),e.lineDashOffset=n.lineDashOffset,e.strokeStyle=n.strokeStyle,e.fillStyle=n.fillStyle,o.center),o.innerRadius),l=s,u=o=o.outRadius,y=(t&&(l=(t=i.default.getScale(a))*s,u=t*o),a.pointToPixel(new BMap.Point(n.lng,n.lat))),p=0;p<5;p++)e.lineTo(Math.cos((18+72*p)/180*Math.PI)*u+y.x,-Math.sin((18+72*p)/180*Math.PI)*u+y.y),e.lineTo(Math.cos((54+72*p)/180*Math.PI)*l+y.x,-Math.sin((54+72*p)/180*Math.PI)*l+y.y);e.stroke(),e.fill(),e.restore()},e.prototype.draw=function(t,n){e.drawStart({ctx:t,style:n,coordinates:this.coordinates,map:this.getMap(),isScale:!0})},e.isPixelInGeometry=function(t){var n=t.coordinates,o=t.map,i=t.pixel,r=t.style,a=(t=t.isScale,document.createElement("canvas").getContext("2d"));return!!a&&(e.drawStart({ctx:a,coordinates:n,style:r,map:o,isScale:t}),a.isPointInPath(i.x,i.y))},e.prototype.isPixelInGeometry=function(t,n){return e.isPixelInGeometry({coordinates:this.coordinates,map:this.getMap(),isScale:!0,style:n,pixel:t})},e}(s.Z);e.Z=u},588450:function(t,e,n){var o,i=n(336017),r=n(497734),a=n(998687),s=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(){return(l=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},c=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=e,n}return s(e,t),e.prototype.setCoordinates=function(t){this.coordinates=t,null!=(t=null==this?void 0:this.getLayer())&&t.getEmitter().trigger(r.VectorActions.UPDATE)},e.prototype.getCoordinates=function(){return l({},this.coordinates)},e.prototype.getType=function(){return r.GeometryType.Text},e.getCenterCoordinate=function(t){return l({},t.point)},e.prototype.getCenterCoordinate=function(){return e.getCenterCoordinate(this.coordinates)},e.prototype.draw=function(t,e){t.save();e=l(l({},i.Z),null!=e?e:{}),t.beginPath(),t.font=e.font,t.textAlign=e.textAlign,t.textBaseline=e.textBaseline,t.direction=e.direction,t.fillStyle=e.fillStyle,t.strokeStyle=e.strokeStyle,e=this.getMap();var n=(o=this.coordinates).text,o=o.point;e=e.pointToPixel(new BMap.Point(o.lng,o.lat));t.fillText(n,e.x,e.y),t.restore()},e.prototype.isPixelInGeometry=function(t){return!1},e}(a.Z);e.Z=c},907533:function(t,e,n){n.r(e),n.d(e,{CircleGeometry:function(){return o.Z},Geometry:function(){return i.Z},LeafGeometry:function(){return r.Z},LineStringGeometry:function(){return a.Z},MulitCircleGeometry:function(){return s.Z},MulitLeafGeometry:function(){return l.Z},MulitLineStringGeometry:function(){return c.Z},MulitPointGeometry:function(){return u.Z},MulitPolygonGeometry:function(){return y.Z},MulitRadiusRectGeometry:function(){return p.Z},MulitRectGeometry:function(){return h.Z},MulitRegularPolygonGeometry:function(){return d.Z},MulitSectorGeometry:function(){return f.Z},MulitStartGeometry:function(){return g.Z},PointGeometry:function(){return v.Z},PolygonGeometry:function(){return x.Z},RadiusRectGeometry:function(){return M.Z},RectGeometry:function(){return T.Z},RegularPolygonGeometry:function(){return m.Z},SectorGeometry:function(){return C.Z},StartGeometry:function(){return P.Z},TextGeometry:function(){return w.Z}});var o=n(569371),i=n(998687),r=n(808272),a=n(23113),s=n(549804),l=n(139526),c=n(210685),u=n(408075),y=n(631840),p=n(302005),h=n(697089),d=n(126684),f=n(987779),g=n(918999),v=n(930615),x=n(532081),M=n(361738),T=n(297720),m=n(812491),C=n(267582),P=n(891855),w=n(588450)},187873:function(t,e,n){n.r(e),n.d(e,{Feature:function(){return o.Z},Format:function(){return l},Geom:function(){return c},ImageCache:function(){return i.Z},InnerTextFeature:function(){return r.Z},Interaction:function(){return u},Styles:function(){return y},Trajectory:function(){return p},Types:function(){return h},VectorLayer:function(){return a.Z},VectorSource:function(){return s.Z}});var o=n(952045),i=n(786464),r=n(89083),a=n(652984),s=n(346996),l=n(857789),c=n(907533),u=n(577194),y=n(328051),p=n(253237),h=n(497734)},434160:function(t,e){e.Z={fillStyle:"#fff",strokeStyle:"#fff",lineWidth:1,lineCap:"round",lineJoin:"round",lineDash:[5,4,3],lineDashOffset:-1}},823830:function(t,e){e.Z={strokeStyle:"#fff",lineWidth:1,lineDash:[5,4,3],lineDashOffset:-1,globalAlpha:.6}},754276:function(t,e){e.Z={fillStyle:"rgb(91,155,213,1)",strokeStyle:"rgba(0,0,0,.8)",lineWidth:1,lineCap:"round",lineJoin:"round",lineDash:[],lineDashOffset:-1}},959117:function(t,e,n){var o,i=n(460467),r=n(441930),a=n(439881),s=n(732054),l=n(799443),c=n(635333),u=n(261019),y=n(726985),p=n(155334),h=n(552089),d=n(900839),f=n(117827),g=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),v=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},x="adhere-ui-interactionlayer",M=19999,T=function(t){function e(e,n,o){var i=this;return i.update=i.update.bind(i),(i=t.call(this,{update:i.update,paneName:"markerPane",zIndex:M})||this).map=null,i.el=null,i.listeners=null,i.curAction=null,i.canvasEl=null,i.ctx=null,i.assistCanvasEl=null,i.assistCtx=null,i.canvasData=[],i.emitter=new r.Z.Events,i.isLoad=!1,i.canvasObserver=null,i.typeActionMap=new Map([[f.SelectType.Polygon,y.Z],[f.SelectType.Distance,c.Z],[f.SelectType.Circle,s.Z],[f.SelectType.Rectangle,p.Z],[f.SelectType.Triangle,d.Z],[f.SelectType.Diamond,l.Z],[f.SelectType.Start,h.Z],[f.SelectType.Free,u.Z]]),i.map=e,i.listeners=o,n&&(i.canvasData=n),i.initListeners(),i}return g(e,t),e.prototype.update=function(){this.isLoad?(this.curAction&&this.curAction.destroy(),this.clearDraw(),this.clearAssistDraw(),this.drawHistoryData()):(this.initCanvas(),this.initEvents(),this.clearDraw(),this.clearAssistDraw(),this.drawHistoryData(),this.isLoad=!0)},e.prototype.initListeners=function(){var t=this,e=this.listeners;e&&Object.keys(e).forEach((function(n){t.emitter.on(n,e[n])}))},e.prototype.initEvents=function(){var t=this;this.el.addEventListener("mouseup",(function(e){if(e&&!(2<=e.detail)){for(var n=t.getHistoryData(),o=i.Z.clientToCtxPoint({event:e,rect:t.getCanvasEl().getBoundingClientRect()}),r=[],a=0;a<n.length;a++){var s=n[a],l=t.typeActionMap.get(s.type);"booleanPointInData"in l&&(null==l?void 0:l.booleanPointInData(t,o,s))&&r.push({index:a,data:s})}r.length?t.emitter.trigger(f.InteractionLayerActions.CanvasClickGeometry,JSON.parse(JSON.stringify(r[r.length-1].data))):n.length&&t.emitter.trigger(f.InteractionLayerActions.CanvasClickEmpty)}}))},e.prototype.initCanvas=function(){var t=this;this.el=this.canvas.parentElement,this.canvasEl=this.canvas,this.el.style.width="".concat(this.canvasEl.width,"px"),this.el.style.height="".concat(this.canvasEl.height,"px"),this.canvasEl.className="".concat(x),this.ctx=this.canvasEl.getContext("2d"),this.assistCanvasEl=document.createElement("canvas"),this.assistCanvasEl.className="".concat(x,"-assist"),this.assistCanvasEl.style.zIndex="".concat(parseInt(this.canvasEl.style.zIndex)-1),this.assistCanvasEl.width=this.canvasEl.width,this.assistCanvasEl.height=this.canvasEl.height,this.assistCtx=this.assistCanvasEl.getContext("2d"),this.canvasObserver=new MutationObserver((function(e,n){for(var o=0,i=e;o<i.length;o++){var r=i[o];"attributes"===r.type&&"style"===r.attributeName&&(t.assistCanvasEl.style.left=t.canvasEl.style.left,t.assistCanvasEl.style.top=t.canvasEl.style.top)}})),this.canvasObserver.observe(this.canvasEl,{attributes:!0}),this.el.appendChild(this.assistCanvasEl),this.emitter.trigger(f.InteractionLayerActions.CanvasMount)},e.prototype.enableMap=function(){this.map.enableDoubleClickZoom()},e.prototype.disableMap=function(){this.map.disableDoubleClickZoom()},e.prototype.pixelToPoint=function(t){return{x:(t=this.map.pixelToPoint(t)).lng,y:t.lat}},e.prototype.pointToPixel=function(t){return this.map.pointToPixel(new BMap.Point(t.x,t.y))},e.prototype.distanceToActual=function(t){return t/a.default.getScale(this.map)},e.prototype.actualToDistance=function(t){return a.default.getScale(this.map)*t},e.prototype.getCtx=function(){return this.ctx},e.prototype.getCanvasEl=function(){return this.canvasEl},e.prototype.getAssistCanvasEl=function(){return this.assistCanvasEl},e.prototype.getAssistCtx=function(){return this.assistCtx},e.prototype.getWidth=function(){var t;return null==(t=null==this?void 0:this.getCanvasEl())?void 0:t.width},e.prototype.getHeight=function(){var t;return null==(t=null==this?void 0:this.getCanvasEl())?void 0:t.height},e.prototype.addHistoryData=function(t){this.canvasData.push(t)},e.prototype.removeHistoryDataById=function(t){var e=this.canvasData.findIndex((function(e){return e.id===t}));return-1===e?[]:this.canvasData.splice(e,1)},e.prototype.drawHistoryData=function(){var t=this;this.canvasData.forEach((function(e){var n,o=t.ctx;o&&e&&(e.style&&(o.lineWidth=e.style.lineWidth,o.lineJoin=e.style.lineJoin,o.lineCap=e.style.lineCap,o.setLineDash(e.style.lineDash),o.lineDashOffset=e.style.lineDashOffset,o.strokeStyle=e.style.strokeStyle,o.fillStyle=e.style.fillStyle),null!=(n=t.typeActionMap.get(e.type)))&&n.drawHistoryPath(t,o,e.data)}))},e.prototype.getHistoryDataById=function(t){return this.canvasData.find((function(e){return e.id===t}))},e.prototype.getHistoryData=function(){return v([],this.canvasData,!0)},e.prototype.setHistoryData=function(t){this.canvasData=t},e.prototype.changeAction=function(t){t===this.curAction||t&&t.getStatus()!==f.ActionStatus.UnStart||(this.disableMap(),this.curAction&&this.curAction.destroy(),null!=t&&t.setContext(this),this.curAction=t)},e.prototype.getCurAction=function(){return this.curAction},e.prototype.start=function(t){this.curAction&&this.curAction.start(t)},e.prototype.end=function(){this.curAction&&this.curAction.end()},e.prototype.clearDraw=function(){var t=this.ctx;t&&t.clearRect(0,0,this.getWidth(),this.getHeight())},e.prototype.clearAssistDraw=function(){var t=this.assistCtx;t&&t.clearRect(0,0,this.getWidth(),this.getHeight())},e.prototype.setFrontCanvas=function(t){t.style.zIndex="".concat(2e4)},e.prototype.setBackCanvas=function(t){t.style.zIndex="".concat(19998)},e.prototype.destroy=function(){this.curAction&&this.curAction.destroy(),this.canvasObserver&&this.canvasObserver.disconnect()},e.prototype.getMap=function(){return this.map},e}(BMap.CanvasLayer);e.Z=T},732054:function(t,e,n){var o,i=n(460467),r=n(117827),a=n(361682),s=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t){function e(){var e=t.call(this)||this;return e.centerPoint=null,e.isMove=!1,e.radius=0,e.onCanvasMouseDown=e.onCanvasMouseDown.bind(e),e.onCanvasMouseMove=e.onCanvasMouseMove.bind(e),e.onCanvasMouseUp=e.onCanvasMouseUp.bind(e),e}return s(e,t),e.booleanPointInData=function(t,n,o){return i.Z.isPointInCircle(n,e.transformOriginToReal(t,o.data))},e.prototype.draw=function(t){var e,n=(r=this).context,o=r.centerPoint,r=r.style,a=null==n?void 0:n.getCtx();n&&a&&o&&(e=n.getCanvasEl())&&(t=i.Z.clientToCtxPoint({event:t,rect:null==e?void 0:e.getBoundingClientRect()}))&&(n.clearDraw(),n.drawHistoryData(),a.beginPath(),this.radius=i.Z.getDistanceByBetweenPoint({p1:o,p2:t}),a.lineWidth=r.lineWidth,a.lineJoin=r.lineJoin,a.lineCap=r.lineCap,a.setLineDash(r.lineDash),a.lineDashOffset=r.lineDashOffset,a.strokeStyle=r.strokeStyle,a.fillStyle=r.fillStyle,a.ellipse((null==o?void 0:o.x)||0,(null==o?void 0:o.y)||0,this.radius,this.radius,45*Math.PI/180,0,2*Math.PI),a.stroke(),a.fill())},e.draw=function(t,n,o){n&&o&&(o.style&&(n.lineWidth=o.style.lineWidth,n.lineJoin=o.style.lineJoin,n.lineCap=o.style.lineCap,n.setLineDash(o.style.lineDash),n.lineDashOffset=o.style.lineDashOffset,n.strokeStyle=o.style.strokeStyle,n.fillStyle=o.style.fillStyle,n.globalAlpha=o.style.globalAlpha||1),e.drawHistoryPath(t,n,o.data),n.stroke(),n.fill())},e.drawHistoryPath=function(t,e,n){var o=t.pointToPixel(n.center);t=t.actualToDistance(n.radius);e.save(),e.beginPath(),e.ellipse(o.x,o.y,t,t,45*Math.PI/180,0,2*Math.PI),e.stroke(),e.fill(),e.restore()},e.prototype.onCanvasMouseDown=function(t){var e;this.context&&(e=this.context.getCanvasEl())&&(this.centerPoint=i.Z.clientToCtxPoint({event:t,rect:null==e?void 0:e.getBoundingClientRect()}),null!=e&&e.addEventListener("mousemove",this.onCanvasMouseMove),null!=e&&e.addEventListener("mouseup",this.onCanvasMouseUp),t.stopPropagation())},e.prototype.onCanvasMouseMove=function(t){var e=this.context;e&&e.getCtx()&&(this.isMove=!0,this.draw(t),t.stopPropagation())},e.prototype.onCanvasMouseUp=function(t){this.isMove&&(this.end(t),t.stopPropagation())},e.transformRealToOrigin=function(t,e){return{center:t.pixelToPoint(e.center),radius:t.distanceToActual(e.radius)}},e.transformOriginToReal=function(t,e){return{center:t.pointToPixel(e.center),radius:t.actualToDistance(e.radius)}},e.prototype.getSelectType=function(){return r.SelectType.Circle},e.prototype.start=function(e){var n;this.context&&![r.ActionStatus.Running,r.ActionStatus.Destroy].includes(this.status)&&(n=this.context.getCanvasEl())&&(t.prototype.start.call(this,e),e&&(this.style=e),this.trigger(r.ActionEvents.BeforeStart,{selectType:this.getSelectType(),actionType:r.ActionType.Draw}),null!=n&&n.addEventListener("mousedown",this.onCanvasMouseDown),this.status=r.ActionStatus.Running,this.trigger(r.ActionEvents.Start,{selectType:this.getSelectType(),actionType:r.ActionType.Draw}))},e.prototype.end=function(n){var o,a=this.context;a&&(o=a.getCanvasEl())&&(null!=o&&o.removeEventListener("mousedown",this.onCanvasMouseDown),null!=o&&o.removeEventListener("mousemove",this.onCanvasMouseMove),null!=o&&o.removeEventListener("mouseup",this.onCanvasMouseUp),n&&this.draw(n),this.status=r.ActionStatus.End,o={id:i.Z.uuid(),type:this.getSelectType(),data:e.transformRealToOrigin(a,{center:this.centerPoint,radius:this.radius}),style:this.style},a.addHistoryData(o),this.centerPoint=null,this.radius=0,this.isMove=!1,this.trigger(r.ActionEvents.End,{selectType:this.getSelectType(),actionType:r.ActionType.Draw,data:o})),t.prototype.end.call(this,n)},e.prototype.destroy=function(){var e,n=this.context;n&&(e=n.getCanvasEl())&&(this.status===r.ActionStatus.Running&&(n.clearDraw(),n.drawHistoryData()),null!=e&&e.removeEventListener("mousedown",this.onCanvasMouseDown),null!=e&&e.removeEventListener("mousemove",this.onCanvasMouseMove),null!=e&&e.removeEventListener("mouseup",this.onCanvasMouseUp),this.centerPoint=null,this.radius=0,this.isMove=!1,this.status=r.ActionStatus.Destroy,this.trigger(r.ActionEvents.Destroy,{selectType:this.getSelectType(),actionType:r.ActionType.Draw})),t.prototype.destroy.call(this)},e}(a.Z);e.Z=l},799443:function(t,e,n){var o,i=n(460467),r=n(419174),a=n(117827),s=n(781777),l=n(361682),c=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(t){function e(){var e=t.call(this)||this;return e.startPoint=null,e.leftTopPoint=null,e.width=0,e.height=0,e.isMove=!1,e.onCanvasMouseDown=e.onCanvasMouseDown.bind(e),e.onCanvasMouseMove=e.onCanvasMouseMove.bind(e),e.onCanvasMouseUp=e.onCanvasMouseUp.bind(e),e}return c(e,t),e.booleanPointInData=function(t,n,o){o=(t=e.transformOriginToReal(t,o.data)).leftTopPoint;var i=(s=t.width)/2,a=(t=t.height)/2,s=(n=r.xmu([n.x,n.y]),r.yue([[[o.x,o.y+a],[o.x+i,o.y],[o.x+s,o.y+a],[o.x+i,o.y+t],[o.x,o.y+a]]]));return r.FWy(n,s)},e.prototype.draw=function(t){var e,n=(r=this).context,o=r.startPoint,r=r.style,a=null==n?void 0:n.getCtx();n&&a&&(e=n.getCanvasEl())&&(t=i.Z.clientToCtxPoint({event:t,rect:null==e?void 0:e.getBoundingClientRect()}),n.clearDraw(),n.drawHistoryData(),a.beginPath(),this.leftTopPoint=s.Z.getRectLeftTopPoint({startPoint:o,targetPoint:t}),this.leftTopPoint)&&(this.width=Math.abs(t.x-((null==o?void 0:o.x)||0)),this.height=Math.abs(t.y-((null==o?void 0:o.y)||0)),e=this.width/2,n=this.height/2,a.lineWidth=r.lineWidth,a.lineJoin=r.lineJoin,a.lineCap=r.lineCap,a.setLineDash(r.lineDash),a.lineDashOffset=r.lineDashOffset,a.strokeStyle=r.strokeStyle,a.fillStyle=r.fillStyle,a.moveTo(this.leftTopPoint.x,this.leftTopPoint.y+n),a.lineTo(this.leftTopPoint.x+e,this.leftTopPoint.y),a.lineTo(this.leftTopPoint.x+this.width,this.leftTopPoint.y+n),a.lineTo(this.leftTopPoint.x+e,this.leftTopPoint.y+this.height),a.stroke(),a.fill())},e.draw=function(t,e,n){e&&n&&(n.style&&(e.lineWidth=n.style.lineWidth,e.lineJoin=n.style.lineJoin,e.lineCap=n.style.lineCap,e.setLineDash(n.style.lineDash),e.lineDashOffset=n.style.lineDashOffset,e.strokeStyle=n.style.strokeStyle,e.fillStyle=n.style.fillStyle,e.globalAlpha=n.style.globalAlpha||1),this.drawHistoryPath(t,e,n.data),e.stroke(),e.fill())},e.drawHistoryPath=function(t,n,o){var i;n.save(),n.beginPath(),o&&o.leftTopPoint&&(o=(t=e.transformOriginToReal(t,o)).width/2,i=t.height/2,n.moveTo(t.leftTopPoint.x,t.leftTopPoint.y+i),n.lineTo(t.leftTopPoint.x+o,t.leftTopPoint.y),n.lineTo(t.leftTopPoint.x+t.width,t.leftTopPoint.y+i),n.lineTo(t.leftTopPoint.x+o,t.leftTopPoint.y+t.height),n.stroke(),n.fill(),n.restore())},e.prototype.onCanvasMouseDown=function(t){var e;this.context&&(e=this.context.getCanvasEl())&&(this.startPoint=i.Z.clientToCtxPoint({event:t,rect:null==e?void 0:e.getBoundingClientRect()}),null!=e&&e.addEventListener("mousemove",this.onCanvasMouseMove),null!=e&&e.addEventListener("mouseup",this.onCanvasMouseUp),t.stopPropagation())},e.prototype.onCanvasMouseMove=function(t){this.context&&(this.isMove=!0,this.draw(t),t.stopPropagation())},e.prototype.onCanvasMouseUp=function(t){this.isMove&&(this.end(t),t.stopPropagation())},e.transformOriginToReal=function(t,e){return{leftTopPoint:t.pointToPixel(e.leftTopPoint),width:t.actualToDistance(e.width),height:t.actualToDistance(e.height)}},e.transformRealToOrigin=function(t,e){return{leftTopPoint:t.pixelToPoint(e.leftTopPoint),width:t.distanceToActual(e.width),height:t.distanceToActual(e.height)}},e.prototype.getSelectType=function(){return a.SelectType.Diamond},e.prototype.start=function(e){var n;this.context&&![a.ActionStatus.Running,a.ActionStatus.Destroy].includes(this.status)&&(n=this.context.getCanvasEl())&&(t.prototype.start.call(this,e),e&&(this.style=e),this.trigger(a.ActionEvents.BeforeStart,{selectType:this.getSelectType(),actionType:a.ActionType.Draw}),null!=n&&n.addEventListener("mousedown",this.onCanvasMouseDown),this.status=a.ActionStatus.Running,this.trigger(a.ActionEvents.Start,{selectType:this.getSelectType(),actionType:a.ActionType.Draw}))},e.prototype.end=function(n){var o,r=this.context;r&&(o=r.getCanvasEl())&&(null!=o&&o.removeEventListener("mousedown",this.onCanvasMouseDown),null!=o&&o.removeEventListener("mousemove",this.onCanvasMouseMove),null!=o&&o.removeEventListener("mouseup",this.onCanvasMouseUp),n&&this.draw(n),this.status=a.ActionStatus.End,o={id:i.Z.uuid(),type:this.getSelectType(),data:e.transformRealToOrigin(r,{leftTopPoint:this.leftTopPoint,width:this.width,height:this.height}),style:this.style},r.addHistoryData(o),this.startPoint=null,this.leftTopPoint=null,this.width=0,this.height=0,this.isMove=!1,this.trigger(a.ActionEvents.End,{selectType:this.getSelectType(),actionType:a.ActionType.Draw,data:o})),t.prototype.end.call(this,n)},e.prototype.destroy=function(){var e,n=this.context;n&&(e=n.getCanvasEl())&&(this.status===a.ActionStatus.Running&&(n.clearDraw(),n.drawHistoryData()),null!=e&&e.removeEventListener("mousedown",this.onCanvasMouseDown),null!=e&&e.removeEventListener("mousemove",this.onCanvasMouseMove),null!=e&&e.removeEventListener("mouseup",this.onCanvasMouseUp),this.startPoint=null,this.leftTopPoint=null,this.width=0,this.height=0,this.isMove=!1,this.status=a.ActionStatus.Destroy,this.trigger(a.ActionEvents.Destroy,{selectType:this.getSelectType(),actionType:a.ActionType.Draw})),t.prototype.destroy.call(this)},e}(l.Z);e.Z=u},635333:function(t,e,n){var o,i=n(460467),r=n(355360),a=n(361738),s=n(586152),l=n(745079),c=n(754276),u=n(117827),y=n(726985),p=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),h=function(){return(h=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},d=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},f=function(t){function e(){var e=t.call(this)||this;return e.style=h(h({},c.Z),{strokeStyle:"red"}),e.onCanvasClick=e.onCanvasClick.bind(e),e.onCanvasMousemove=e.onCanvasMousemove.bind(e),e.onCanvasDbClick=e.onCanvasDbClick.bind(e),e.onCursorMouseMove=e.onCursorMouseMove.bind(e),e.onDelete=e.onDelete.bind(e),e}return p(e,t),e.prototype.onCursorMouseMove=function(t){var e=this.context,n=this.pointStack;if(e){var o=e.getCanvasEl(),s=(t=i.Z.clientToCtxPoint({event:t,rect:null==o?void 0:o.getBoundingClientRect()}),0);if(n.length){for(var c=0;c<n.length-1;c++){var u=n[c],y=n[c+1];s+=i.Z.getDistanceByBetweenPoint({p1:u,p2:y})}o=i.Z.getDistanceByBetweenPoint({p1:n[n.length-1],p2:t}),s=e.distanceToActual(s+o),o=e.getCtx(),t={x:t.x+10,y:t.y-25};var p=e.pixelToPoint(t),d=(p=(a.Z.drawRadiusRect({ctx:o,style:h(h({},l.Z),{lineWidth:1,strokeStyle:"red",fillStyle:"#fff"}),coordinates:{leftTop:{lng:p.x,lat:p.y},width:120,height:50,radius:2},map:e.getMap(),isScale:!1}),""),e="",e=s<1e3?(p="".concat(s.toFixed(2)),r.ZP.v("米")):(p="".concat(i.Z.distance(s,"kilometer").toFixed(2)),r.ZP.v("公里")),"10px sans-serif"),f="bottom",g=t.x+60,v=t.y+25,x=o.measureText(p).width/2;o.beginPath(),o.font=d,o.textAlign="right",o.textBaseline=f,o.fillStyle="#000",o.fillText("".concat(r.ZP.v("总长"),"："),g-x,v,o.measureText("".concat(r.ZP.v("总长"),"：")).width),o.beginPath(),o.font=d,o.textAlign="center",o.textBaseline=f,o.fillStyle="red",o.fillText(p,g,v,o.measureText(p).width),o.beginPath(),o.font=d,o.textAlign="left",o.textBaseline=f,o.fillStyle="#000",o.fillText(e,g+x,v,o.measureText(e).width),o.beginPath(),o.font=d,o.textAlign="center",o.textBaseline=f,o.fillStyle="#000",o.fillText(r.ZP.v("单击确定地点，双击结束"),g,t.y+37.5+3,o.measureText(r.ZP.v("单击确定地点，双击结束")).width)}}},e.drawHistoryPath=function(t,e,n){var o=this;void 0===n&&(n=[]),e.save(),e.beginPath(),(y.Z.transformOriginToReal(t,n)||[]).forEach((function(t,n){0===n?e.moveTo(t.x,t.y):e.lineTo(t.x,t.y)})),e.stroke(),e.restore(),n.forEach((function(i){o.drawStartPoint({context:t,ctx:e,style:s.Z,pointStack:n,toPoint:i})}))},e.drawStartPoint=function(t){var e=t.context,n=t.ctx,o=t.style,s=t.pointStack,c=t.toPoint,u=(t=e.pointToPixel(c),s.findIndex((function(t){return JSON.stringify(t)===JSON.stringify(c)})));n.save(),n.beginPath(),n.fillStyle=o.fillStyle,n.strokeStyle=o.strokeStyle,n.lineWidth=o.lineWidth,n.ellipse(t.x,t.y,6,6,45*Math.PI/180,0,2*Math.PI),n.stroke(),n.fill(),n.restore(),n.save(),n.beginPath(),n.font="9px sans-serif",n.textAlign="center",n.textBaseline="middle",n.fillStyle="blue",n.fillText("".concat(u+1),t.x,t.y),n.restore(),o={x:t.x+10,y:t.y-10},t=e.pixelToPoint(o),a.Z.drawRadiusRect({ctx:n,style:h(h({},l.Z),{lineWidth:1,strokeStyle:"#000",fillStyle:"#fff"}),coordinates:{leftTop:{lng:t.x,lat:t.y},width:50,height:20,radius:2},map:e.getMap(),isScale:!1}),t="";if(0===u)t=r.ZP.v("起点");else{for(var y=0,p=0;p<u;p++){var d=e.pointToPixel(s[p]),f=e.pointToPixel(s[p+1]);y+=i.Z.getDistanceByBetweenPoint({p1:d,p2:f})}t=(y=e.distanceToActual(y))<1e3?"".concat(y.toFixed(2)).concat(r.ZP.v("米")):"".concat(i.Z.distance(y,"kilometer").toFixed(2)).concat(r.ZP.v("公里"))}n.save(),n.beginPath(),n.font="10px sans-serif",n.textAlign="center",n.textBaseline="middle",n.fillStyle="#000",n.fillText(t,o.x+25,o.y+10),n.restore()},e.prototype.drawStartPoint=function(){var t,n,o=this.context,i=this.startPoint;o&&(t=o.getCtx())&&(n=this.pointStack,e.drawStartPoint({context:o,ctx:t,style:s.Z,pointStack:y.Z.transformRealToOrigin(o,d([],n,!0)),toPoint:o.pixelToPoint(i)}))},e.prototype.fill=function(){var t=this.context;if(t){var n=this.pointStack,o=t.getCtx();if(o)if(n.length<=1)1===n.length&&e.drawStartPoint({context:t,ctx:t.getCtx(),style:s.Z,pointStack:y.Z.transformRealToOrigin(t,n),toPoint:t.pixelToPoint(n[0])});else{o.fillStyle=this.style.fillStyle,o.save(),o.beginPath();for(var i=0;i<n.length;i++){var r=n[i];0===i?o.moveTo(r.x,r.y):o.lineTo(r.x,r.y)}o.stroke(),o.restore();var a=y.Z.transformRealToOrigin(t,n);a.forEach((function(n,i){e.drawStartPoint({context:t,ctx:o,style:s.Z,pointStack:a,toPoint:a[i]})}))}}},e.prototype.drawStack=function(){var t=this.pointStack,n=this.context;if(n)if(t.length<=1)1===t.length&&e.drawStartPoint({context:n,ctx:n.getCtx(),style:s.Z,pointStack:y.Z.transformRealToOrigin(n,t),toPoint:n.pixelToPoint(t[0])});else for(var o=0;o!==t.length-1&&this.drawLine(t[o],t[o+1]),e.drawStartPoint({context:n,ctx:n.getCtx(),style:s.Z,pointStack:y.Z.transformRealToOrigin(n,t),toPoint:n.pixelToPoint(t[o])}),++o<t.length;);},e.prototype.getCanvasClick=function(){return this.onCanvasClick},e.prototype.getCanvasMousemove=function(){return this.onCanvasMousemove},e.prototype.getCanvasDbClick=function(){return this.onCanvasDbClick},e.prototype.onCanvasClick=function(e){2<=e.detail||(t.prototype.onCanvasClick.call(this,e),this.drawStartPoint())},e.prototype.onCanvasMousemove=function(e){t.prototype.onCanvasMousemove.call(this,e),this.onCursorMouseMove(e)},e.prototype.onCanvasDbClick=function(e){t.prototype.onCanvasDbClick.call(this,e)},e.prototype.onDelete=function(t,e){var n,o,i,r=this.context;r&&(n=r.getMap(),-1!==(i=null==(o=null==r?void 0:r.getHistoryData())?void 0:o.findIndex((function(t){return t.id===e}))))&&(null!=o&&o.splice(i,1),r.setHistoryData(o),r.clearDraw(),r.drawHistoryData(),n.removeOverlay(t))},e.drawDeleteMark=function(t){var e,n=t.context,o=t.point,i=t.onDelete,r=(t=n.getMap(),new BMap.Icon("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjMxMTk1MDc3NjM5IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjExMjQ1IiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48ZGVmcz48c3R5bGUgdHlwZT0idGV4dC9jc3MiPjwvc3R5bGU+PC9kZWZzPjxwYXRoIGQ9Ik0xNTkuMjE1NDg0IDI4NC43MzgwNjVoNzE1LjQ3ODcxYzEzLjIxMjkwMyAwIDIzLjc4MzIyNi0xMC41NzAzMjMgMjMuNzgzMjI1LTIzLjc4MzIyNnMtMTAuNTcwMzIzLTIzLjc4MzIyNi0yMy43ODMyMjUtMjMuNzgzMjI2SDE1OS4yMTU0ODRjLTEzLjIxMjkwMyAwLTIzLjc4MzIyNiAxMC41NzAzMjMtMjMuNzgzMjI2IDIzLjc4MzIyNnMxMC41NzAzMjMgMjMuNzgzMjI2IDIzLjc4MzIyNiAyMy43ODMyMjYiIHAtaWQ9IjExMjQ2IiBmaWxsPSIjZDgxZTA2Ij48L3BhdGg+PHBhdGggZD0iTTM1Ny40MDkwMzIgMzU2LjA4Nzc0MnY0MTMuNTYzODcxYzAgMTMuMjEyOTAzIDEwLjU3MDMyMyAyMy43ODMyMjYgMjMuNzgzMjI2IDIzLjc4MzIyNnMyMy43ODMyMjYtMTAuNTcwMzIzIDIzLjc4MzIyNi0yMy43ODMyMjZWMzU2LjA4Nzc0MmMwLTEzLjIxMjkwMy0xMC41NzAzMjMtMjMuNzgzMjI2LTIzLjc4MzIyNi0yMy43ODMyMjYtMTIuNTUyMjU4IDAtMjMuNzgzMjI2IDEwLjU3MDMyMy0yMy43ODMyMjYgMjMuNzgzMjI2IiBwLWlkPSIxMTI0NyIgZmlsbD0iI2Q4MWUwNiI+PC9wYXRoPjxwYXRoIGQ9Ik01MDAuNzY5MDMyIDM1Ni4wODc3NDJ2NDEzLjU2Mzg3MWMwIDEzLjIxMjkwMyAxMC41NzAzMjMgMjMuNzgzMjI2IDIzLjc4MzIyNiAyMy43ODMyMjZzMjMuNzgzMjI2LTEwLjU3MDMyMyAyMy43ODMyMjYtMjMuNzgzMjI2VjM1Ni4wODc3NDJjMC0xMy4yMTI5MDMtMTAuNTcwMzIzLTIzLjc4MzIyNi0yMy43ODMyMjYtMjMuNzgzMjI2cy0yMy43ODMyMjYgMTAuNTcwMzIzLTIzLjc4MzIyNiAyMy43ODMyMjYiIHAtaWQ9IjExMjQ4IiBmaWxsPSIjZDgxZTA2Ij48L3BhdGg+PHBhdGggZD0iTTYyNy42MTI5MDMgMzU2LjA4Nzc0MnY0MTMuNTYzODcxYzAgMTMuMjEyOTAzIDEwLjU3MDMyMyAyMy43ODMyMjYgMjMuNzgzMjI2IDIzLjc4MzIyNnMyMy43ODMyMjYtMTAuNTcwMzIzIDIzLjc4MzIyNi0yMy43ODMyMjZWMzU2LjA4Nzc0MmMwLTEzLjIxMjkwMy0xMC41NzAzMjMtMjMuNzgzMjI2LTIzLjc4MzIyNi0yMy43ODMyMjZTNjI3LjYxMjkwMyAzNDIuODc0ODM5IDYyNy42MTI5MDMgMzU2LjA4Nzc0MiIgcC1pZD0iMTEyNDkiIGZpbGw9IiNkODFlMDYiPjwvcGF0aD48cGF0aCBkPSJNNzU1LjExNzQxOSAyNzYuODEwMzIzdjU0MC40MDc3NDJjMCAxMy4yMTI5MDMtMTAuNTcwMzIzIDIzLjc4MzIyNi0yMy43ODMyMjUgMjMuNzgzMjI1aC00MjkuNDE5MzU1Yy0xMy4yMTI5MDMgMC0yMy43ODMyMjYtMTAuNTcwMzIzLTIzLjc4MzIyNi0yMy43ODMyMjVWMjc2LjgxMDMyM2MwLTEzLjIxMjkwMy0xMC41NzAzMjMtMjMuNzgzMjI2LTIzLjc4MzIyNi0yMy43ODMyMjZzLTIzLjc4MzIyNiAxMC41NzAzMjMtMjMuNzgzMjI2IDIzLjc4MzIyNnY1NDAuNDA3NzQyYzAgMzkuNjM4NzEgMzEuNzEwOTY4IDcxLjM0OTY3NyA3MS4zNDk2NzggNzEuMzQ5Njc3aDQyOS40MTkzNTVjMzkuNjM4NzEgMCA3MS4zNDk2NzctMzEuNzEwOTY4IDcxLjM0OTY3Ny03MS4zNDk2NzdWMjc2LjgxMDMyM2MwLTEzLjIxMjkwMy0xMC41NzAzMjMtMjMuNzgzMjI2LTIzLjc4MzIyNi0yMy43ODMyMjZzLTIzLjc4MzIyNiAxMC41NzAzMjMtMjMuNzgzMjI2IDIzLjc4MzIyNnoiIHAtaWQ9IjExMjUwIiBmaWxsPSIjZDgxZTA2Ij48L3BhdGg+PHBhdGggZD0iTTM4OS43ODA2NDUgMjQ1LjA5OTM1NXYtNDcuNTY2NDUyYzAtMjEuODAxMjkgMTcuODM3NDE5LTM5LjYzODcxIDM5LjYzODcxLTM5LjYzODcwOWgxNzUuMDcwOTY4YzIxLjgwMTI5IDAgMzkuNjM4NzEgMTcuODM3NDE5IDM5LjYzODcwOSAzOS42Mzg3MDl2NDcuNTY2NDUyYzAgMTMuMjEyOTAzIDEwLjU3MDMyMyAyMy43ODMyMjYgMjMuNzgzMjI2IDIzLjc4MzIyNnMyMy43ODMyMjYtMTAuNTcwMzIzIDIzLjc4MzIyNi0yMy43ODMyMjZ2LTQ3LjU2NjQ1MmMwLTQ4LjIyNzA5Ny0zOC45NzgwNjUtODcuMjA1MTYxLTg3LjIwNTE2MS04Ny4yMDUxNjFINDI5LjQxOTM1NWMtNDguMjI3MDk3IDAtODcuMjA1MTYxIDM4Ljk3ODA2NS04Ny4yMDUxNjEgODcuMjA1MTYxdjQ3LjU2NjQ1MmMwIDEzLjIxMjkwMyAxMC41NzAzMjMgMjMuNzgzMjI2IDIzLjc4MzIyNSAyMy43ODMyMjYgMTIuNTUyMjU4IDAgMjMuNzgzMjI2LTEwLjU3MDMyMyAyMy43ODMyMjYtMjMuNzgzMjI2eiIgcC1pZD0iMTEyNTEiIGZpbGw9IiNkODFlMDYiPjwvcGF0aD48L3N2Zz4=",new BMap.Size(30,30)));(e=n.pointToPixel(o)).x+=22,e.y+=30,o=n.pixelToPoint(e),n=new BMap.Point(o.x,o.y);return(e=new BMap.Marker(n,{icon:r})).addEventListener("click",(function(){i&&i()})),t.addOverlay(e),e},e.prototype.getSelectType=function(){return u.SelectType.Distance},e.prototype.start=function(e){var n=null==(n=null==this?void 0:this.context)?void 0:n.getMap();n.disableDragging(),n.disableScrollWheelZoom(),n.disableDoubleClickZoom(),n.disableContinuousZoom(),n.disablePinchToZoom(),t.prototype.start.call(this,e)},e.prototype.end=function(){var n,o,i,r=this,a=this.context;a&&((n=a.getMap()).enableDragging(),n.enableScrollWheelZoom(),n.enableDoubleClickZoom(),n.enableContinuousZoom(),n.enablePinchToZoom(),o=e.drawDeleteMark({context:a,point:a.pixelToPoint(this.pointStack[this.pointStack.length-1]),onDelete:function(){r.onDelete(o,i)}}),i=t.prototype.end.call(this))},e.prototype.destroy=function(){t.prototype.destroy.call(this);var e=null==(e=null==this?void 0:this.context)?void 0:e.getMap();e.enableDragging(),e.enableScrollWheelZoom(),e.enableDoubleClickZoom(),e.enableContinuousZoom(),e.enablePinchToZoom()},e.prototype.setCursor=function(){var t=this.context;t&&(t=t.getCanvasEl())&&(t.style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjMxMDY4ODUyOTU4IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjI5ODAiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTQxNiA4MjQuNkwyMjUuMSA2NjguNyA3MTYgOTYuMSA5MDYuOSAyNTJ6IiBmaWxsPSIjZDgxZTA2IiBwLWlkPSIyOTgxIj48L3BhdGg+PHBhdGggZD0iTTc4NiA5MjcuM2MtNC41IDAtOC44LTEuNi0xMi4yLTQuNEw1MjQuNSA3MTMuOGMtOC4xLTYuOC05LjEtMTguOC0yLjQtMjYuOCA2LjgtOCAxOC44LTkuMSAyNi44LTIuNGwyMzQuNyAxOTYuOEw5MTUgNzI0LjggNjc0LjYgNTIzLjJjLTguMS02LjgtOS4xLTE4LjgtMi40LTI2LjggNi44LTggMTguOC05LjEgMjYuOC0yLjRsMjU1IDIxMy45YzguMSA2LjggOS4xIDE4LjggMi40IDI2LjhMODAwLjYgOTIwLjVjLTMuMyAzLjktNy45IDYuMy0xMi45IDYuNy0wLjYgMC4xLTEuMiAwLjEtMS43IDAuMXpNMzQwLjIgNTUzLjVjLTQuMyAwLTguNi0xLjUtMTIuMi00LjRMNzEgMzMzLjZjLTguMS02LjgtOS4xLTE4LjgtMi40LTI2LjhMMjI0LjQgMTIxYzYuOC04IDE4LjgtOS4xIDI2LjgtMi40bDI1My41IDIxMi42YzguMSA2LjggOS4xIDE4LjggMi40IDI2LjgtNi44IDguMS0xOC43IDkuMS0yNi44IDIuNEwyNDEuNCAxNjAgMTEwLjEgMzE2LjZsMjQyLjMgMjAzLjJjOC4xIDYuOCA5LjEgMTguOCAyLjQgMjYuOC0zLjggNC42LTkuMiA2LjktMTQuNiA2Ljl6IiBmaWxsPSIjZDgxZTA2IiBwLWlkPSIyOTgyIj48L3BhdGg+PHBhdGggZD0iTTIzOC44IDMxOC4yYy00LjMgMC04LjYtMS41LTEyLjItNC40LTguMS02LjgtOS4xLTE4LjgtMi40LTI2LjhsNzcuOS05Mi45YzYuOC04IDE4LjgtOS4xIDI2LjgtMi40IDguMSA2LjggOS4xIDE4LjggMi40IDI2LjhsLTc3LjkgOTIuOWMtMy43IDQuNS05LjEgNi44LTE0LjYgNi44ek0zNzkuMyAzNjQuOGMtNC4zIDAtOC42LTEuNS0xMi4yLTQuNC04LjEtNi44LTkuMS0xOC44LTIuNC0yNi44bDQyLjktNTEuMWM2LjgtOC4xIDE4LjgtOS4xIDI2LjgtMi40IDguMSA2LjggOS4xIDE4LjggMi40IDI2LjhMMzkzLjkgMzU4Yy0zLjggNC41LTkuMiA2LjgtMTQuNiA2Ljh6TTgwMC45IDcxOC4zYy00LjMgMC04LjYtMS41LTEyLjItNC40LTguMS02LjgtOS4xLTE4LjgtMi40LTI2LjhsNDIuOS01MS4xYzYuOC04LjEgMTguOC05LjEgMjYuOC0yLjQgOC4xIDYuOCA5LjEgMTguOCAyLjQgMjYuOGwtNDIuOSA1MS4xYy0zLjcgNC41LTkuMSA2LjgtMTQuNiA2Ljh6TTY2MC41IDY3MS43Yy00LjMgMC04LjYtMS41LTEyLjItNC40LTguMS02LjgtOS4xLTE4LjgtMi40LTI2LjhsNzcuOS05Mi45YzYuOC04LjEgMTguOC05LjEgMjYuOC0yLjQgOC4xIDYuOCA5LjEgMTguOCAyLjQgMjYuOGwtNzcuOSA5Mi45Yy0zLjggNC41LTkuMiA2LjgtMTQuNiA2Ljh6TTQxNiA4NDMuNmMtNC4yIDAtOC41LTEuNC0xMi00LjNMMjEzIDY4My41Yy00LTMuMi02LjUtOC02LjktMTMuMS0wLjQtNS4xIDEuMi0xMC4yIDQuNS0xNC4xTDcwMS41IDgzLjdjNi43LTcuOCAxOC41LTguOSAyNi41LTIuNGwxOTAuOSAxNTUuOWM0IDMuMiA2LjUgOCA2LjkgMTMuMSAwLjQgNS4xLTEuMiAxMC4yLTQuNSAxNC4xTDQzMC40IDgzN2MtMy43IDQuNC05LjEgNi42LTE0LjQgNi42ek0yNTIuMiA2NjYuM2wxNjEuNCAxMzEuOCA0NjYuMS01NDMuNy0xNjEuNC0xMzEuOC00NjYuMSA1NDMuN3oiIGZpbGw9IiNkODFlMDYiIHAtaWQ9IjI5ODMiPjwvcGF0aD48cGF0aCBkPSJNMTY4LjEgOTUyLjRjLTQuMyAwLTguNi0xLjUtMTIuMS00LjMtNS4zLTQuMy03LjgtMTEuMS02LjgtMTcuOGw0MC45LTI1MS40YzEuNy0xMC40IDExLjYtMTcuNCAyMS45LTE1LjggMTAuNCAxLjcgMTcuNCAxMS41IDE1LjggMjEuOWwtMzUuNiAyMTguOSAyMDcuMy03OC42YzkuOC0zLjggMjAuOCAxLjIgMjQuNiAxMSAzLjcgOS44LTEuMiAyMC44LTExIDI0LjZMMTc1IDk1MS4yYy0yLjQgMC44LTQuNyAxLjItNi45IDEuMnoiIGZpbGw9IiNkODFlMDYiIHAtaWQ9IjI5ODQiPjwvcGF0aD48L3N2Zz4=), auto")},e}(y.Z);e.Z=f},361682:function(t,e,n){var o,i=n(441930),r=n(754276),a=n(117827),s=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(){return(l=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.context=null,e.style=l({},r.Z),e.status=a.ActionStatus.UnStart,e}return s(e,t),e.prototype.destroy=function(){var t,e;this.context&&![a.ActionStatus.Running,a.ActionStatus.Destroy].includes(this.status)&&(t=(e=this.context).getCanvasEl(),e=e.getAssistCanvasEl(),t)&&e&&(t.style.cursor=e.style.cursor="default",this.context.enableMap())},e.prototype.end=function(t){var e,n;this.context&&![a.ActionStatus.Running,a.ActionStatus.Destroy].includes(this.status)&&(e=(n=this.context).getCanvasEl(),n=n.getAssistCanvasEl(),e)&&n&&(e.style.cursor=n.style.cursor="default",this.context.enableMap())},e.prototype.start=function(t){this.context&&![a.ActionStatus.Running,a.ActionStatus.Destroy].includes(this.status)&&this.setCursor()},e.prototype.setCursor=function(){var t=this.context;t&&(t=t.getCanvasEl())&&(t.style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjI3OTEzNjM1NDc3IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjQzMDgiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxMi4wMDIgODg3QzMwNC44OTIgODg3IDEzNyA3MTkuMTA4IDEzNyA1MTIuMDAyIDEzNyAzMDQuODkyIDMwNC44OTIgMTM3IDUxMi4wMDIgMTM3IDcxOS4xMDggMTM3IDg4NyAzMDQuODkyIDg4NyA1MTIuMDAyIDg4NyA3MTkuMTA4IDcxOS4xMDggODg3IDUxMi4wMDIgODg3ek01MTIgNzg3YzE1MS44NzggMCAyNzUtMTIzLjEyMiAyNzUtMjc1UzY2My44NzggMjM3IDUxMiAyMzcgMjM3IDM2MC4xMjIgMjM3IDUxMnMxMjMuMTIyIDI3NSAyNzUgMjc1eiIgZmlsbD0iIzFBQTVGRiIgcC1pZD0iNDMwOSI+PC9wYXRoPjxwYXRoIGQ9Ik01MTIgNTEybS0yMjUgMGEyMjUgMjI1IDAgMSAwIDQ1MCAwIDIyNSAyMjUgMCAxIDAtNDUwIDBaIiBmaWxsPSIjMUFBNUZGIiBwLWlkPSI0MzEwIj48L3BhdGg+PC9zdmc+), auto")},e.prototype.setContext=function(t){this.context=t},e.prototype.getStatus=function(){return this.status},e}(i.Z.Events);e.Z=c},261019:function(t,e,n){var o,i=n(460467),r=n(117827),a=n(361682),s=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t){function e(){var e=t.call(this)||this;return e.startPoint=null,e.isMove=!1,e.points=[],e.onCanvasMouseDown=e.onCanvasMouseDown.bind(e),e.onCanvasMouseMove=e.onCanvasMouseMove.bind(e),e.onCanvasMouseUp=e.onCanvasMouseUp.bind(e),e}return s(e,t),e.prototype.draw=function(t,e){void 0===e&&(e=!1);var n,o=this.context,r=this.style,a=null==o?void 0:o.getCtx();o&&a&&(n=o.getCanvasEl())&&(t=i.Z.clientToCtxPoint({event:t,rect:null==n?void 0:n.getBoundingClientRect()}))&&(this.points.push(t),o.clearDraw(),o.drawHistoryData(),a.beginPath(),a.lineWidth=r.lineWidth,a.lineJoin=r.lineJoin,a.lineCap=r.lineCap,a.setLineDash(r.lineDash),a.lineDashOffset=r.lineDashOffset,a.strokeStyle=r.strokeStyle,a.fillStyle=r.fillStyle,this.points.forEach((function(t,e){0===e?a.moveTo(t.x,t.y):a.lineTo(t.x,t.y)})),e&&a.closePath(),a.stroke(),a.fill())},e.prototype.onCanvasMouseDown=function(t){var e;this.context&&(e=this.context.getCanvasEl())&&(this.startPoint=i.Z.clientToCtxPoint({event:t,rect:null==e?void 0:e.getBoundingClientRect()}),this.startPoint)&&(this.points.push(this.startPoint),null!=e&&e.addEventListener("mousemove",this.onCanvasMouseMove),null!=e&&e.addEventListener("mouseup",this.onCanvasMouseUp),t.stopPropagation())},e.prototype.onCanvasMouseMove=function(t){this.context&&(this.isMove=!0,this.draw(t),t.stopPropagation())},e.prototype.onCanvasMouseUp=function(t){this.isMove&&(this.end(t),t.stopPropagation())},e.draw=function(t,e,n){e&&n&&(n.style&&(e.lineWidth=n.style.lineWidth,e.lineJoin=n.style.lineJoin,e.lineCap=n.style.lineCap,e.setLineDash(n.style.lineDash),e.lineDashOffset=n.style.lineDashOffset,e.strokeStyle=n.style.strokeStyle,e.fillStyle=n.style.fillStyle,e.globalAlpha=n.style.globalAlpha||1),this.drawHistoryPath(t,e,n.data),e.stroke(),e.fill())},e.drawHistoryPath=function(t,n,o){n.save(),n.beginPath(),o=o.points,(e.transformOriginToReal(t,void 0===o?[]:o)||[]).forEach((function(t,e){0===e?n.moveTo(t.x,t.y):n.lineTo(t.x,t.y)})),n.closePath(),n.stroke(),n.fill(),n.restore()},e.transformRealToOrigin=function(t,e){return e.map((function(e){return t.pixelToPoint(e)}))},e.transformOriginToReal=function(t,e){return e.map((function(e){return t.pointToPixel(e)}))},e.prototype.getSelectType=function(){return r.SelectType.Free},e.prototype.start=function(e){var n;this.context&&![r.ActionStatus.Running,r.ActionStatus.Destroy].includes(this.status)&&(n=this.context.getCanvasEl())&&(t.prototype.start.call(this,e),e&&(this.style=e),this.trigger(r.ActionEvents.BeforeStart,{selectType:this.getSelectType(),actionType:r.ActionType.Draw}),null!=n&&n.addEventListener("mousedown",this.onCanvasMouseDown),this.status=r.ActionStatus.Running,this.trigger(r.ActionEvents.Start,{selectType:this.getSelectType(),actionType:r.ActionType.Draw}))},e.prototype.end=function(n){var o,a=this.context;a&&(o=a.getCanvasEl())&&(null!=o&&o.removeEventListener("mousedown",this.onCanvasMouseDown),null!=o&&o.removeEventListener("mousemove",this.onCanvasMouseMove),null!=o&&o.removeEventListener("mouseup",this.onCanvasMouseUp),this.draw(n,!0),this.status=r.ActionStatus.End,o={id:i.Z.uuid(),type:this.getSelectType(),data:{points:e.transformRealToOrigin(a,this.points)},style:this.style},a.addHistoryData(o),this.startPoint=null,this.points=[],this.isMove=!1,this.trigger(r.ActionEvents.End,{selectType:this.getSelectType(),actionType:r.ActionType.Draw,data:o})),t.prototype.end.call(this,n)},e.prototype.destroy=function(){var e,n=this.context;n&&(e=n.getCanvasEl())&&(this.status===r.ActionStatus.Running&&(n.clearDraw(),n.drawHistoryData()),null!=e&&e.removeEventListener("mousedown",this.onCanvasMouseDown),null!=e&&e.removeEventListener("mousemove",this.onCanvasMouseMove),null!=e&&e.removeEventListener("mouseup",this.onCanvasMouseUp),this.startPoint=null,this.points=[],this.isMove=!1,this.status=r.ActionStatus.Destroy,this.trigger(r.ActionEvents.Destroy,{selectType:this.getSelectType(),actionType:r.ActionType.Draw})),t.prototype.destroy.call(this)},e}(a.Z);e.Z=l},726985:function(t,e,n){var o,i=n(460467),r=n(419174),a=n(117827),s=n(361682),l=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},u=function(t){function e(){var e=t.call(this)||this;return e.startPoint=null,e.pointStack=[],e.isMove=!1,e.onCanvasClick=e.onCanvasClick.bind(e),e.onCanvasMousemove=e.onCanvasMousemove.bind(e),e.onCanvasDbClick=e.onCanvasDbClick.bind(e),e}return l(e,t),e.booleanPointInData=function(t,n,o){return(o=c([],o.data,!0)).push(o[0]),o=e.transformOriginToReal(t,o),t=r.xmu([n.x,n.y]),n=r.yue([o.map((function(t){return[t.x,t.y]}))]),r.FWy(t,n)},e.draw=function(t,e,n){e&&n&&(n.style&&(e.lineWidth=n.style.lineWidth,e.lineJoin=n.style.lineJoin,e.lineCap=n.style.lineCap,e.setLineDash(n.style.lineDash),e.lineDashOffset=n.style.lineDashOffset,e.strokeStyle=n.style.strokeStyle,e.fillStyle=n.style.fillStyle,e.globalAlpha=n.style.globalAlpha||1),this.drawHistoryPath(t,e,n.data),e.stroke(),e.fill())},e.drawHistoryPath=function(t,n,o){void 0===o&&(o=[]),n.save(),n.beginPath(),(e.transformOriginToReal(t,o)||[]).forEach((function(t,e){0===e?n.moveTo(t.x,t.y):n.lineTo(t.x,t.y)})),n.closePath(),n.stroke(),n.fill(),n.restore()},e.transformOriginToReal=function(t,e){return e.map((function(e){return t.pointToPixel(e)}))},e.transformRealToOrigin=function(t,e){return e.map((function(e){return t.pixelToPoint(e)}))},e.prototype.fill=function(){if(this.context){var t=this.pointStack,e=this.context.getCtx();if(e&&!(t.length<=1)){e.save(),e.beginPath();for(var n=0;n<t.length;n++){var o=t[n];0===n?e.moveTo(o.x,o.y):e.lineTo(o.x,o.y)}e.closePath(),e.fillStyle=this.style.fillStyle,e.fill(),e.restore()}}},e.prototype.drawLine=function(t,e){var n,o=this.context;o&&(n=this.style,o=o.getCtx())&&(o.beginPath(),o.moveTo(t.x,t.y),o.lineTo(e.x,e.y),o.strokeStyle=n.strokeStyle,o.fillStyle=n.fillStyle,o.lineWidth=n.lineWidth,o.lineCap=n.lineCap,o.lineJoin=n.lineJoin,o.lineDashOffset=n.lineDashOffset,o.setLineDash(n.lineDash),o.stroke())},e.prototype.drawStack=function(){var t=this.pointStack;if(!(t.length<=1))for(var e=0;this.drawLine(t[e],t[e+1]),++e!=t.length-1;);},e.prototype.getCanvasClick=function(){return this.onCanvasClick},e.prototype.getCanvasMousemove=function(){return this.onCanvasMousemove},e.prototype.getCanvasDbClick=function(){return this.onCanvasDbClick},e.prototype.onCanvasClick=function(t){if(this.context){var e=this.context.getCanvasEl();if(e&&!(2<=t.detail)){if(this.startPoint){var n=i.Z.clientToCtxPoint({event:t,rect:null==e?void 0:e.getBoundingClientRect()});this.drawLine(this.startPoint,n),this.startPoint=n,this.startPoint&&this.pointStack.push(this.startPoint)}else{if(null!=e&&e.addEventListener("mousemove",this.getCanvasMousemove()),null!=e&&e.addEventListener("dblclick",this.getCanvasDbClick()),this.startPoint=i.Z.clientToCtxPoint({event:t,rect:null==e?void 0:e.getBoundingClientRect()}),!this.startPoint)return;this.pointStack.push(this.startPoint),this.trigger(a.ActionEvents.Start,{selectType:this.getSelectType(),actionType:a.ActionType.Draw})}t.stopPropagation()}}},e.prototype.onCanvasMousemove=function(t){var e,n=this.context,o=this.startPoint;n&&o&&(e=n.getCanvasEl())&&(this.isMove=!0,n.clearDraw(),n.drawHistoryData(),this.drawStack(),this.drawLine(o,i.Z.clientToCtxPoint({event:t,rect:null==e?void 0:e.getBoundingClientRect()})),t.stopPropagation())},e.prototype.onCanvasDbClick=function(t){this.isMove&&(this.end(),t.stopPropagation())},e.prototype.getSelectType=function(){return a.SelectType.Polygon},e.prototype.start=function(e){var n=this.context,o=this.status;n&&![a.ActionStatus.Running,a.ActionStatus.Destroy].includes(o)&&n&&(o=n.getCanvasEl())&&(t.prototype.start.call(this,e),e&&(this.style=e),this.trigger(a.ActionEvents.BeforeStart,{selectType:this.getSelectType(),actionType:a.ActionType.Draw}),null!=o&&o.addEventListener("mouseup",this.getCanvasClick()),this.status=a.ActionStatus.Running)},e.prototype.end=function(){var n=this.context;if(n){var o,r=n.getCanvasEl();if(r)return null!=r&&r.removeEventListener("mouseup",this.getCanvasClick()),null!=r&&r.removeEventListener("mousemove",this.getCanvasMousemove()),null!=r&&r.removeEventListener("dblclick",this.getCanvasDbClick()),n.clearDraw(),n.drawHistoryData(),this.fill(),this.status=a.ActionStatus.End,o={id:r=i.Z.uuid(),type:this.getSelectType(),data:e.transformRealToOrigin(n,this.pointStack),style:this.style},this.startPoint=null,this.pointStack=[],this.isMove=!1,n.addHistoryData(o),this.trigger(a.ActionEvents.End,{selectType:this.getSelectType(),actionType:a.ActionType.Draw,data:o}),t.prototype.end.call(this),r}t.prototype.end.call(this)},e.prototype.destroy=function(){var e,n=this.context;n&&(e=n.getCanvasEl())&&(this.status===a.ActionStatus.Running&&(n.clearDraw(),n.drawHistoryData()),null!=e&&e.removeEventListener("mouseup",this.onCanvasClick),null!=e&&e.removeEventListener("mousemove",this.onCanvasMousemove),null!=e&&e.removeEventListener("dblclick",this.onCanvasDbClick),this.startPoint=null,this.pointStack=[],this.isMove=!1,this.status=a.ActionStatus.Destroy,this.trigger(a.ActionEvents.Destroy,{selectType:this.getSelectType(),actionType:a.ActionType.Draw})),t.prototype.destroy.call(this)},e}(s.Z);e.Z=u},155334:function(t,e,n){var o,i=n(460467),r=n(419174),a=n(117827),s=n(781777),l=n(361682),c=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(t){function e(){var e=t.call(this)||this;return e.startPoint=null,e.leftTopPoint=null,e.width=0,e.height=0,e.isMove=!1,e.onCanvasMouseDown=e.onCanvasMouseDown.bind(e),e.onCanvasMouseMove=e.onCanvasMouseMove.bind(e),e.onCanvasMouseUp=e.onCanvasMouseUp.bind(e),e}return c(e,t),e.booleanPointInData=function(t,n,o){o=(t=e.transformOriginToReal(t,o.data)).leftTopPoint;var i=t.width;t=t.height,n=r.xmu([n.x,n.y]),i=r.yue([[[o.x,o.y],[o.x+i,o.y],[o.x+i,o.y+t],[o.x,o.y+t],[o.x,o.y]]]);return r.FWy(n,i)},e.prototype.draw=function(t){var e,n=(r=this).context,o=r.startPoint,r=r.style,a=null==n?void 0:n.getCtx();n&&a&&(e=n.getCanvasEl())&&(t=i.Z.clientToCtxPoint({event:t,rect:null==e?void 0:e.getBoundingClientRect()}),n.clearDraw(),n.drawHistoryData(),a.beginPath(),this.leftTopPoint=s.Z.getRectLeftTopPoint({startPoint:o,targetPoint:t}),this.width=Math.abs(t.x-((null==o?void 0:o.x)||0)),this.height=Math.abs(t.y-((null==o?void 0:o.y)||0)),a.lineWidth=r.lineWidth,a.lineJoin=r.lineJoin,a.lineCap=r.lineCap,a.setLineDash(r.lineDash),a.lineDashOffset=r.lineDashOffset,a.strokeStyle=r.strokeStyle,a.fillStyle=r.fillStyle,a.rect((null==(e=this.leftTopPoint)?void 0:e.x)||0,(null==(n=this.leftTopPoint)?void 0:n.y)||0,this.width,this.height),a.stroke(),a.fill())},e.draw=function(t,e,n){e&&n&&(n.style&&(e.lineWidth=n.style.lineWidth,e.lineJoin=n.style.lineJoin,e.lineCap=n.style.lineCap,e.setLineDash(n.style.lineDash),e.lineDashOffset=n.style.lineDashOffset,e.strokeStyle=n.style.strokeStyle,e.fillStyle=n.style.fillStyle,e.globalAlpha=n.style.globalAlpha||1),this.drawHistoryPath(t,e,n.data),e.stroke(),e.fill())},e.drawHistoryPath=function(t,n,o){n.save(),n.beginPath(),t=e.transformOriginToReal(t,o),n.rect((null==(o=null==t?void 0:t.leftTopPoint)?void 0:o.x)||0,(null==(o=null==t?void 0:t.leftTopPoint)?void 0:o.y)||0,null==t?void 0:t.width,null==t?void 0:t.height),n.stroke(),n.fill(),n.restore()},e.prototype.onCanvasMouseDown=function(t){var e;this.context&&(e=this.context.getCanvasEl())&&(this.startPoint=i.Z.clientToCtxPoint({event:t,rect:null==e?void 0:e.getBoundingClientRect()}),null!=e&&e.addEventListener("mousemove",this.onCanvasMouseMove),null!=e&&e.addEventListener("mouseup",this.onCanvasMouseUp),t.stopPropagation())},e.prototype.onCanvasMouseMove=function(t){this.context&&(this.isMove=!0,this.draw(t),t.stopPropagation())},e.prototype.onCanvasMouseUp=function(t){this.isMove&&(this.end(t),t.stopPropagation())},e.transformOriginToReal=function(t,e){return{leftTopPoint:t.pointToPixel(e.leftTopPoint),width:t.actualToDistance(e.width),height:t.actualToDistance(e.height)}},e.transformRealToOrigin=function(t,e){return{leftTopPoint:t.pixelToPoint(e.leftTopPoint),width:t.distanceToActual(e.width),height:t.distanceToActual(e.height)}},e.prototype.getSelectType=function(){return a.SelectType.Rectangle},e.prototype.start=function(e){var n;this.context&&![a.ActionStatus.Running,a.ActionStatus.Destroy].includes(this.status)&&(n=this.context.getCanvasEl())&&(t.prototype.start.call(this,e),e&&(this.style=e),this.trigger(a.ActionEvents.BeforeStart,{selectType:this.getSelectType(),actionType:a.ActionType.Draw}),null!=n&&n.addEventListener("mousedown",this.onCanvasMouseDown),this.status=a.ActionStatus.Running,this.trigger(a.ActionEvents.Start,{selectType:this.getSelectType(),actionType:a.ActionType.Draw}))},e.prototype.end=function(n){var o,r=this.context;r&&(o=r.getCanvasEl())&&(null!=o&&o.removeEventListener("mousedown",this.onCanvasMouseDown),null!=o&&o.removeEventListener("mousemove",this.onCanvasMouseMove),null!=o&&o.removeEventListener("mouseup",this.onCanvasMouseUp),n&&this.draw(n),this.status=a.ActionStatus.End,o={id:i.Z.uuid(),type:this.getSelectType(),data:e.transformRealToOrigin(r,{leftTopPoint:this.leftTopPoint,width:this.width,height:this.height}),style:this.style},r.addHistoryData(o),this.startPoint=null,this.leftTopPoint=null,this.width=0,this.height=0,this.isMove=!1,this.trigger(a.ActionEvents.End,{selectType:this.getSelectType(),actionType:a.ActionType.Draw,data:o})),t.prototype.end.call(this,n)},e.prototype.destroy=function(){var e,n=this.context;n&&(e=n.getCanvasEl())&&(this.status===a.ActionStatus.Running&&(n.clearDraw(),n.drawHistoryData()),null!=e&&e.removeEventListener("mousedown",this.onCanvasMouseDown),null!=e&&e.removeEventListener("mousemove",this.onCanvasMouseMove),null!=e&&e.removeEventListener("mouseup",this.onCanvasMouseUp),this.startPoint=null,this.leftTopPoint=null,this.width=0,this.height=0,this.isMove=!1,this.status=a.ActionStatus.Destroy,this.trigger(a.ActionEvents.Destroy,{selectType:this.getSelectType(),actionType:a.ActionType.Draw})),t.prototype.destroy.call(this)},e}(l.Z);e.Z=u},552089:function(t,e,n){var o,i=n(460467),r=n(419174),a=n(117827),s=n(361682),l=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t){function e(){var e=t.call(this)||this;return e.centerPoint=null,e.outRadius=0,e.innerRadius=0,e.isMove=!1,e.onCanvasMouseDown=e.onCanvasMouseDown.bind(e),e.onCanvasMouseMove=e.onCanvasMouseMove.bind(e),e.onCanvasMouseUp=e.onCanvasMouseUp.bind(e),e}return l(e,t),e.booleanPointInData=function(t,n,o){for(var i=(t=e.transformOriginToReal(t,o.data)).center,a=t.outRadius,s=t.innerRadius,l=(o=r.xmu([n.x,n.y]),[]),c=0;c<5;c++)l.push({x:Math.cos((18+72*c)/180*Math.PI)*a+i.x,y:-Math.sin((18+72*c)/180*Math.PI)*a+i.y}),l.push({x:Math.cos((54+72*c)/180*Math.PI)*s+i.x,y:-Math.sin((54+72*c)/180*Math.PI)*s+i.y});return(t=l.map((function(t){return[t.x,t.y]}))).push(t[0]),n=r.yue([t]),r.FWy(o,n)},e.drawStart=function(t){var n=t.context,o=t.ctx;if((t=t.data)&&o){for(var i=t.style,r=(n=e.transformOriginToReal(n,t.data)).center,a=n.outRadius,s=n.innerRadius,l=(o.save(),o.beginPath(),72),c=0;c<5;c++)i&&(o.lineWidth=i.lineWidth,o.lineJoin=i.lineJoin,o.lineCap=i.lineCap,o.setLineDash(i.lineDash),o.lineDashOffset=i.lineDashOffset,o.strokeStyle=i.strokeStyle,o.fillStyle=i.fillStyle),o.lineTo(Math.cos((18+c*l)/180*Math.PI)*a+r.x,-Math.sin((18+c*l)/180*Math.PI)*a+r.y),o.lineTo(Math.cos((54+c*l)/180*Math.PI)*s+r.x,-Math.sin((54+c*l)/180*Math.PI)*s+r.y);o.stroke(),o.fill(),o.restore()}},e.prototype.draw=function(t){var n,o=this.context,r=this.centerPoint,a=null==o?void 0:o.getCtx();o&&r&&a&&(n=o.getCanvasEl())&&this.centerPoint&&(t=i.Z.clientToCtxPoint({event:t,rect:null==n?void 0:n.getBoundingClientRect()}),o.clearDraw(),o.drawHistoryData(),this.outRadius=i.Z.getDistanceByBetweenPoint({p1:r,p2:t}),this.innerRadius=this.outRadius/2,e.drawStart({context:o,ctx:a,data:{data:e.transformRealToOrigin(o,{center:this.centerPoint,outRadius:this.outRadius,innerRadius:this.innerRadius}),style:this.style}}))},e.draw=function(t,e,n){e&&n&&(n.style&&(e.lineWidth=n.style.lineWidth,e.lineJoin=n.style.lineJoin,e.lineCap=n.style.lineCap,e.setLineDash(n.style.lineDash),e.lineDashOffset=n.style.lineDashOffset,e.strokeStyle=n.style.strokeStyle,e.fillStyle=n.style.fillStyle,e.globalAlpha=n.style.globalAlpha||1),this.drawHistoryPath(t,e,n.data),e.stroke(),e.fill())},e.drawHistoryPath=function(t,n,o){o&&e.drawStart({context:t,ctx:n,data:{data:o}})},e.prototype.onCanvasMouseDown=function(t){var e;this.context&&(e=this.context.getCanvasEl())&&(this.centerPoint=i.Z.clientToCtxPoint({event:t,rect:null==e?void 0:e.getBoundingClientRect()}),null!=e&&e.addEventListener("mousemove",this.onCanvasMouseMove),null!=e&&e.addEventListener("mouseup",this.onCanvasMouseUp),t.stopPropagation())},e.prototype.onCanvasMouseMove=function(t){this.context&&(this.isMove=!0,this.draw(t),t.stopPropagation())},e.prototype.onCanvasMouseUp=function(t){this.isMove&&(this.end(t),t.stopPropagation())},e.transformOriginToReal=function(t,e){return{center:t.pointToPixel(e.center),outRadius:t.actualToDistance(e.outRadius),innerRadius:t.actualToDistance(e.innerRadius)}},e.transformRealToOrigin=function(t,e){return{center:t.pixelToPoint(e.center),outRadius:t.distanceToActual(e.outRadius),innerRadius:t.distanceToActual(e.innerRadius)}},e.prototype.getSelectType=function(){return a.SelectType.Start},e.prototype.start=function(e){var n;this.context&&![a.ActionStatus.Running,a.ActionStatus.Destroy].includes(this.status)&&(n=this.context.getCanvasEl())&&(t.prototype.start.call(this,e),e&&(this.style=e),this.trigger(a.ActionEvents.BeforeStart,{selectType:this.getSelectType(),actionType:a.ActionType.Draw}),null!=n&&n.addEventListener("mousedown",this.onCanvasMouseDown),this.status=a.ActionStatus.Running,this.trigger(a.ActionEvents.Start,{selectType:this.getSelectType(),actionType:a.ActionType.Draw}))},e.prototype.end=function(n){var o,r=this.context;r&&(o=r.getCanvasEl())&&this.centerPoint&&this.outRadius&&this.innerRadius&&(null!=o&&o.removeEventListener("mousedown",this.onCanvasMouseDown),null!=o&&o.removeEventListener("mousemove",this.onCanvasMouseMove),null!=o&&o.removeEventListener("mouseup",this.onCanvasMouseUp),n&&this.draw(n),this.status=a.ActionStatus.End,o={id:i.Z.uuid(),type:this.getSelectType(),data:e.transformRealToOrigin(r,{center:this.centerPoint,outRadius:this.outRadius,innerRadius:this.innerRadius}),style:this.style},r.addHistoryData(o),this.centerPoint=null,this.outRadius=0,this.innerRadius=0,this.isMove=!1,this.trigger(a.ActionEvents.End,{selectType:this.getSelectType(),actionType:a.ActionType.Draw,data:o})),t.prototype.end.call(this,n)},e.prototype.destroy=function(){var e,n=this.context;n&&(e=n.getCanvasEl())&&(this.status===a.ActionStatus.Running&&(n.clearDraw(),n.drawHistoryData()),null!=e&&e.removeEventListener("mousedown",this.onCanvasMouseDown),null!=e&&e.removeEventListener("mousemove",this.onCanvasMouseMove),null!=e&&e.removeEventListener("mouseup",this.onCanvasMouseUp),this.centerPoint=null,this.outRadius=0,this.innerRadius=0,this.isMove=!1,this.status=a.ActionStatus.Destroy,this.trigger(a.ActionEvents.Destroy,{selectType:this.getSelectType(),actionType:a.ActionType.Draw})),t.prototype.destroy.call(this)},e}(s.Z);e.Z=c},900839:function(t,e,n){var o,i=n(460467),r=n(419174),a=n(117827),s=n(781777),l=n(361682),c=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},y=function(t){function e(){var e=t.call(this)||this;return e.startPoint=null,e.points=[],e.isMove=!1,e.onCanvasMouseDown=e.onCanvasMouseDown.bind(e),e.onCanvasMouseMove=e.onCanvasMouseMove.bind(e),e.onCanvasMouseUp=e.onCanvasMouseUp.bind(e),e}return c(e,t),e.booleanPointInData=function(t,n,o){return(o=u([],o.data.points||[],!0)).push(o[0]),o=e.transformOriginToReal(t,{points:o}).points,t=r.xmu([n.x,n.y]),n=r.yue([o.map((function(t){return[t.x,t.y]}))]),r.FWy(t,n)},e.prototype.draw=function(t){var e,n=(r=this).context,o=r.startPoint,r=r.style,a=null==n?void 0:n.getCtx();n&&a&&(e=n.getCanvasEl())&&(t=i.Z.clientToCtxPoint({event:t,rect:null==e?void 0:e.getBoundingClientRect()}),n.clearDraw(),n.drawHistoryData(),a.beginPath(),a.lineWidth=r.lineWidth,a.lineJoin=r.lineJoin,a.lineCap=r.lineCap,a.setLineDash(r.lineDash),a.lineDashOffset=r.lineDashOffset,a.strokeStyle=r.strokeStyle,a.fillStyle=r.fillStyle,this.points=s.Z.triangle({startPoint:o,targetPoint:t}),a.moveTo(this.points[0].x,this.points[0].y),a.lineTo(this.points[1].x,this.points[1].y),a.lineTo(this.points[2].x,this.points[2].y),a.closePath(),a.stroke(),a.fill())},e.draw=function(t,e,n){e&&n&&(n.style&&(e.lineWidth=n.style.lineWidth,e.lineJoin=n.style.lineJoin,e.lineCap=n.style.lineCap,e.setLineDash(n.style.lineDash),e.lineDashOffset=n.style.lineDashOffset,e.strokeStyle=n.style.strokeStyle,e.fillStyle=n.style.fillStyle,e.globalAlpha=n.style.globalAlpha||1),this.drawHistoryPath(t,e,n.data),e.stroke(),e.fill())},e.drawHistoryPath=function(t,n,o){n.save(),n.beginPath(),t=e.transformOriginToReal(t,{points:o.points}).points,n.moveTo(t[0].x,t[0].y),n.lineTo(t[1].x,t[1].y),n.lineTo(t[2].x,t[2].y),n.stroke(),n.fill(),n.restore()},e.prototype.onCanvasMouseDown=function(t){var e;this.context&&(e=this.context.getCanvasEl())&&(this.startPoint=i.Z.clientToCtxPoint({event:t,rect:null==e?void 0:e.getBoundingClientRect()}),null!=e&&e.addEventListener("mousemove",this.onCanvasMouseMove),null!=e&&e.addEventListener("mouseup",this.onCanvasMouseUp),t.stopPropagation())},e.prototype.onCanvasMouseMove=function(t){this.context&&(this.isMove=!0,this.draw(t),t.stopPropagation())},e.prototype.onCanvasMouseUp=function(t){this.isMove&&(this.end(t),t.stopPropagation())},e.transformOriginToReal=function(t,e){return{points:e.points.map((function(e){return t.pointToPixel(e)}))}},e.transformRealToOrigin=function(t,e){return{points:e.points.map((function(e){return t.pixelToPoint(e)}))}},e.prototype.getSelectType=function(){return a.SelectType.Triangle},e.prototype.start=function(e){var n;this.context&&![a.ActionStatus.Running,a.ActionStatus.Destroy].includes(this.status)&&(n=this.context.getCanvasEl())&&(t.prototype.start.call(this,e),e&&(this.style=e),this.trigger(a.ActionEvents.BeforeStart,{selectType:this.getSelectType(),actionType:a.ActionType.Draw}),null!=n&&n.addEventListener("mousedown",this.onCanvasMouseDown),this.status=a.ActionStatus.Running,this.trigger(a.ActionEvents.Start,{selectType:this.getSelectType(),actionType:a.ActionType.Draw}))},e.prototype.end=function(n){var o,r=this.context;r&&(o=r.getCanvasEl())&&(null!=o&&o.removeEventListener("mousedown",this.onCanvasMouseDown),null!=o&&o.removeEventListener("mousemove",this.onCanvasMouseMove),null!=o&&o.removeEventListener("mouseup",this.onCanvasMouseUp),n&&this.draw(n),this.status=a.ActionStatus.End,o={id:i.Z.uuid(),type:this.getSelectType(),data:e.transformRealToOrigin(r,{points:JSON.parse(JSON.stringify(this.points))}),style:this.style},r.addHistoryData(o),this.startPoint=null,this.points=[],this.isMove=!1,this.trigger(a.ActionEvents.End,{selectType:this.getSelectType(),actionType:a.ActionType.Draw,data:o})),t.prototype.end.call(this,n)},e.prototype.destroy=function(){var e,n=this.context;n&&(e=n.getCanvasEl())&&(this.status===a.ActionStatus.Running&&(n.clearDraw(),n.drawHistoryData()),null!=e&&e.removeEventListener("mousedown",this.onCanvasMouseDown),null!=e&&e.removeEventListener("mousemove",this.onCanvasMouseMove),null!=e&&e.removeEventListener("mouseup",this.onCanvasMouseUp),this.startPoint=null,this.points=[],this.isMove=!1,this.status=a.ActionStatus.Destroy,this.trigger(a.ActionEvents.Destroy,{selectType:this.getSelectType(),actionType:a.ActionType.Draw})),t.prototype.destroy.call(this)},e}(l.Z);e.Z=y},577194:function(t,e,n){n.r(e),n.d(e,{CircleDrawAction:function(){return s.Z},CircleModifyAction:function(){return g.Z},DefaultAnchorStyle:function(){return o.Z},DefaultMoveGemStyle:function(){return i.Z},DefaultStyle:function(){return r.Z},DiamondDrawAction:function(){return l.Z},DiamondModifyAction:function(){return v.Z},DistanceDrawAction:function(){return c.Z},DrawAction:function(){return u.Z},FreeDrawAction:function(){return y.Z},InteractionLayer:function(){return a.Z},ModifyAction:function(){return x.Z},PolygonDrawAction:function(){return p.Z},PolygonModifyAction:function(){return M.Z},RectangleDrawAction:function(){return h.Z},RectangleModifyAction:function(){return T.Z},StartDrawAction:function(){return d.Z},StartModifyAction:function(){return m.Z},TriangleDrawAction:function(){return f.Z},TriangleModifyAction:function(){return C.Z},Types:function(){return P},Util:function(){return w.Z}});var o=n(434160),i=n(823830),r=n(754276),a=n(959117),s=n(732054),l=n(799443),c=n(635333),u=n(361682),y=n(261019),p=n(726985),h=n(155334),d=n(552089),f=n(900839),g=n(964495),v=n(110383),x=n(945251),M=n(661625),T=n(323703),m=n(508089),C=n(729634),P=n(117827),w=n(781777)},964495:function(t,e,n){var o,i=n(460467),r=n(823830),a=n(732054),s=n(117827),l=n(945251),c=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(){return(u=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},y=function(t){function e(e){return(e=t.call(this,e)||this).ResizeCursorMapping=new Map([[0,"ns-resize"],[1,"ew-resize"],[2,"ns-resize"],[3,"ew-resize"]]),e}return c(e,t),e.prototype.drawAnchors=function(){if(this.context){var t=this.context.getCtx();if(t)for(var e=(n=a.Z.transformOriginToReal(this.context,null==(n=null==(n=null==this?void 0:this.data)?void 0:n.data)?void 0:n.data)).center,n=n.radius,o=[{x:e.x,y:e.y-n},{x:e.x+n,y:e.y},{x:e.x,y:e.y+n},{x:e.x-n,y:e.y}],i=0;i<o.length;i++){var r=o[i];t.beginPath(),this.setAnchorCircleStyle(),t.ellipse(r.x,r.y,this.anchorRadius,this.anchorRadius,45*Math.PI/180,0,2*Math.PI),t.stroke(),t.fill()}}},e.prototype.getPointInAnchor=function(t){if(!this.data)return null;for(var e=null,n=-1,o=(r=a.Z.transformOriginToReal(this.context,null==(r=null==(r=null==this?void 0:this.data)?void 0:r.data)?void 0:r.data)).center,r=r.radius,s=[{x:o.x,y:o.y-r},{x:o.x+r,y:o.y},{x:o.x,y:o.y+r},{x:o.x-r,y:o.y}],l=0;l<s.length;l++){var c=s[l],u=this.anchorRadius+this.anchorLineWidth;if(i.Z.isPointInCircle(t,{center:c,radius:u})){e=c,n=l;break}}return e&&-1!==n?{point:e,index:n}:null},e.prototype.setResizeCursorByIndex=function(t){var e,n;this.context&&(e=this.context.getCanvasEl(),n=this.context.getAssistCanvasEl(),e)&&n&&(e.style.cursor=n.style.cursor=this.ResizeCursorMapping.get(t))},e.prototype.drawModify=function(t){var e,n=this.context,o=null==n?void 0:n.getCtx();n&&o&&this.data&&this.startPoint&&(o=n.getHistoryDataById(this.data.data.id))&&(e=o.data.center,e=n.pointToPixel(e),o.data.radius=n.distanceToActual(i.Z.getDistanceByBetweenPoint({p1:e,p2:t})),this.data.data=u({},o),n.clearDraw(),n.drawHistoryData(),this.drawAnchors())},e.prototype.drawMove=function(t,e){var n,o=this.context,i=null==o?void 0:o.getCtx();o&&i&&this.data&&(i=o.getHistoryDataById(this.data.data.id))&&(t=o.pixelToPoint(t),n=(e=o.pixelToPoint(e)).x-t.x,e=e.y-t.y,i.data.center.x+=n,i.data.center.y+=e,this.data.data=u({},i),o.clearDraw(),o.drawHistoryData(),this.drawAnchors())},e.prototype.getSelectType=function(){return s.SelectType.Circle},e.prototype.isCanMove=function(t){var e,n;return!!this.data&&(e=(n=null==(n=null==(n=null==this?void 0:this.data)?void 0:n.data)?void 0:n.data).center,n=n.radius,i.Z.isPointInCircle(t,a.Z.transformOriginToReal(this.context,{center:e,radius:n})))&&!this.getPointInAnchor(t)},e.prototype.drawMoveGeometry=function(){this.context&&this.data&&a.Z.draw(this.context,this.context.getAssistCtx(),this.data)},e.prototype.drawMoveGeometry=function(t,e){var n,o;this.context&&this.data&&t&&e&&((n=u({},this.data.data)).data=u(u({},n.data),{center:u({},n.data.center)}),t=this.context.pixelToPoint(t),o=(e=this.context.pixelToPoint(e)).x-t.x,e=e.y-t.y,n.data)&&n.data.center&&(n.data.center.x+=o,n.data.center.y+=e,n.style&&(n.style.globalAlpha=r.Z.globalAlpha,n.style.strokeStyle=r.Z.strokeStyle,n.style.lineWidth=r.Z.lineWidth,n.style.lineDash=r.Z.lineDash,n.style.lineDashOffset=r.Z.lineDashOffset),a.Z.draw(this.context,this.context.getAssistCtx(),n))},e.prototype.setCursor=function(){},e}(l.Z);e.Z=y},110383:function(t,e,n){var o,i=n(460467),r=n(419174),a=n(823830),s=n(799443),l=n(117827),c=n(945251),u=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),y=function(){return(y=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},p=function(t){function e(e){return(e=t.call(this,e)||this).rectangleAnchorPoints=[],e.indexToModifyHandlerMapping=new Map([[0,e.modifyDataByLeftTop],[1,e.modifyDataByCenterTop],[2,e.modifyDataByRightTop],[3,e.modifyDataByRightCenter],[4,e.modifyDataByRightBottom],[5,e.modifyDataByCenterBottom],[6,e.modifyDataByLeftBottom],[7,e.modifyDataByLeftCenter]]),e.ResizeCursorMapping=new Map([[0,"nwse-resize"],[1,"ns-resize"],[2,"nesw-resize"],[3,"ew-resize"],[4,"nwse-resize"],[5,"ns-resize"],[6,"nesw-resize"],[7,"ew-resize"]]),e}return u(e,t),e.prototype.setCursor=function(){throw new Error("Method not implemented.")},e.prototype.drawAnchors=function(){if(this.context){var t=this.context.getCtx();if(t){var e,n=(e=s.Z.transformOriginToReal(this.context,null==(e=null==(e=null==this?void 0:this.data)?void 0:e.data)?void 0:e.data)).leftTopPoint,o=e.width,i=o/2,r=(e=e.height)/2;this.rectangleAnchorPoints=[y({},n),{x:n.x+i,y:n.y},{x:n.x+o,y:n.y},{x:n.x+o,y:n.y+r},{x:n.x+o,y:n.y+e},{x:n.x+i,y:n.y+e},{x:n.x,y:n.y+e},{x:n.x,y:n.y+r}];for(var a=0;a<this.rectangleAnchorPoints.length;a++){var l=this.rectangleAnchorPoints[a];t.beginPath(),this.setAnchorCircleStyle(),t.ellipse(l.x,l.y,this.anchorRadius,this.anchorRadius,45*Math.PI/180,0,2*Math.PI),t.stroke(),t.fill()}t.beginPath(),this.setAnchorLineStyle(),t.moveTo(n.x,n.y),t.lineTo(n.x+o,n.y),t.lineTo(n.x+o,n.y+e),t.lineTo(n.x,n.y+e),t.lineTo(n.x,n.y),t.stroke()}}},e.prototype.getPointInAnchor=function(t){if(!this.data)return null;for(var e=null,n=-1,o=0;o<this.rectangleAnchorPoints.length;o++){var r=this.rectangleAnchorPoints[o],a=this.anchorRadius+this.anchorLineWidth;if(i.Z.isPointInCircle(t,{center:r,radius:a})){e=r,n=o;break}}return e&&-1!==n?{point:e,index:n}:null},e.prototype.setResizeCursorByIndex=function(t){var e,n;this.context&&(e=this.context.getCanvasEl(),n=this.context.getAssistCanvasEl(),e)&&n&&(e.style.cursor=n.style.cursor=this.ResizeCursorMapping.get(t))},e.prototype.drawModify=function(t){var e,n=this.context,o=null==n?void 0:n.getCtx();n&&o&&this.data&&this.startPoint&&(o=n.getHistoryDataById(this.data.data.id))&&(e=this.indexToModifyHandlerMapping.get(this.startIndex))&&e.call(this,t)&&(this.data.data=y({},o),n.clearDraw(),n.drawHistoryData(),this.drawAnchors())},e.prototype.drawMove=function(t,e){var n,o=this.context,i=null==o?void 0:o.getCtx();o&&i&&this.data&&(i=o.getHistoryDataById(this.data.data.id))&&(t=o.pixelToPoint(t),n=(e=o.pixelToPoint(e)).x-t.x,e=e.y-t.y,i.data.leftTopPoint.x+=n,i.data.leftTopPoint.y+=e,this.data.data=y({},i),o.clearDraw(),o.drawHistoryData(),this.drawAnchors())},e.prototype.getSelectType=function(){return l.SelectType.Diamond},e.prototype.getBox=function(){var t,e=this.context,n=null==e?void 0:e.getCtx();return e&&n&&this.data&&(n=e.getHistoryDataById(this.data.data.id))?(n=(e=s.Z.transformOriginToReal(e,n.data)).leftTopPoint,t=e.width,e=e.height,{leftTop:y({},n),rightTop:{x:n.x+t,y:n.y},rightBottom:{x:n.x+t,y:n.y+e},leftBottom:{x:n.x,y:n.y+e}}):null},e.prototype.modifyDataByLeftTop=function(t){var e,n=this.context,o=null==n?void 0:n.getCtx();return!(!(n&&o&&this.data&&this.startPoint)||!(o=n.getHistoryDataById(this.data.data.id))||!(e=this.getBox())||t.x>e.rightTop.x||t.y>e.rightBottom.y||(o.data.leftTopPoint=n.pixelToPoint(t),o.data.width=n.distanceToActual(e.rightTop.x-t.x),o.data.height=n.distanceToActual(e.rightBottom.y-t.y),0))},e.prototype.modifyDataByCenterTop=function(t){var e,n=this.context,o=null==n?void 0:n.getCtx();return!(!(n&&o&&this.data&&this.startPoint)||!(o=n.getHistoryDataById(this.data.data.id))||!(e=this.getBox())||t.y>e.leftBottom.y||(o.data.leftTopPoint=n.pixelToPoint({x:e.leftTop.x,y:t.y}),o.data.height=n.distanceToActual(e.rightBottom.y-t.y),0))},e.prototype.modifyDataByRightTop=function(t){var e,n=this.context,o=null==n?void 0:n.getCtx();return!(!(n&&o&&this.data&&this.startPoint)||!(o=n.getHistoryDataById(this.data.data.id))||!(e=this.getBox())||t.x<e.leftTop.x||t.y>e.leftBottom.y||(o.data.leftTopPoint=n.pixelToPoint({x:e.leftTop.x,y:t.y}),o.data.width=n.distanceToActual(t.x-e.leftTop.x),o.data.height=n.distanceToActual(e.rightBottom.y-t.y),0))},e.prototype.modifyDataByRightCenter=function(t){var e,n=this.context,o=null==n?void 0:n.getCtx();return!(!(n&&o&&this.data&&this.startPoint)||!(o=n.getHistoryDataById(this.data.data.id))||!(e=this.getBox())||t.x<e.leftTop.x||(o.data.width=n.distanceToActual(t.x-e.leftTop.x),0))},e.prototype.modifyDataByRightBottom=function(t){var e,n=this.context,o=null==n?void 0:n.getCtx();return!(!(n&&o&&this.data&&this.startPoint)||!(o=n.getHistoryDataById(this.data.data.id))||!(e=this.getBox())||t.x<e.leftTop.x||t.y<e.leftTop.y||(o.data.width=n.distanceToActual(t.x-e.leftTop.x),o.data.height=n.distanceToActual(t.y-e.leftTop.y),0))},e.prototype.modifyDataByCenterBottom=function(t){var e,n=this.context,o=null==n?void 0:n.getCtx();return!(!(n&&o&&this.data&&this.startPoint)||!(o=n.getHistoryDataById(this.data.data.id))||!(e=this.getBox())||t.y<e.leftTop.y||(o.data.height=n.distanceToActual(t.y-e.leftTop.y),0))},e.prototype.modifyDataByLeftBottom=function(t){var e,n,o=this.context,i=null==o?void 0:o.getCtx();return!(!(o&&i&&this.data&&this.startPoint)||!(i=o.getHistoryDataById(this.data.data.id))||(e=i.data.leftTopPoint,e=o.pointToPixel(e),!(n=this.getBox()))||t.x>n.rightBottom.x||t.y<n.rightTop.y||(i.data.leftTopPoint=o.pixelToPoint({x:t.x,y:e.y}),i.data.width=o.distanceToActual(n.rightBottom.x-t.x),i.data.height=o.distanceToActual(t.y-n.rightTop.y),0))},e.prototype.modifyDataByLeftCenter=function(t){var e,n,o=this.context,i=null==o?void 0:o.getCtx();return!(!(o&&i&&this.data&&this.startPoint)||!(i=o.getHistoryDataById(this.data.data.id))||(e=i.data.leftTopPoint,e=o.pointToPixel(e),!(n=this.getBox()))||t.x>n.rightBottom.x||(i.data.leftTopPoint=o.pixelToPoint({x:t.x,y:e.y}),i.data.width=o.distanceToActual(n.rightBottom.x-t.x),0))},e.prototype.isCanMove=function(t){var e,n,o,i,a,l;return!!this.data&&(e=(n=s.Z.transformOriginToReal(this.context,null==(n=null==(n=null==this?void 0:this.data)?void 0:n.data)?void 0:n.data)).leftTopPoint,o=(l=n.width)/2,i=(n=n.height)/2,a=r.xmu([t.x,t.y]),l=r.yue([[[e.x,e.y+i],[e.x+o,e.y],[e.x+l,e.y+i],[e.x+o,e.y+n],[e.x,e.y+i]]]),r.FWy(a,l))&&!this.getPointInAnchor(t)},e.prototype.drawMoveGeometry=function(){this.context&&this.data&&s.Z.draw(this.context,this.context.getAssistCtx(),this.data)},e.prototype.drawMoveGeometry=function(t,e){var n,o;this.context&&this.data&&t&&e&&((n=y({},this.data.data)).data=y(y({},n.data),{leftTopPoint:y({},n.data.leftTopPoint)}),t=this.context.pixelToPoint(t),o=(e=this.context.pixelToPoint(e)).x-t.x,e=e.y-t.y,n.data)&&n.data.leftTopPoint&&(n.data.leftTopPoint.x+=o,n.data.leftTopPoint.y+=e,n.style&&(n.style.globalAlpha=a.Z.globalAlpha,n.style.strokeStyle=a.Z.strokeStyle,n.style.lineWidth=a.Z.lineWidth,n.style.lineDash=a.Z.lineDash,n.style.lineDashOffset=a.Z.lineDashOffset),s.Z.draw(this.context,this.context.getAssistCtx(),n))},e.prototype.destroy=function(){this.startIndex=-1,t.prototype.destroy.call(this)},e}(c.Z);e.Z=p},945251:function(t,e,n){var o,i=n(460467),r=n(441930),a=n(434160),s=n(117827),l=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t){function e(e){var n=t.call(this)||this;return n.context=null,n.data=null,n.status=s.ActionStatus.UnStart,n.EmitActions={CONTEXT:"CONTEXT"},n.anchorRadius=5,n.anchorLineWidth=2,n.startPoint=null,n.startIndex=-1,n.moveStartPoint=null,n.canMove=!0,n.isMoved=!1,n.data=e,n.onContext=n.onContext.bind(n),n.onCanvasMousedown=n.onCanvasMousedown.bind(n),n.onCanvasMousemove=n.onCanvasMousemove.bind(n),n.onCanvasMouseup=n.onCanvasMouseup.bind(n),n.onCanvasIsModifyMousemove=n.onCanvasIsModifyMousemove.bind(n),n.onMoveMousedown=n.onMoveMousedown.bind(n),n.onMoveMousemove=n.onMoveMousemove.bind(n),n.onMoveMouseup=n.onMoveMouseup.bind(n),n.on(n.EmitActions.CONTEXT,n.onContext),n}return l(e,t),e.prototype.setAnchorCircleStyle=function(){var t;this.context&&(t=this.context.getCtx())&&(t.strokeStyle=a.Z.strokeStyle,t.fillStyle=a.Z.fillStyle,t.lineWidth=a.Z.lineWidth)},e.prototype.setAnchorLineStyle=function(){var t;this.context&&(t=this.context.getCtx())&&(t.strokeStyle=a.Z.strokeStyle,t.lineWidth=a.Z.lineWidth,t.setLineDash(a.Z.lineDash),t.lineDashOffset=a.Z.lineDashOffset)},e.prototype.onContext=function(){this.drawAnchors()},e.prototype.onCanvasMousedown=function(t){var e,n;this.context&&(e=this.context.getCanvasEl())&&this.context.getCtx()&&(n=i.Z.clientToCtxPoint({event:t,rect:null==e?void 0:e.getBoundingClientRect()}),n=this.getPointInAnchor(n))&&(this.startPoint=n.point,this.startIndex=n.index,e.addEventListener("mousemove",this.onCanvasMousemove),e.addEventListener("mouseup",this.onCanvasMouseup),t.stopPropagation())},e.prototype.onCanvasMousemove=function(t){var e;this.context&&(e=this.context.getCanvasEl())&&this.context.getCtx()&&this.startPoint&&(e=i.Z.clientToCtxPoint({event:t,rect:null==e?void 0:e.getBoundingClientRect()}),this.drawModify(e),t.stopPropagation())},e.prototype.onCanvasMouseup=function(t){this.end(t),t.stopPropagation()},e.prototype.onCanvasIsModifyMousemove=function(t){var e,n,o,r;this.context&&(e=this.context.getCanvasEl(),n=this.context.getAssistCanvasEl(),e)&&n&&(this.startPoint||this.moveStartPoint||(o=i.Z.clientToCtxPoint({event:t,rect:null==e?void 0:e.getBoundingClientRect()}),(r=this.getPointInAnchor(o))?(this.canMove=!1,this.setResizeCursorByIndex(r.index)):(this.canMove=this.isCanMove(o),this.canMove?e.style.cursor=n.style.cursor="move":e.style.cursor=n.style.cursor="default"),t.stopPropagation()))},e.prototype.initMoveEvents=function(){var t,e=this.context;e&&(t=e.getCanvasEl(),e=e.getAssistCanvasEl(),t)&&e&&t.addEventListener("mousedown",this.onMoveMousedown)},e.prototype.clearMoveEvents=function(){var t,e=this.context;e&&(t=e.getCanvasEl(),e=e.getAssistCanvasEl(),t)&&e&&(t.removeEventListener("mousedown",this.onMoveMousedown),t.removeEventListener("mousemove",this.onMoveMousemove),e.removeEventListener("mousemove",this.onMoveMousemove),e.removeEventListener("mouseup",this.onMoveMouseup))},e.prototype.onMoveMousedown=function(t){var e,n,o;t&&(e=this.context)&&(n=e.getCanvasEl(),o=e.getAssistCanvasEl(),n)&&o&&this.canMove&&(e.setFrontCanvas(o),this.moveStartPoint=i.Z.clientToCtxPoint({event:t,rect:n.getBoundingClientRect()}),this.drawMoveGeometry(),n.addEventListener("mousemove",this.onMoveMousemove),o.addEventListener("mousemove",this.onMoveMousemove),o.addEventListener("mouseup",this.onMoveMouseup),null!=t)&&t.stopPropagation()},e.prototype.onMoveMousemove=function(t){var e,n,o;t&&(e=this.context)&&(n=e.getCanvasEl(),o=e.getAssistCanvasEl(),n)&&o&&(o=i.Z.clientToCtxPoint({event:t,rect:n.getBoundingClientRect()}),this.moveStartPoint&&(this.isMoved=!0,e.clearAssistDraw(),this.drawMoveGeometry(this.moveStartPoint,o)),null!=t)&&t.stopPropagation()},e.prototype.onMoveMouseup=function(t){this.endMove(t)},e.prototype.start=function(){var t,e;this.context&&![s.ActionStatus.Running,s.ActionStatus.Destroy].includes(this.status)&&(t=(e=this.context).getCanvasEl(),e=e.getAssistCanvasEl(),t)&&e&&(t.style.cursor=e.style.cursor="default",this.trigger(s.ActionEvents.BeforeStart,{selectType:this.getSelectType(),actionType:s.ActionType.Modify}),t.addEventListener("mousedown",this.onCanvasMousedown),t.addEventListener("mousemove",this.onCanvasIsModifyMousemove),this.initMoveEvents(),this.status=s.ActionStatus.Running,this.trigger(s.ActionEvents.Start,{selectType:this.getSelectType(),actionType:s.ActionType.Modify}))},e.prototype.end=function(t){var e,n;t&&(n=this.context)&&(e=n.getCanvasEl(),n=n.getAssistCanvasEl(),e)&&n&&(e.style.cursor=n.style.cursor="default",e.removeEventListener("mousedown",this.onCanvasMousedown),e.removeEventListener("mousemove",this.onCanvasMousemove),e.removeEventListener("mouseup",this.onCanvasMouseup),e.removeEventListener("mousemove",this.onCanvasIsModifyMousemove),this.clearMoveEvents(),t=i.Z.clientToCtxPoint({event:t,rect:null==e?void 0:e.getBoundingClientRect()}),this.drawModify(t),this.status=s.ActionStatus.End,this.startPoint=null,this.startPoint=null,this.startIndex=-1,this.moveStartPoint=null,this.canMove=!0,this.isMoved=!1,this.trigger(s.ActionEvents.End,{selectType:this.getSelectType(),actionType:s.ActionType.Modify,data:t}),e.style.cursor=n.style.cursor="default",null!=(t=null==this?void 0:this.context))&&t.enableMap()},e.prototype.endMove=function(t){var e,n,o,r;t&&(n=this.context)&&(o=n.getCanvasEl(),r=n.getAssistCanvasEl(),o)&&r&&(t=i.Z.clientToCtxPoint({event:t,rect:o.getBoundingClientRect()}),this.canMove&&this.isMoved&&this.moveStartPoint?(n.setBackCanvas(r),n.clearAssistDraw(),this.drawMove(this.moveStartPoint,t),this.canMove=!0,this.isMoved=!1,this.moveStartPoint=null,this.startPoint=null,this.startIndex=-1,o.removeEventListener("mousedown",this.onCanvasMousedown),o.removeEventListener("mousemove",this.onCanvasMousemove),o.removeEventListener("mouseup",this.onCanvasMouseup),o.removeEventListener("mousemove",this.onCanvasIsModifyMousemove),this.clearMoveEvents(),this.status=s.ActionStatus.End,this.trigger(s.ActionEvents.End,{selectType:this.getSelectType(),actionType:s.ActionType.Modify,data:t}),null!=(e=null==this?void 0:this.context)&&e.enableMap()):(n.setBackCanvas(r),this.canMove=!0,this.isMoved=!1,this.moveStartPoint=null,this.startPoint=null,this.startIndex=-1,o.removeEventListener("mousedown",this.onCanvasMousedown),o.removeEventListener("mousemove",this.onCanvasMousemove),o.removeEventListener("mouseup",this.onCanvasMouseup),o.removeEventListener("mousemove",this.onCanvasIsModifyMousemove),this.clearMoveEvents(),this.status=s.ActionStatus.End,this.trigger(s.ActionEvents.End,{selectType:this.getSelectType(),actionType:s.ActionType.Modify,data:t})))},e.prototype.destroy=function(){var t,e,n=this.context;n&&(t=n.getCanvasEl(),e=n.getAssistCanvasEl(),t)&&e&&(t.style.cursor=e.style.cursor="default",this.remove(this.EmitActions.CONTEXT,this.onContext),t.removeEventListener("mousedown",this.onCanvasMousedown),t.removeEventListener("mousemove",this.onCanvasMousemove),t.removeEventListener("mouseup",this.onCanvasMouseup),t.removeEventListener("mousemove",this.onCanvasIsModifyMousemove),this.clearMoveEvents(),n.clearDraw(),n.drawHistoryData(),this.status=s.ActionStatus.Destroy,this.startPoint=null,this.startIndex=-1,this.moveStartPoint=null,this.canMove=!0,this.isMoved=!1,this.trigger(s.ActionEvents.Destroy,{selectType:this.getSelectType(),actionType:s.ActionType.Modify}),t.style.cursor=e.style.cursor="default",null!=(n=null==this?void 0:this.context))&&n.enableMap()},e.prototype.setContext=function(t){this.context=t,this.trigger(this.EmitActions.CONTEXT)},e.prototype.getStatus=function(){return this.status},e}(r.Z.Events);e.Z=c},661625:function(t,e,n){var o,i=n(460467),r=n(419174),a=n(823830),s=n(726985),l=n(117827),c=n(945251),u=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),y=function(){return(y=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},p=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},h=function(t){function e(e){return(e=t.call(this,e)||this).startIndex=-1,e}return u(e,t),e.prototype.drawAnchors=function(){var t;if(this.context){var e=this.context.getCtx();if(e)for(var n=s.Z.transformOriginToReal(this.context,(null==(t=null==(t=null==this?void 0:this.data)?void 0:t.data)?void 0:t.data)||[]),o=0;o<n.length;o++){var i=n[o];e.beginPath(),this.setAnchorCircleStyle(),e.ellipse(i.x,i.y,this.anchorRadius,this.anchorRadius,45*Math.PI/180,0,2*Math.PI),e.stroke(),e.fill()}}},e.prototype.getPointInAnchor=function(t){if(!this.data)return null;for(var e=null,n=-1,o=s.Z.transformOriginToReal(this.context,this.data.data.data),r=0;r<o.length;r++){var a=o[r],l=this.anchorRadius+this.anchorLineWidth;if(i.Z.isPointInCircle(t,{center:a,radius:l})){e=a,n=r;break}}return e&&-1!==n?{point:e,index:n}:null},e.prototype.setResizeCursorByIndex=function(t){var e,n;this.context&&(e=this.context.getCanvasEl(),n=this.context.getAssistCanvasEl(),e)&&n&&(e.style.cursor=n.style.cursor="nesw-resize")},e.prototype.drawModify=function(t){var e=this.context,n=null==e?void 0:e.getCtx();e&&n&&this.data&&this.startPoint&&-1!==this.startIndex&&(n=e.getHistoryDataById(this.data.data.id))&&(n.data[this.startIndex]=e.pixelToPoint(t),this.data.data=y({},n),e.clearDraw(),e.drawHistoryData(),this.drawAnchors())},e.prototype.drawMove=function(t,e){var n,o,i=this.context,r=null==i?void 0:i.getCtx();i&&r&&this.data&&(r=i.getHistoryDataById(this.data.data.id))&&(t=i.pixelToPoint(t),e=i.pixelToPoint(e),n=e.x-t.x,o=e.y-t.y,r.data.forEach((function(t){t.x+=n,t.y+=o})),this.data.data=y({},r),i.clearDraw(),i.drawHistoryData(),this.drawAnchors())},e.prototype.getSelectType=function(){return l.SelectType.Polygon},e.prototype.isCanMove=function(t){var e,n;return!!this.data&&((n=s.Z.transformOriginToReal(this.context,p([],null==(n=null==(n=null==this?void 0:this.data)?void 0:n.data)?void 0:n.data,!0))).push(n[0]),e=r.xmu([t.x,t.y]),n=r.yue([n.map((function(t){return[t.x,t.y]}))]),r.FWy(e,n))&&!this.getPointInAnchor(t)},e.prototype.drawMoveGeometry=function(){this.context&&this.data&&s.Z.draw(this.context,this.context.getAssistCtx(),this.data)},e.prototype.drawMoveGeometry=function(t,e){var n,o,i;this.context&&this.data&&t&&e&&((n=y({},this.data.data)).data=n.data.map((function(t){return y({},t)})),t=this.context.pixelToPoint(t),e=this.context.pixelToPoint(e),o=e.x-t.x,i=e.y-t.y,n.data)&&n.data.length&&(n.data.forEach((function(t){t.x+=o,t.y+=i})),n.style&&(n.style.globalAlpha=a.Z.globalAlpha,n.style.strokeStyle=a.Z.strokeStyle,n.style.lineWidth=a.Z.lineWidth,n.style.lineDash=a.Z.lineDash,n.style.lineDashOffset=a.Z.lineDashOffset),s.Z.draw(this.context,this.context.getAssistCtx(),n))},e.prototype.setCursor=function(){},e}(c.Z);e.Z=h},323703:function(t,e,n){var o,i=n(460467),r=n(419174),a=n(823830),s=n(155334),l=n(117827),c=n(945251),u=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),y=function(){return(y=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},p=function(t){function e(e){return(e=t.call(this,e)||this).rectangleAnchorPoints=[],e.indexToModifyHandlerMapping=new Map([[0,e.modifyDataByLeftTop],[1,e.modifyDataByCenterTop],[2,e.modifyDataByRightTop],[3,e.modifyDataByRightCenter],[4,e.modifyDataByRightBottom],[5,e.modifyDataByCenterBottom],[6,e.modifyDataByLeftBottom],[7,e.modifyDataByLeftCenter]]),e.ResizeCursorMapping=new Map([[0,"nwse-resize"],[1,"ns-resize"],[2,"nesw-resize"],[3,"ew-resize"],[4,"nwse-resize"],[5,"ns-resize"],[6,"nesw-resize"],[7,"ew-resize"]]),e}return u(e,t),e.prototype.setCursor=function(){throw new Error("Method not implemented.")},e.prototype.drawAnchors=function(){if(this.context){var t=this.context.getCtx();if(t){var e,n=(e=s.Z.transformOriginToReal(this.context,null==(e=null==(e=null==this?void 0:this.data)?void 0:e.data)?void 0:e.data)).leftTopPoint,o=e.width,i=o/2,r=(e=e.height)/2;this.rectangleAnchorPoints=[y({},n),{x:n.x+i,y:n.y},{x:n.x+o,y:n.y},{x:n.x+o,y:n.y+r},{x:n.x+o,y:n.y+e},{x:n.x+i,y:n.y+e},{x:n.x,y:n.y+e},{x:n.x,y:n.y+r}];for(var a=0;a<this.rectangleAnchorPoints.length;a++){var l=this.rectangleAnchorPoints[a];t.beginPath(),this.setAnchorCircleStyle(),t.ellipse(l.x,l.y,this.anchorRadius,this.anchorRadius,45*Math.PI/180,0,2*Math.PI),t.stroke(),t.fill()}}}},e.prototype.getPointInAnchor=function(t){if(!this.data)return null;for(var e=null,n=-1,o=0;o<this.rectangleAnchorPoints.length;o++){var r=this.rectangleAnchorPoints[o],a=this.anchorRadius+this.anchorLineWidth;if(i.Z.isPointInCircle(t,{center:r,radius:a})){e=r,n=o;break}}return e&&-1!==n?{point:e,index:n}:null},e.prototype.setResizeCursorByIndex=function(t){var e,n;this.context&&(e=this.context.getCanvasEl(),n=this.context.getAssistCanvasEl(),e)&&n&&(e.style.cursor=n.style.cursor=this.ResizeCursorMapping.get(t))},e.prototype.drawModify=function(t){var e,n=this.context,o=null==n?void 0:n.getCtx();n&&o&&this.data&&this.startPoint&&(o=n.getHistoryDataById(this.data.data.id))&&(e=this.indexToModifyHandlerMapping.get(this.startIndex))&&e.call(this,t)&&(this.data.data=y({},o),n.clearDraw(),n.drawHistoryData(),this.drawAnchors())},e.prototype.drawMove=function(t,e){var n,o=this.context,i=null==o?void 0:o.getCtx();o&&i&&this.data&&(i=o.getHistoryDataById(this.data.data.id))&&(t=o.pixelToPoint(t),n=(e=o.pixelToPoint(e)).x-t.x,e=e.y-t.y,i.data.leftTopPoint.x+=n,i.data.leftTopPoint.y+=e,this.data.data=y({},i),o.clearDraw(),o.drawHistoryData(),this.drawAnchors())},e.prototype.getSelectType=function(){return l.SelectType.Rectangle},e.prototype.getBox=function(){var t,e=this.context,n=null==e?void 0:e.getCtx();return e&&n&&this.data&&(n=e.getHistoryDataById(this.data.data.id))?(n=(e=s.Z.transformOriginToReal(e,n.data)).leftTopPoint,t=e.width,e=e.height,{leftTop:y({},n),rightTop:{x:n.x+t,y:n.y},rightBottom:{x:n.x+t,y:n.y+e},leftBottom:{x:n.x,y:n.y+e}}):null},e.prototype.modifyDataByLeftTop=function(t){var e,n=this.context,o=null==n?void 0:n.getCtx();return!(!(n&&o&&this.data&&this.startPoint)||!(o=n.getHistoryDataById(this.data.data.id))||!(e=this.getBox())||t.x>e.rightTop.x||t.y>e.rightBottom.y||(o.data.leftTopPoint=n.pixelToPoint(t),o.data.width=n.distanceToActual(e.rightTop.x-t.x),o.data.height=n.distanceToActual(e.rightBottom.y-t.y),0))},e.prototype.modifyDataByCenterTop=function(t){var e,n=this.context,o=null==n?void 0:n.getCtx();return!(!(n&&o&&this.data&&this.startPoint)||!(o=n.getHistoryDataById(this.data.data.id))||!(e=this.getBox())||t.y>e.leftBottom.y||(o.data.leftTopPoint=n.pixelToPoint({x:e.leftTop.x,y:t.y}),o.data.height=n.distanceToActual(e.rightBottom.y-t.y),0))},e.prototype.modifyDataByRightTop=function(t){var e,n=this.context,o=null==n?void 0:n.getCtx();return!(!(n&&o&&this.data&&this.startPoint)||!(o=n.getHistoryDataById(this.data.data.id))||!(e=this.getBox())||t.x<e.leftTop.x||t.y>e.leftBottom.y||(o.data.leftTopPoint=n.pixelToPoint({x:e.leftTop.x,y:t.y}),o.data.width=n.distanceToActual(t.x-e.leftTop.x),o.data.height=n.distanceToActual(e.rightBottom.y-t.y),0))},e.prototype.modifyDataByRightCenter=function(t){var e,n=this.context,o=null==n?void 0:n.getCtx();return!(!(n&&o&&this.data&&this.startPoint)||!(o=n.getHistoryDataById(this.data.data.id))||!(e=this.getBox())||t.x<e.leftTop.x||(o.data.width=n.distanceToActual(t.x-e.leftTop.x),0))},e.prototype.modifyDataByRightBottom=function(t){var e,n=this.context,o=null==n?void 0:n.getCtx();return!(!(n&&o&&this.data&&this.startPoint)||!(o=n.getHistoryDataById(this.data.data.id))||!(e=this.getBox())||t.x<e.leftTop.x||t.y<e.leftTop.y||(o.data.width=n.distanceToActual(t.x-e.leftTop.x),o.data.height=n.distanceToActual(t.y-e.leftTop.y),0))},e.prototype.modifyDataByCenterBottom=function(t){var e,n=this.context,o=null==n?void 0:n.getCtx();return!(!(n&&o&&this.data&&this.startPoint)||!(o=n.getHistoryDataById(this.data.data.id))||!(e=this.getBox())||t.y<e.leftTop.y||(o.data.height=n.distanceToActual(t.y-e.leftTop.y),0))},e.prototype.modifyDataByLeftBottom=function(t){var e,n,o=this.context,i=null==o?void 0:o.getCtx();return!(!(o&&i&&this.data&&this.startPoint)||!(i=o.getHistoryDataById(this.data.data.id))||(e=i.data.leftTopPoint,e=o.pointToPixel(e),!(n=this.getBox()))||t.x>n.rightBottom.x||t.y<n.rightTop.y||(i.data.leftTopPoint=o.pixelToPoint({x:t.x,y:e.y}),i.data.width=o.distanceToActual(n.rightBottom.x-t.x),i.data.height=o.distanceToActual(t.y-n.rightTop.y),0))},e.prototype.modifyDataByLeftCenter=function(t){var e,n,o=this.context,i=null==o?void 0:o.getCtx();return!(!(o&&i&&this.data&&this.startPoint)||!(i=o.getHistoryDataById(this.data.data.id))||(e=i.data.leftTopPoint,e=o.pointToPixel(e),!(n=this.getBox()))||t.x>n.rightBottom.x||(i.data.leftTopPoint=o.pixelToPoint({x:t.x,y:e.y}),i.data.width=o.distanceToActual(n.rightBottom.x-t.x),0))},e.prototype.isCanMove=function(t){var e,n,o,i;return!!this.data&&(e=(n=s.Z.transformOriginToReal(this.context,null==(n=null==(n=null==this?void 0:this.data)?void 0:n.data)?void 0:n.data)).leftTopPoint,i=n.width,n=n.height,o=r.xmu([t.x,t.y]),i=r.yue([[[e.x,e.y],[e.x+i,e.y],[e.x+i,e.y+n],[e.x,e.y+n],[e.x,e.y]]]),r.FWy(o,i))&&!this.getPointInAnchor(t)},e.prototype.drawMoveGeometry=function(){this.context&&this.data&&s.Z.draw(this.context,this.context.getAssistCtx(),this.data)},e.prototype.drawMoveGeometry=function(t,e){var n,o;this.context&&this.data&&t&&e&&((n=y({},this.data.data)).data=y(y({},n.data),{leftTopPoint:y({},n.data.leftTopPoint)}),t=this.context.pixelToPoint(t),o=(e=this.context.pixelToPoint(e)).x-t.x,e=e.y-t.y,n.data)&&n.data.leftTopPoint&&(n.data.leftTopPoint.x+=o,n.data.leftTopPoint.y+=e,n.style&&(n.style.globalAlpha=a.Z.globalAlpha,n.style.strokeStyle=a.Z.strokeStyle,n.style.lineWidth=a.Z.lineWidth,n.style.lineDash=a.Z.lineDash,n.style.lineDashOffset=a.Z.lineDashOffset),s.Z.draw(this.context,this.context.getAssistCtx(),n))},e.prototype.destroy=function(){this.startIndex=-1,t.prototype.destroy.call(this)},e}(c.Z);e.Z=p},508089:function(t,e,n){var o,i=n(460467),r=n(419174),a=n(823830),s=n(552089),l=n(117827),c=n(945251),u=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),y=function(){return(y=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},p=function(t){function e(e){return(e=t.call(this,e)||this).ResizeCursorMapping=new Map([[0,"ns-resize"],[1,"ew-resize"],[2,"ns-resize"],[3,"ew-resize"]]),e}return u(e,t),e.prototype.drawAnchors=function(){if(this.context){var t=this.context.getCtx();if(t){for(var e=(n=s.Z.transformOriginToReal(this.context,null==(n=null==(n=null==this?void 0:this.data)?void 0:n.data)?void 0:n.data)).center,n=n.outRadius,o=[{x:e.x,y:e.y-n},{x:e.x+n,y:e.y},{x:e.x,y:e.y+n},{x:e.x-n,y:e.y}],i=0;i<o.length;i++){var r=o[i];t.beginPath(),this.setAnchorCircleStyle(),t.ellipse(r.x,r.y,this.anchorRadius,this.anchorRadius,45*Math.PI/180,0,2*Math.PI),t.stroke(),t.fill()}t.beginPath(),this.setAnchorLineStyle(),t.ellipse(e.x,e.y,n,n,45*Math.PI/180,0,2*Math.PI),t.closePath(),t.stroke()}}},e.prototype.getPointInAnchor=function(t){if(!this.data)return null;for(var e=null,n=-1,o=(r=s.Z.transformOriginToReal(this.context,null==(r=null==(r=null==this?void 0:this.data)?void 0:r.data)?void 0:r.data)).center,r=r.outRadius,a=[{x:o.x,y:o.y-r},{x:o.x+r,y:o.y},{x:o.x,y:o.y+r},{x:o.x-r,y:o.y}],l=0;l<a.length;l++){var c=a[l],u=this.anchorRadius+this.anchorLineWidth;if(i.Z.isPointInCircle(t,{center:c,radius:u})){e=c,n=l;break}}return e&&-1!==n?{point:e,index:n}:null},e.prototype.setResizeCursorByIndex=function(t){var e,n;this.context&&(e=this.context.getCanvasEl(),n=this.context.getAssistCanvasEl(),e)&&n&&(t=this.ResizeCursorMapping.get(t),e.style.cursor=n.style.cursor=t)},e.prototype.drawModify=function(t){var e,n=this.context,o=null==n?void 0:n.getCtx();n&&o&&this.data&&this.startPoint&&(o=n.getHistoryDataById(this.data.data.id))&&(e=o.data.center,e=n.pointToPixel(e),o.data.outRadius=n.distanceToActual(i.Z.getDistanceByBetweenPoint({p1:e,p2:t})),o.data.innerRadius=o.data.outRadius/2,this.data.data=y({},o),n.clearDraw(),n.drawHistoryData(),this.drawAnchors())},e.prototype.drawMove=function(t,e){var n,o=this.context,i=null==o?void 0:o.getCtx();o&&i&&this.data&&(i=o.getHistoryDataById(this.data.data.id))&&(t=o.pixelToPoint(t),n=(e=o.pixelToPoint(e)).x-t.x,e=e.y-t.y,i.data.center.x+=n,i.data.center.y+=e,this.data.data=y({},i),o.clearDraw(),o.drawHistoryData(),this.drawAnchors())},e.prototype.getSelectType=function(){return l.SelectType.Start},e.prototype.isCanMove=function(t){if(!this.data)return!1;for(var e=(i=s.Z.transformOriginToReal(this.context,null==(i=null==(i=null==this?void 0:this.data)?void 0:i.data)?void 0:i.data)).center,n=i.outRadius,o=i.innerRadius,i=r.xmu([t.x,t.y]),a=[],l=0;l<5;l++)a.push({x:Math.cos((18+72*l)/180*Math.PI)*n+e.x,y:-Math.sin((18+72*l)/180*Math.PI)*n+e.y}),a.push({x:Math.cos((54+72*l)/180*Math.PI)*o+e.x,y:-Math.sin((54+72*l)/180*Math.PI)*o+e.y});var c=a.map((function(t){return[t.x,t.y]}));c.push(c[0]),c=r.yue([c]);return r.FWy(i,c)&&!this.getPointInAnchor(t)},e.prototype.drawMoveGeometry=function(){this.context&&this.data&&s.Z.draw(this.context,this.context.getAssistCtx(),this.data)},e.prototype.drawMoveGeometry=function(t,e){var n,o;this.context&&this.data&&t&&e&&((n=y({},this.data.data)).data=y(y({},n.data),{center:y({},n.data.center)}),t=this.context.pixelToPoint(t),o=(e=this.context.pixelToPoint(e)).x-t.x,e=e.y-t.y,n.data)&&n.data.center&&(n.data.center.x+=o,n.data.center.y+=e,n.style&&(n.style.globalAlpha=a.Z.globalAlpha,n.style.strokeStyle=a.Z.strokeStyle,n.style.lineWidth=a.Z.lineWidth,n.style.lineDash=a.Z.lineDash,n.style.lineDashOffset=a.Z.lineDashOffset),s.Z.draw(this.context,this.context.getAssistCtx(),n))},e.prototype.setCursor=function(){},e}(c.Z);e.Z=p},729634:function(t,e,n){var o,i=n(460467),r=n(419174),a=n(823830),s=n(900839),l=n(117827),c=n(945251),u=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),y=function(){return(y=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},p=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},h=function(t){function e(e){return(e=t.call(this,e)||this).rectangleAnchorPoints=[],e.indexToModifyHandlerMapping=new Map([[0,e.modifyDataByLeftTop],[1,e.modifyDataByCenterTop],[2,e.modifyDataByRightTop],[3,e.modifyDataByRightCenter],[4,e.modifyDataByRightBottom],[5,e.modifyDataByCenterBottom],[6,e.modifyDataByLeftBottom],[7,e.modifyDataByLeftCenter]]),e.ResizeCursorMapping=new Map([[0,"nwse-resize"],[1,"ns-resize"],[2,"nesw-resize"],[3,"ew-resize"],[4,"nwse-resize"],[5,"ns-resize"],[6,"nesw-resize"],[7,"ew-resize"]]),e}return u(e,t),e.prototype.setCursor=function(){throw new Error("Method not implemented.")},e.prototype.drawAnchors=function(){if(this.context){var t=this.context.getCtx();if(t)if((e=s.Z.transformOriginToReal(this.context,null==(e=null==(e=null==this?void 0:this.data)?void 0:e.data)?void 0:e.data).points)&&e.length){var e,n={x:e[0].x,y:e[1].y},o=e[2].x-e[0].x,i=o/2,r=(e=e[2].y-e[1].y)/2;this.rectangleAnchorPoints=[y({},n),{x:n.x+i,y:n.y},{x:n.x+o,y:n.y},{x:n.x+o,y:n.y+r},{x:n.x+o,y:n.y+e},{x:n.x+i,y:n.y+e},{x:n.x,y:n.y+e},{x:n.x,y:n.y+r}];for(var a=0;a<this.rectangleAnchorPoints.length;a++){var l=this.rectangleAnchorPoints[a];t.beginPath(),this.setAnchorCircleStyle(),t.ellipse(l.x,l.y,this.anchorRadius,this.anchorRadius,45*Math.PI/180,0,2*Math.PI),t.stroke(),t.fill()}t.beginPath(),this.setAnchorLineStyle(),t.moveTo(n.x,n.y),t.lineTo(n.x+o,n.y),t.lineTo(n.x+o,n.y+e),t.lineTo(n.x,n.y+e),t.lineTo(n.x,n.y),t.stroke()}}},e.prototype.getPointInAnchor=function(t){if(!this.data)return null;for(var e=null,n=-1,o=0;o<this.rectangleAnchorPoints.length;o++){var r=this.rectangleAnchorPoints[o],a=this.anchorRadius+this.anchorLineWidth;if(i.Z.isPointInCircle(t,{center:r,radius:a})){e=r,n=o;break}}return e&&-1!==n?{point:e,index:n}:null},e.prototype.setResizeCursorByIndex=function(t){var e,n;this.context&&(e=this.context.getCanvasEl(),n=this.context.getAssistCanvasEl(),e)&&n&&(e.style.cursor=n.style.cursor=this.ResizeCursorMapping.get(t))},e.prototype.drawModify=function(t){var e,n=this.context,o=null==n?void 0:n.getCtx();n&&o&&this.data&&this.startPoint&&(o=n.getHistoryDataById(this.data.data.id))&&(e=this.indexToModifyHandlerMapping.get(this.startIndex))&&e.call(this,t)&&(this.data.data=y({},o),n.clearDraw(),n.drawHistoryData(),this.drawAnchors())},e.prototype.drawMove=function(t,e){var n,o,i=this.context,r=null==i?void 0:i.getCtx();i&&r&&this.data&&(r=i.getHistoryDataById(this.data.data.id))&&(t=i.pixelToPoint(t),e=i.pixelToPoint(e),n=e.x-t.x,o=e.y-t.y,r.data.points.forEach((function(t){t.x+=n,t.y+=o})),this.data.data=y({},r),i.clearDraw(),i.drawHistoryData(),this.drawAnchors())},e.prototype.getSelectType=function(){return l.SelectType.Triangle},e.prototype.getBox=function(){var t,e,n=this.context;return n&&this.data&&(t=n.getHistoryDataById(this.data.data.id))&&(n=s.Z.transformOriginToReal(n,t.data).points)&&n.length?(t={x:n[0].x,y:n[1].y},e=n[2].x-n[0].x,n=n[2].y-n[1].y,{leftTop:y({},t),rightTop:{x:t.x+e,y:t.y},rightBottom:{x:t.x+e,y:t.y+n},leftBottom:{x:t.x,y:t.y+n}}):null},e.prototype.modifyDataByLeftTop=function(t){var e,n,o=this.context,i=null==o?void 0:o.getCtx();return!!(o&&i&&this.data&&this.startPoint)&&!!(i=o.getHistoryDataById(this.data.data.id))&&!(!(n=i.data.points)||!n.length||!(n=this.getBox())||t.x>n.rightTop.x||t.y>n.rightBottom.y||(e=n.rightTop.x-t.x,n=n.rightBottom.y-t.y,i.data.points=s.Z.transformRealToOrigin(o,{points:[{x:t.x,y:t.y+n},{x:t.x+e/2,y:t.y},{x:t.x+e,y:t.y+n}]}).points,0))},e.prototype.modifyDataByCenterTop=function(t){var e,n,o,i=this.context,r=null==i?void 0:i.getCtx();return!!(i&&r&&this.data&&this.startPoint)&&!!(r=i.getHistoryDataById(this.data.data.id))&&!(!(o=r.data.points)||!o.length||!(o=this.getBox())||t.y>o.leftBottom.y||(e={x:o.leftTop.x,y:t.y},n=o.rightTop.x-o.leftTop.x,o=o.rightBottom.y-t.y,r.data.points=s.Z.transformRealToOrigin(i,{points:[{x:e.x,y:e.y+o},{x:e.x+n/2,y:e.y},{x:e.x+n,y:e.y+o}]}).points,0))},e.prototype.modifyDataByRightTop=function(t){var e,n,o,i=this.context,r=null==i?void 0:i.getCtx();return!!(i&&r&&this.data&&this.startPoint)&&!!(r=i.getHistoryDataById(this.data.data.id))&&!(!(o=r.data.points)||!o.length||!(o=this.getBox())||t.x<o.leftTop.x||t.y>o.leftBottom.y||(e={x:o.leftTop.x,y:t.y},n=t.x-o.leftTop.x,o=o.rightBottom.y-t.y,r.data.points=s.Z.transformRealToOrigin(i,{points:[{x:e.x,y:e.y+o},{x:e.x+n/2,y:e.y},{x:e.x+n,y:e.y+o}]}).points,0))},e.prototype.modifyDataByRightCenter=function(t){var e,n,o=this.context,i=null==o?void 0:o.getCtx();return!!(o&&i&&this.data&&this.startPoint)&&!!(i=o.getHistoryDataById(this.data.data.id))&&!(!(n=i.data.points)||!n.length||!(n=this.getBox())||t.x<n.leftTop.x||(e={x:n.leftTop.x,y:n.leftTop.y},t=t.x-n.leftTop.x,n=n.rightBottom.y-n.rightTop.y,i.data.points=s.Z.transformRealToOrigin(o,{points:[{x:e.x,y:e.y+n},{x:e.x+t/2,y:e.y},{x:e.x+t,y:e.y+n}]}).points,0))},e.prototype.modifyDataByRightBottom=function(t){var e,n,o,i=this.context,r=null==i?void 0:i.getCtx();return!!(i&&r&&this.data&&this.startPoint)&&!!(r=i.getHistoryDataById(this.data.data.id))&&!(!(e=r.data.points)||!e.length||!(e=this.getBox())||t.x<e.leftTop.x||t.y<e.leftTop.y||(n=y({},e.leftTop),o=t.x-e.leftTop.x,t=t.y-e.leftTop.y,r.data.points=s.Z.transformRealToOrigin(i,{points:[{x:n.x,y:n.y+t},{x:n.x+o/2,y:n.y},{x:n.x+o,y:n.y+t}]}).points,0))},e.prototype.modifyDataByCenterBottom=function(t){var e,n,o,i=this.context,r=null==i?void 0:i.getCtx();return!!(i&&r&&this.data&&this.startPoint)&&!!(r=i.getHistoryDataById(this.data.data.id))&&!(!(e=r.data.points)||!e.length||!(e=this.getBox())||t.y<e.leftTop.y||(n=y({},e.leftTop),o=e.rightTop.x-e.leftTop.x,t=t.y-e.leftTop.y,r.data.points=s.Z.transformRealToOrigin(i,{points:[{x:n.x,y:n.y+t},{x:n.x+o/2,y:n.y},{x:n.x+o,y:n.y+t}]}).points,0))},e.prototype.modifyDataByLeftBottom=function(t){var e,n,o,i=this.context,r=null==i?void 0:i.getCtx();return!!(i&&r&&this.data&&this.startPoint)&&!!(r=i.getHistoryDataById(this.data.data.id))&&!(!(e=r.data.points)||!e.length||!(e=this.getBox())||t.x>e.rightBottom.x||t.y<e.rightTop.y||(n={x:t.x,y:e.leftTop.y},o=e.rightBottom.x-t.x,t=t.y-e.rightTop.y,r.data.points=s.Z.transformRealToOrigin(i,{points:[{x:n.x,y:n.y+t},{x:n.x+o/2,y:n.y},{x:n.x+o,y:n.y+t}]}).points,0))},e.prototype.modifyDataByLeftCenter=function(t){var e,n,o=this.context,i=null==o?void 0:o.getCtx();return!!(o&&i&&this.data&&this.startPoint)&&!!(i=o.getHistoryDataById(this.data.data.id))&&!(!(n=i.data.points)||!n.length||!(n=this.getBox())||t.x>n.rightBottom.x||(e={x:t.x,y:n.leftTop.y},t=n.rightBottom.x-t.x,n=n.rightBottom.y-n.rightTop.y,i.data.points=s.Z.transformRealToOrigin(o,{points:[{x:e.x,y:e.y+n},{x:e.x+t/2,y:e.y},{x:e.x+t,y:e.y+n}]}).points,0))},e.prototype.isCanMove=function(t){var e,n;return!!this.data&&((n=s.Z.transformOriginToReal(this.context,{points:p([],(null==(n=null==(n=null==(n=null==this?void 0:this.data)?void 0:n.data)?void 0:n.data)?void 0:n.points)||[],!0)}).points).push(n[0]),e=r.xmu([t.x,t.y]),n=r.yue([n.map((function(t){return[t.x,t.y]}))]),r.FWy(e,n))&&!this.getPointInAnchor(t)},e.prototype.drawMoveGeometry=function(){this.context&&this.data&&s.Z.draw(this.context,this.context.getAssistCtx(),this.data)},e.prototype.drawMoveGeometry=function(t,e){var n,o,i;this.context&&this.data&&t&&e&&((n=y({},this.data.data)).data=y(y({},n.data),{points:n.data.points.map((function(t){return y({},t)}))}),t=this.context.pixelToPoint(t),e=this.context.pixelToPoint(e),o=e.x-t.x,i=e.y-t.y,n.data)&&n.data.points&&n.data.points.length&&(n.data.points.forEach((function(t){t.x+=o,t.y+=i})),n.style&&(n.style.globalAlpha=a.Z.globalAlpha,n.style.strokeStyle=a.Z.strokeStyle,n.style.lineWidth=a.Z.lineWidth,n.style.lineDash=a.Z.lineDash,n.style.lineDashOffset=a.Z.lineDashOffset),s.Z.draw(this.context,this.context.getAssistCtx(),n))},e.prototype.destroy=function(){this.startIndex=-1,t.prototype.destroy.call(this)},e}(c.Z);e.Z=h},117827:function(t,e,n){var o,i,r,a,s,l;n.r(e),n.d(e,{ActionEvents:function(){return i},ActionStatus:function(){return o},ActionType:function(){return s},InteractionLayerActions:function(){return r},SelectType:function(){return a}}),(l=o=o||{})[l.UnStart=0]="UnStart",l[l.Running=1]="Running",l[l.End=2]="End",l[l.Destroy=3]="Destroy",function(t){t.BeforeStart="BeforeStart",t.Start="Start",t.End="End",t.Destroy="Destroy"}(i=i||{}),function(t){t.CanvasMount="CanvasMount",t.CanvasClickEmpty="CanvasClickEmpty",t.CanvasClickGeometry="CanvasClickGeometry"}(r=r||{}),function(t){t.Polygon="Polygon",t.Circle="Circle",t.Rectangle="Rectangle",t.Triangle="Triangle",t.Diamond="Diamond",t.Start="Start",t.Free="Free",t.Distance="Distance"}(a=a||{}),function(t){t.Draw="Draw",t.Modify="Modify",t.Move="Move"}(s=s||{})},781777:function(t,e){e.Z={getRectLeftTopPoint:function(t){var e=t.startPoint;return(t=t.targetPoint).x<=e.x&&t.y<=e.y?t:t.x<=e.x&&t.y>=e.y?{x:t.x,y:e.y}:t.x>=e.x&&t.y<=e.y?{x:e.x,y:t.y}:t.x>=e.x&&t.y>=e.y?e:null},triangle:function(t){var e,n=t.startPoint,o=(t=t.targetPoint,this.getRectLeftTopPoint({startPoint:n,targetPoint:t}));return o?(e=Math.abs(t.x-n.x),t=Math.abs(t.y-n.y),[{x:o.x,y:o.y+t},{x:o.x+e/2,y:o.y},{x:o.x+e,y:o.y+t}]):[]}}},876795:function(t,e){e.Z={fillStyle:"#fff",strokeStyle:"#fff",lineWidth:1,lineCap:"round",lineJoin:"round",lineDash:[5,4,3],lineDashOffset:-1,globalAlpha:1}},586152:function(t,e){e.Z={fillStyle:"#fff",strokeStyle:"red",lineWidth:6,lineCap:"round",lineJoin:"round",lineDash:[5,4,3],lineDashOffset:-1,globalAlpha:1}},745079:function(t,e){e.Z={fillStyle:"rgb(91,155,213,1)",strokeStyle:"rgba(0,0,0,.8)",lineWidth:1,lineCap:"round",lineJoin:"round",lineDash:[],lineDashOffset:-1,globalAlpha:1}},417630:function(t,e){e.Z={fillStyle:"#fff",strokeStyle:"#fff",lineWidth:1,lineCap:"round",lineJoin:"round",lineDash:[5,4,3],lineDashOffset:-1,globalAlpha:.6}},336017:function(t,e,n){var o=n(745079),i=function(){return(i=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},r=i({font:"10px sans-serif",textAlign:"start",textBaseline:"middle",direction:"inherit"},o.Z);e.Z=r},328051:function(t,e,n){n.r(e),n.d(e,{AnchorStyle:function(){return o.Z},DistancePointStyle:function(){return i.Z},GeometryStyle:function(){return r.Z},MoveGeomStyle:function(){return a.Z},TextStyle:function(){return s.Z}});var o=n(876795),i=n(586152),r=n(745079),a=n(417630),s=n(336017)},253237:function(t,e,n){n.r(e),n.d(e,{Trajectory:function(){return o.Z},TrajectoryPlayBackLayer:function(){return i.Z}});var o=n(184207),i=n(170468)},184207:function(t,e,n){var o=n(460467),i=n(419174),r=n(497734),a=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},s=function(){function t(t){var e=t.context,n=t.id,o=t.coordinates,i=t.renderPosition,a=t.renderStep,s=t.renderCap;t=t.duration;this.id="",this.context=null,this.coordinates=[],this.duration=0,this.status=r.TrajectoryStatus.UnInit,this.boutTotal=0,this.bout=1,this.loopHeader=-1,this.loopPointEntitys=[],this.stepEntityIndexes=[],this.preLoopPixel=null,this.arrowMarker=null,this.context=e,this.id=n,this.coordinates=o,this.duration=t,this.renderPosition=i,this.renderStep=a,this.renderCap=s}return t.prototype.drawDefaultPosition=function(t,e){var n,o=this.context;o&&(n=o.getCtx())&&(o=o.pointToPixel({x:t.lng,y:t.lat}),n.beginPath(),n.strokeStyle="red",n.fillStyle="#fff",n.lineWidth=3,n.ellipse(o.x,o.y,6,6,45*Math.PI/180,0,2*Math.PI),n.stroke(),n.fill(),n.beginPath(),n.font="8px sans-serif",n.textAlign="center",n.textBaseline="middle",n.fillStyle="#000",n.fillText("".concat(e+1),o.x,o.y,10))},t.prototype.createDefaultCap=function(){var t;if(this.context)return t=new BMap.Icon("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjMxNDU2MzQ2NjYxIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjQxMzYiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTc4OC40OCA1MTJMMzEyLjMyIDc4Ni45MjM1MlYyMzcuMDk2OTZ6IiBwLWlkPSI0MTM3IiBmaWxsPSIjRkZBNTAwIj48L3BhdGg+PC9zdmc+",new BMap.Size(16,16)),new BMap.Marker(new BMap.Point(90,90),{icon:t})},t.prototype.updateCap=function(t){var e,n,i=(a=this).preLoopPixel,r=a.context,a=a.arrowMarker;r&&i&&a&&(r=r.pixelToPoint(t),e=t.x-i.x,n=t.y-i.y,Math.atan2(n,e),Math.PI,n=o.Z.slopToAngle(i,t,"geographic"),a.setPosition(new BMap.Point(r.x,r.y)),a.setRotation(n))},t.prototype.drawPosition=function(){var t,e,n=this,o=(e=this).renderPosition,i=e.coordinates;(e=e.context)&&(t=e.getCtx())&&i.forEach((function(e,i){o?o({ctx:t,coordinate:e}):n.drawDefaultPosition(e,i)}))},t.prototype.drawTrajectory=function(){this.drawPosition(),this.prepareLoopData();for(var t=1;t<this.boutTotal;t++)this.loopBout(t);this.drawLastFrame(),this.finishDeal()},t.prototype.drawLastFrame=function(){var t=this,e=t.loopPointEntitys,n=t.context,o=t.renderStep;t.renderCap,n&&(t=n.getCtx())&&(e=e[e.length-1],n=n.pointToPixel({x:e.point.lng,y:e.point.lat}),t.beginPath(),o?o(t,n):(this.setDrawLoopStyle(),t.lineTo(n.x,n.y),t.stroke(),this.preLoopPixel=null),this.updateCap(n))},t.prototype.setDrawLoopStyle=function(){var t=this.context;t&&(t=t.getCtx())&&(t.strokeStyle="orange",t.lineWidth=3)},t.prototype.finishDeal=function(){var t=this.context;t&&(t=t.getMap())&&(-1!==this.loopHeader&&"undefined"!=typeof window&&window.cancelAnimationFrame(this.loopHeader),this.loopHeader=-1,this.bout=1,this.boutTotal=0,this.loopPointEntitys=[],this.stepEntityIndexes=[],this.preLoopPixel=null,this.arrowMarker&&t.removeOverlay(this.arrowMarker),this.arrowMarker=null)},t.prototype.loopBout=function(t){var e=(l=this).context,n=l.loopPointEntitys,o=l.stepEntityIndexes,i=l.renderStep,r=l.renderCap;if(e){var a=e.getCtx();if(a)for(var s=e.getMap(),l=1===t?0:o[t-2],c=o[t-1],u=l;u<c;u++){var y=n[u].point;y=e.pointToPixel({x:y.lng,y:y.lat});this.preLoopPixel?this.updateCap(y):(this.arrowMarker=r?r():this.createDefaultCap(),s.addOverlay(this.arrowMarker)),i?i(a,y):this.preLoopPixel?(a.lineTo(y.x,y.y),a.stroke(),a.beginPath(),this.setDrawLoopStyle(),a.moveTo(y.x,y.y)):(a.beginPath(),this.setDrawLoopStyle(),a.moveTo(y.x,y.y),this.preLoopPixel=y)}}},t.prototype.loop=function(){var t=this;"undefined"!=typeof window&&(this.loopHeader=window.requestAnimationFrame((function(){var e;t.status===r.TrajectoryStatus.Pause?t.loop():(e=t.context)&&e.getCtx()&&(t.loopBout(t.bout),t.bout++,t.bout>=t.boutTotal?(t.drawLastFrame(),t.finishDeal(),t.status=r.TrajectoryStatus.End):t.loop())})))},t.prototype.prepareLoopData=function(){for(var t=this,e=this.duration,n=this.coordinates,o=[],r=(n.reduce((function(t,e,r){return r=0===r?0:i.vs3(i.TE$(i.xmu([n[r-1].lng,n[r-1].lat]),i.xmu([e.lng,e.lat]),{units:"kilometers"}),"kilometers","meters"),o.push({point:e,distance:t+r,isStep:!1}),t+r}),0),i.TuJ(n.map((function(t){return[t.lng,t.lat]})))),s=i.vs3(i.kE(r,{units:"kilometers"}),"kilometers","meters"),l=(this.boutTotal=60*e,s/this.boutTotal),c=[],u=0;u<this.boutTotal;u++){var y=(u+1)*l,p=i.$1t(r,i.vs3(y,"meters","kilometers"),{units:"kilometers"});c.push({point:{lng:p.geometry.coordinates[0],lat:p.geometry.coordinates[1]},distance:y,isStep:!0})}this.loopPointEntitys=a(a([],o,!0),c,!0),this.loopPointEntitys.sort((function(t,e){return t.distance>e.distance?1:t.distance<e.distance?-1:0})),this.stepEntityIndexes=[],this.loopPointEntitys.forEach((function(e,n){e.isStep&&t.stepEntityIndexes.push(n)}))},t.prototype.init=function(){this.status===r.TrajectoryStatus.UnInit&&(this.drawPosition(),this.status=r.TrajectoryStatus.Init)},t.prototype.start=function(){var t=this.context;t&&t.getCtx()&&[r.TrajectoryStatus.Init,r.TrajectoryStatus.End,r.TrajectoryStatus.Pause].includes(this.status)&&([r.TrajectoryStatus.Pause,r.TrajectoryStatus.End].includes(this.status)&&(r.TrajectoryStatus.Pause===this.status&&this.finishDeal(),t.clear(),t.drawHistory()),this.status=r.TrajectoryStatus.Running,this.prepareLoopData(),this.loop())},t.prototype.pause=function(){this.status=r.TrajectoryStatus.Pause},t.prototype.resume=function(){this.status=r.TrajectoryStatus.Running},t.prototype.finish=function(){this.context&&![r.TrajectoryStatus.End,r.TrajectoryStatus.Destroy].includes(this.status)&&(this.finishDeal(),this.status=r.TrajectoryStatus.End)},t.prototype.destroy=function(){var t;this.status!==r.TrajectoryStatus.Destroy&&(t=this.context)&&(this.finishDeal(),t.clear(),this.status=r.TrajectoryStatus.Destroy,t.removeTrajectoryById(this.id))},t.prototype.getId=function(){return this.id},t.prototype.getStatus=function(){return this.status},t.prototype.drawHistory=function(){var t=this.status;if(r.TrajectoryStatus.Init===t?this.drawPosition():r.TrajectoryStatus.End===t&&this.drawTrajectory(),[r.TrajectoryStatus.Pause,r.TrajectoryStatus.Running].includes(t)){this.drawPosition();for(var e=1;e<this.bout;e++)this.loopBout(e)}},t}();e.Z=s},170468:function(t,e,n){var o,i=n(441930),r=n(439881),a=n(117827),s=n(497734),l=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(){return(c=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},u=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},y=function(t){function e(e,n){var o=this;return o.update=o.update.bind(o),(o=t.call(this,{update:o.update,paneName:n.paneName,zIndex:n.zIndex})||this).emitter=new i.Z.Events,o.isLoad=!1,o.source=[],o.el=null,o.canvasEl=null,o.ctx=null,o.map=e,o.config=c({},n),o}return l(e,t),e.prototype.initCanvas=function(){this.el=this.canvas.parentElement,this.canvasEl=this.canvas,this.el.style.width="".concat(this.canvasEl.width,"px"),this.el.style.height="".concat(this.canvasEl.height,"px"),this.canvasEl.className="".concat("adhere-ui-trajectoryplaybacklayer"),this.ctx=this.canvasEl.getContext("2d"),this.emitter.trigger(a.InteractionLayerActions.CanvasMount)},e.prototype.firstLoad=function(){this.initCanvas()},e.prototype.update=function(){var t=this.canvas.getContext("2d");t&&(this.isLoad||this.firstLoad(),this.isLoad=!0,t.clearRect(0,0,t.canvas.width,t.canvas.height),this.drawHistory())},e.prototype.getMap=function(){return this.map},e.prototype.getCtx=function(){return this.ctx},e.prototype.getCanvasEl=function(){return this.canvasEl},e.prototype.getEmitter=function(){return this.emitter},e.prototype.pixelToPoint=function(t){return{x:(t=this.map.pixelToPoint(t)).lng,y:t.lat}},e.prototype.pointToPixel=function(t){return this.map.pointToPixel(new BMap.Point(t.x,t.y))},e.prototype.distanceToActual=function(t){return t/r.default.getScale(this.map)},e.prototype.actualToDistance=function(t){return r.default.getScale(this.map)*t},e.prototype.addTrajectory=function(t){this.hasTrajectoryById(t.getId())||(this.source.push(t),t.init())},e.prototype.removeTrajectory=function(t){this.removeTrajectoryById(t.getId())},e.prototype.removeTrajectoryById=function(t){var e=this.source.findIndex((function(e){return e.getId()===t}));-1!==e&&(this.source[e].destroy(),this.source.splice(e,1))},e.prototype.clean=function(){this.source.forEach((function(t){return t.destroy()})),this.source=[]},e.prototype.getTrajectoryById=function(t){return this.source.find((function(e){return e.getId()===t}))},e.prototype.getTrajectorys=function(){return u([],this.source,!0)},e.prototype.hasTrajectoryById=function(t){return!!this.getTrajectoryById(t)},e.prototype.clear=function(){var t=this.getCtx(),e=this.getCanvasEl();t&&e&&t.clearRect(0,0,e.width,e.height)},e.prototype.drawHistory=function(){this.source.filter((function(t){return t.getStatus()!==s.TrajectoryStatus.Destroy})).forEach((function(t){t.drawHistory()}))},e}(BMap.CanvasLayer);e.Z=y},497734:function(t,e,n){var o,i,r,a,s,l;n.r(e),n.d(e,{GeoJSONType:function(){return a},GeometryType:function(){return o},TrajectoryStatus:function(){return s},VectorActions:function(){return r},VectorEventActions:function(){return i}}),(l=o=o||{}).Point="Point",l.MulitPoint="MulitPoint",l.Circle="Circle",l.MulitCircle="MulitCircle",l.LineString="LineString",l.MulitLineString="MulitLineString",l.Polygon="Polygon",l.MulitPolygon="MulitPolygon",l.Rect="Rect",l.RadiusRect="RadiusRect",l.MulitRadiusRect="MulitRadiusRect",l.Leaf="Leaf",l.MulitLeaf="MulitLeaf",l.MulitRect="MulitRect",l.Text="Text",l.RegularPolygon="RegularPolygon",l.MulitRegularPolygon="MulitRegularPolygon",l.Start="Start",l.MulitStart="MulitStart",l.Sector="Sector",l.MulitSector="MulitSector",function(t){t.FEATURE_CLICK="feature:click",t.VECTOR_CLICK="vector:click"}(i=i||{}),function(t){t.UPDATE="UPDATE",t.APPEND="APPEND"}(r=r||{}),function(t){t.Point="Point",t.MultiPoint="MultiPoint",t.LineString="LineString",t.MultiLineString="MultiLineString",t.Polygon="Polygon",t.MultiPolygon="MultiPolygon",t.GeometryCollection="GeometryCollection",t.Feature="Feature",t.FeatureCollection="FeatureCollection"}(a=a||{}),function(t){t[t.UnInit=0]="UnInit",t[t.Init=1]="Init",t[t.Running=2]="Running",t[t.Pause=3]="Pause",t[t.End=4]="End",t[t.Destroy=5]="Destroy"}(s=s||{})}}]);