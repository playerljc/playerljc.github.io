"use strict";(self.webpackChunk_ctsj_build=self.webpackChunk_ctsj_build||[]).push([[1398],{74280:(e,r,n)=>{n.r(r),n.d(r,{default:()=>g});var t=n(26322),i=n(19994),s=n(40370),a=n(40892),o=[],l=function(){return JSON.parse(JSON.stringify(o))},c=function(e,r){return!((e=(e=void 0===e?l():e)||l())&&Array.isArray(e)&&r)||(Array.isArray(r)?r.every((function(r){return-1!==e.indexOf(r)})):-1!==e.indexOf(r))};const u={Permission:function(e){var r=void 0===(r=e.allPermission)?l():r,n=e.permissions,i=e.children;e=e.noMatch;return t.createElement(a.A,{conditional:c(r,n),noMatch:e},i)},setPermission:function(e){o=e},checkPermission:c,getPermission:l,PermissionFun:function(e){var r=void 0===(r=e.allPermission)?l():r,n=e.permissions,t=e.match;return e=e.noMatch,a.A.conditionalRender({conditional:c(r,n),match:t,noMatch:e})}};var m=n(66003),d=n(80711),p=n(2438);const{Permission:f,setPermission:y,getPermission:P}=u;y(["1"]);const E=()=>{const[e,r]=(0,t.useState)(P()),[n,i]=(0,t.useState)(["2"]),a=(0,t.useRef)(),o=(0,t.useRef)();return t.createElement(m.A,{actions:[t.createElement(d.Ay,{type:"primary",onClick:()=>{const{close:e}=s.A.Modal({config:{title:"权限所有设置",width:300,footer:[t.createElement(d.Ay,{type:"primary",onClick:()=>{const n=a.current.value.trim();n&&(y(n.split(",")),r(P())),e()}},"确定")]},children:t.createElement("div",null,t.createElement("input",{autoFocus:!0,ref:a,defaultValue:P()}))})}},"设置所有权限"),t.createElement(d.Ay,{onClick:()=>{const{close:e}=s.A.Modal({config:{title:"权限当前设置",width:300,footer:[t.createElement(d.Ay,{type:"primary",onClick:()=>{const r=o.current.value.trim();r&&i(r.split(",")),e()}},"确定")]},children:t.createElement("div",null,t.createElement("input",{autoFocus:!0,ref:o,defaultValue:n}))})}},"设置当前权限")]},t.createElement(f,{permissions:n,noMatch:()=>t.createElement(p.A,null)},(()=>t.createElement(d.Ay,null,"有权限才能看到这个按钮"))))},g=()=>t.createElement(i.Ay,null,t.createElement(i.wn,{title:"Permission"},t.createElement("p",null,"权限的组件"),t.createElement("ul",null,t.createElement("li",null,"- 设置所有权限"),t.createElement("li",null,"- 传入权限(支持多个)"),t.createElement("li",null,"- 可以自定义无权限的 UI"))),t.createElement(i.Wc,{title:"代码演示",columnCount:1,config:[{id:"p1",name:"基本使用",mode:"code",scope:{React:t},cardProps:{description:{title:"基本使用",info:"基本使用"}},type:"PlayGround",codeText:"import { Button, Card, Empty } from 'antd';\r\nimport React, { useRef, useState } from 'react';\r\n\r\nimport { MessageDialog, Permission } from '@baifendian/adhere';\r\n\r\nconst { Permission: PermissionWrap, setPermission, getPermission } = Permission;\r\n\r\nsetPermission(['1']);\r\n\r\nexport default () => {\r\n  const [allPermission, setAllPermission] = useState(getPermission());\r\n  const [curPermission, setCurPermission] = useState(['2']);\r\n\r\n  const ref1 = useRef();\r\n\r\n  const ref2 = useRef();\r\n\r\n  return (\r\n    <Card\r\n      actions={[\r\n        <Button\r\n          type=\"primary\"\r\n          onClick={() => {\r\n            const { close } = MessageDialog.Modal({\r\n              config: {\r\n                title: '权限所有设置',\r\n                width: 300,\r\n                footer: [\r\n                  <Button\r\n                    type=\"primary\"\r\n                    onClick={() => {\r\n                      const val = ref1.current.value.trim();\r\n                      if (val) {\r\n                        setPermission(val.split(','));\r\n                        setAllPermission(getPermission());\r\n                      }\r\n                      close();\r\n                    }}\r\n                  >\r\n                    确定\r\n                  </Button>,\r\n                ],\r\n              },\r\n              children: (\r\n                <div>\r\n                  <input autoFocus={true} ref={ref1} defaultValue={getPermission()} />\r\n                </div>\r\n              ),\r\n            });\r\n          }}\r\n        >\r\n          设置所有权限\r\n        </Button>,\r\n\r\n        <Button\r\n          onClick={() => {\r\n            const { close } = MessageDialog.Modal({\r\n              config: {\r\n                title: '权限当前设置',\r\n                width: 300,\r\n                footer: [\r\n                  <Button\r\n                    type=\"primary\"\r\n                    onClick={() => {\r\n                      const val = ref2.current.value.trim();\r\n                      if (val) {\r\n                        setCurPermission(val.split(','));\r\n                      }\r\n                      close();\r\n                    }}\r\n                  >\r\n                    确定\r\n                  </Button>,\r\n                ],\r\n              },\r\n              children: (\r\n                <div>\r\n                  <input autoFocus={true} ref={ref2} defaultValue={curPermission} />\r\n                </div>\r\n              ),\r\n            });\r\n          }}\r\n        >\r\n          设置当前权限\r\n        </Button>,\r\n      ]}\r\n    >\r\n      <PermissionWrap permissions={curPermission} noMatch={() => <Empty />}>\r\n        {() => <Button>有权限才能看到这个按钮</Button>}\r\n      </PermissionWrap>\r\n    </Card>\r\n  );\r\n};\r\n",renderChildren:()=>t.createElement(E,null)}]}),t.createElement(i.e6,{title:"Props",config:[{border:!0,title:"Permission",data:[{params:"allPermission",desc:"所有的权限",type:"Array<String>",defaultVal:"undefined"},{params:"permissions",desc:"校验的权限",type:"Array<String>",defaultVal:""},{params:"children",desc:"有权限时显示的内容",type:"React.ReactElement | null",defaultVal:""},{params:"noMatch",desc:"没有权限时显示的内容",type:"React.ReactElement",defaultVal:"null"}]}]}),t.createElement(i.I7,{title:"Api",config:[{border:!0,title:"Api",data:[{name:"setPermission",desc:"设置所有的权限",modifier:"static",params:[{name:"permission",desc:"所有的权限",type:"Array<String>",defaultVal:"",required:""}],returnType:"void",returnDesc:""},{name:"getPermission",desc:"获取所有的权限",modifier:"static",params:[],returnType:"Array<String>",returnDesc:"返回所有权限的数组"},{name:"checkPermission",desc:"监测是否有指定的权限",modifier:"static",params:[{name:"allPermission",desc:"所有的权限",type:"Array<String>",defaultVal:"",required:""},{name:"currentPermissions",desc:"监测的权限",type:"Array<String>",defaultVal:"",required:""}],returnType:"boolean",returnDesc:"是否存在指定的权限"},{name:"checkPermission",desc:"监测是否有指定的权限",modifier:"static",params:[{name:"allPermission",desc:"所有的权限",type:"Array<String>",defaultVal:"",required:""},{name:"currentPermissions",desc:"监测的权限",type:"Array<String>",defaultVal:"",required:""}],returnType:"boolean",returnDesc:"是否存在指定的权限"},{name:"PermissionFun",desc:"函数方式实现",modifier:"static",params:[{name:"allPermission",desc:"所有的权限",type:"Array<String>",defaultVal:"",required:""},{name:"permissions",desc:"监测的权限",type:"Array<String>",defaultVal:"",required:""},{name:"match",desc:"符合条件",type:"any",defaultVal:"",required:""},{name:"noMatch",desc:"不符合条件",type:"any",defaultVal:"",required:""}],returnType:"React.Element | null",returnDesc:""}]}]}))},19994:(e,r,n)=>{n.d(r,{Ay:()=>d,I7:()=>m,Wc:()=>c,e6:()=>u,wn:()=>l});var t=n(71860),i=n(24370),s=n(26322);const{PlayGroundPageContext:a,PlayGroundPage:o}=i.A,{Section:l,CodeBoxSection:c,PropsSection:u,FunctionPropsSection:m}=o;const d=function(e){let{children:r,onScrollBottom:n,distance:i=50,...l}=e;const[c,u]=(0,s.useState)(),m=(0,s.useRef)(),d=(0,s.useRef)(!1);return(0,s.useEffect)((()=>{function e(){const e=r.scrollHeight-r.offsetHeight,t=r.scrollTop;if(n&&Math.abs(t-e)<=i){if(d.current)return;d.current=!0,null==n||n().then((()=>{d.current=!1}))}}const r=m.current.parentElement.parentElement;return r.addEventListener("scroll",e),u(r),()=>{r.removeEventListener("scroll",e)}}),[]),s.createElement(a.Provider,{value:{scrollEl:c}},s.createElement(o,(0,t.A)({ref:m},l),r))}}}]);